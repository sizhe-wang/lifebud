{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/index.ts","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatInput.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/providers/CopilotChatConfigurationProvider.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/ui/button.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/lib/utils.ts","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/ui/tooltip.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/ui/dropdown-menu.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatAudioRecorder.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/lib/slots.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatAssistantMessage.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-render-tool-call.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/providers/CopilotKitProvider.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/lib/react-core.ts","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/CopilotKitInspector.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/MCPAppsActivityRenderer.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-render-custom-messages.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-render-activity-message.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-frontend-tool.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-human-in-the-loop.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-agent.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-agent-context.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-suggestions.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-configure-suggestions.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatToolCallsView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatUserMessage.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatSuggestionPill.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatSuggestionView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatMessageView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/hooks/use-keyboard-height.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChat.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotChatToggleButton.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotSidebarView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotModalHeader.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotPopupView.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotSidebar.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/chat/CopilotPopup.tsx","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/types/defineToolCallRenderer.ts","file:///Users/wsz/lifebud/version2/lifebud/node_modules/%40copilotkitnext/react/src/components/WildcardToolCallRender.tsx"],"sourcesContent":["\"use client\";\n\n// Re-export AG-UI runtime and types to provide a single import surface\n// This helps avoid version mismatches by letting apps import everything from '@copilotkitnext/react'\n// Note: @ag-ui/client already re-exports everything from @ag-ui/core, so we only export from client\n// to avoid conflicting star exports during webpack builds\nexport * from \"@ag-ui/client\";\n\n// React components and hooks for CopilotKit2\nexport * from \"./components\";\nexport * from \"./hooks\";\nexport * from \"./providers\";\nexport * from \"./types\";\nexport * from \"./lib/react-core\";\n","import React, {\n  useState,\n  useRef,\n  KeyboardEvent,\n  ChangeEvent,\n  useEffect,\n  useLayoutEffect,\n  forwardRef,\n  useImperativeHandle,\n  useCallback,\n  useMemo,\n} from \"react\";\nimport { twMerge } from \"tailwind-merge\";\nimport { Plus, Mic, ArrowUp, X, Check, Square } from \"lucide-react\";\n\nimport {\n  CopilotChatLabels,\n  useCopilotChatConfiguration,\n  CopilotChatDefaultLabels,\n} from \"@/providers/CopilotChatConfigurationProvider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\n\nimport { CopilotChatAudioRecorder } from \"./CopilotChatAudioRecorder\";\nimport { renderSlot, WithSlots } from \"@/lib/slots\";\n\nexport type CopilotChatInputMode = \"input\" | \"transcribe\" | \"processing\";\n\nexport type ToolsMenuItem = {\n  label: string;\n} & (\n  | {\n      action: () => void;\n      items?: never;\n    }\n  | {\n      action?: never;\n      items: (ToolsMenuItem | \"-\")[];\n    }\n);\n\ntype CopilotChatInputSlots = {\n  textArea: typeof CopilotChatInput.TextArea;\n  sendButton: typeof CopilotChatInput.SendButton;\n  startTranscribeButton: typeof CopilotChatInput.StartTranscribeButton;\n  cancelTranscribeButton: typeof CopilotChatInput.CancelTranscribeButton;\n  finishTranscribeButton: typeof CopilotChatInput.FinishTranscribeButton;\n  addMenuButton: typeof CopilotChatInput.AddMenuButton;\n  audioRecorder: typeof CopilotChatAudioRecorder;\n};\n\ntype CopilotChatInputRestProps = {\n  mode?: CopilotChatInputMode;\n  toolsMenu?: (ToolsMenuItem | \"-\")[];\n  autoFocus?: boolean;\n  onSubmitMessage?: (value: string) => void;\n  onStop?: () => void;\n  isRunning?: boolean;\n  onStartTranscribe?: () => void;\n  onCancelTranscribe?: () => void;\n  onFinishTranscribe?: () => void;\n  onAddFile?: () => void;\n  value?: string;\n  onChange?: (value: string) => void;\n} & Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\">;\n\ntype CopilotChatInputBaseProps = WithSlots<CopilotChatInputSlots, CopilotChatInputRestProps>;\n\ntype CopilotChatInputChildrenArgs = CopilotChatInputBaseProps extends { children?: infer C }\n  ? C extends (props: infer P) => React.ReactNode\n    ? P\n    : never\n  : never;\n\nexport type CopilotChatInputProps = Omit<CopilotChatInputBaseProps, \"children\"> & {\n  children?: (props: CopilotChatInputChildrenArgs) => React.ReactNode;\n};\n\nconst SLASH_MENU_MAX_VISIBLE_ITEMS = 5;\nconst SLASH_MENU_ITEM_HEIGHT_PX = 40;\n\nexport function CopilotChatInput({\n  mode = \"input\",\n  onSubmitMessage,\n  onStop,\n  isRunning = false,\n  onStartTranscribe,\n  onCancelTranscribe,\n  onFinishTranscribe,\n  onAddFile,\n  onChange,\n  value,\n  toolsMenu,\n  autoFocus = true,\n  textArea,\n  sendButton,\n  startTranscribeButton,\n  cancelTranscribeButton,\n  finishTranscribeButton,\n  addMenuButton,\n  audioRecorder,\n  children,\n  className,\n  ...props\n}: CopilotChatInputProps) {\n  const isControlled = value !== undefined;\n  const [internalValue, setInternalValue] = useState<string>(() => value ?? \"\");\n\n  useEffect(() => {\n    if (!isControlled && value !== undefined) {\n      setInternalValue(value);\n    }\n  }, [isControlled, value]);\n\n  const resolvedValue = isControlled ? (value ?? \"\") : internalValue;\n\n  const [layout, setLayout] = useState<\"compact\" | \"expanded\">(\"compact\");\n  const ignoreResizeRef = useRef(false);\n  const resizeEvaluationRafRef = useRef<number | null>(null);\n  const isExpanded = mode === \"input\" && layout === \"expanded\";\n  const [commandQuery, setCommandQuery] = useState<string | null>(null);\n  const [slashHighlightIndex, setSlashHighlightIndex] = useState(0);\n\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const gridRef = useRef<HTMLDivElement>(null);\n  const addButtonContainerRef = useRef<HTMLDivElement>(null);\n  const actionsContainerRef = useRef<HTMLDivElement>(null);\n  const audioRecorderRef = useRef<React.ElementRef<typeof CopilotChatAudioRecorder>>(null);\n  const slashMenuRef = useRef<HTMLDivElement>(null);\n  const config = useCopilotChatConfiguration();\n  const labels = config?.labels ?? CopilotChatDefaultLabels;\n\n  const previousModalStateRef = useRef<boolean | undefined>(undefined);\n  const measurementCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const measurementsRef = useRef({\n    singleLineHeight: 0,\n    maxHeight: 0,\n    paddingLeft: 0,\n    paddingRight: 0,\n  });\n\n  const commandItems = useMemo(() => {\n    const entries: ToolsMenuItem[] = [];\n    const seen = new Set<string>();\n\n    const pushItem = (item: ToolsMenuItem | \"-\") => {\n      if (item === \"-\") {\n        return;\n      }\n\n      if (item.items && item.items.length > 0) {\n        for (const nested of item.items) {\n          pushItem(nested);\n        }\n        return;\n      }\n\n      if (!seen.has(item.label)) {\n        seen.add(item.label);\n        entries.push(item);\n      }\n    };\n\n    if (onAddFile) {\n      pushItem({\n        label: labels.chatInputToolbarAddButtonLabel,\n        action: onAddFile,\n      });\n    }\n\n    if (toolsMenu && toolsMenu.length > 0) {\n      for (const item of toolsMenu) {\n        pushItem(item);\n      }\n    }\n\n    return entries;\n  }, [labels.chatInputToolbarAddButtonLabel, onAddFile, toolsMenu]);\n\n  const filteredCommands = useMemo(() => {\n    if (commandQuery === null) {\n      return [] as ToolsMenuItem[];\n    }\n\n    if (commandItems.length === 0) {\n      return [] as ToolsMenuItem[];\n    }\n\n    const query = commandQuery.trim().toLowerCase();\n    if (query.length === 0) {\n      return commandItems;\n    }\n\n    const startsWith: ToolsMenuItem[] = [];\n    const contains: ToolsMenuItem[] = [];\n    for (const item of commandItems) {\n      const label = item.label.toLowerCase();\n      if (label.startsWith(query)) {\n        startsWith.push(item);\n      } else if (label.includes(query)) {\n        contains.push(item);\n      }\n    }\n\n    return [...startsWith, ...contains];\n  }, [commandItems, commandQuery]);\n\n  useEffect(() => {\n    if (!autoFocus) {\n      previousModalStateRef.current = config?.isModalOpen;\n      return;\n    }\n\n    if (config?.isModalOpen && !previousModalStateRef.current) {\n      inputRef.current?.focus();\n    }\n\n    previousModalStateRef.current = config?.isModalOpen;\n  }, [config?.isModalOpen, autoFocus]);\n\n  useEffect(() => {\n    if (commandItems.length === 0 && commandQuery !== null) {\n      setCommandQuery(null);\n    }\n  }, [commandItems.length, commandQuery]);\n\n  const previousCommandQueryRef = useRef<string | null>(null);\n\n  useEffect(() => {\n    if (\n      commandQuery !== null &&\n      commandQuery !== previousCommandQueryRef.current &&\n      filteredCommands.length > 0\n    ) {\n      setSlashHighlightIndex(0);\n    }\n\n    previousCommandQueryRef.current = commandQuery;\n  }, [commandQuery, filteredCommands.length]);\n\n  useEffect(() => {\n    if (commandQuery === null) {\n      setSlashHighlightIndex(0);\n      return;\n    }\n\n    if (filteredCommands.length === 0) {\n      setSlashHighlightIndex(-1);\n    } else if (slashHighlightIndex < 0 || slashHighlightIndex >= filteredCommands.length) {\n      setSlashHighlightIndex(0);\n    }\n  }, [commandQuery, filteredCommands, slashHighlightIndex]);\n\n  // Handle recording based on mode changes\n  useEffect(() => {\n    const recorder = audioRecorderRef.current;\n    if (!recorder) {\n      return;\n    }\n\n    if (mode === \"transcribe\") {\n      // Start recording when entering transcribe mode\n      recorder.start().catch(console.error);\n    } else {\n      // Stop recording when leaving transcribe mode\n      if (recorder.state === \"recording\") {\n        recorder.stop().catch(console.error);\n      }\n    }\n  }, [mode]);\n\n  useEffect(() => {\n    if (mode !== \"input\") {\n      setLayout(\"compact\");\n      setCommandQuery(null);\n    }\n  }, [mode]);\n\n  const updateSlashState = useCallback(\n    (value: string) => {\n      if (commandItems.length === 0) {\n        setCommandQuery((prev) => (prev === null ? prev : null));\n        return;\n      }\n\n      if (value.startsWith(\"/\")) {\n        const firstLine = value.split(/\\r?\\n/, 1)[0] ?? \"\";\n        const query = firstLine.slice(1);\n        setCommandQuery((prev) => (prev === query ? prev : query));\n      } else {\n        setCommandQuery((prev) => (prev === null ? prev : null));\n      }\n    },\n    [commandItems.length],\n  );\n\n  useEffect(() => {\n    updateSlashState(resolvedValue);\n  }, [resolvedValue, updateSlashState]);\n\n  // Handlers\n  const handleChange = (e: ChangeEvent<HTMLTextAreaElement>) => {\n    const nextValue = e.target.value;\n    if (!isControlled) {\n      setInternalValue(nextValue);\n    }\n    onChange?.(nextValue);\n    updateSlashState(nextValue);\n  };\n\n  const clearInputValue = useCallback(() => {\n    if (!isControlled) {\n      setInternalValue(\"\");\n    }\n\n    if (onChange) {\n      onChange(\"\");\n    }\n  }, [isControlled, onChange]);\n\n  const runCommand = useCallback(\n    (item: ToolsMenuItem) => {\n      clearInputValue();\n\n      item.action?.();\n\n      setCommandQuery(null);\n      setSlashHighlightIndex(0);\n\n      requestAnimationFrame(() => {\n        inputRef.current?.focus();\n      });\n    },\n    [clearInputValue],\n  );\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (commandQuery !== null && mode === \"input\") {\n      if (e.key === \"ArrowDown\") {\n        if (filteredCommands.length > 0) {\n          e.preventDefault();\n          setSlashHighlightIndex((prev) => {\n            if (filteredCommands.length === 0) {\n              return prev;\n            }\n            const next = prev === -1 ? 0 : (prev + 1) % filteredCommands.length;\n            return next;\n          });\n        }\n        return;\n      }\n\n      if (e.key === \"ArrowUp\") {\n        if (filteredCommands.length > 0) {\n          e.preventDefault();\n          setSlashHighlightIndex((prev) => {\n            if (filteredCommands.length === 0) {\n              return prev;\n            }\n            if (prev === -1) {\n              return filteredCommands.length - 1;\n            }\n            return prev <= 0 ? filteredCommands.length - 1 : prev - 1;\n          });\n        }\n        return;\n      }\n\n      if (e.key === \"Enter\") {\n        const selected = slashHighlightIndex >= 0 ? filteredCommands[slashHighlightIndex] : undefined;\n        if (selected) {\n          e.preventDefault();\n          runCommand(selected);\n          return;\n        }\n      }\n\n      if (e.key === \"Escape\") {\n        e.preventDefault();\n        setCommandQuery(null);\n        return;\n      }\n    }\n\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      if (isProcessing) {\n        onStop?.();\n      } else {\n        send();\n      }\n    }\n  };\n\n  const send = () => {\n    if (!onSubmitMessage) {\n      return;\n    }\n    const trimmed = resolvedValue.trim();\n    if (!trimmed) {\n      return;\n    }\n\n    onSubmitMessage(trimmed);\n\n    if (!isControlled) {\n      setInternalValue(\"\");\n      onChange?.(\"\");\n    }\n\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  };\n\n  const BoundTextArea = renderSlot(textArea, CopilotChatInput.TextArea, {\n    ref: inputRef,\n    value: resolvedValue,\n    onChange: handleChange,\n    onKeyDown: handleKeyDown,\n    autoFocus: autoFocus,\n    className: twMerge(\n      \"w-full py-3\",\n      isExpanded ? \"px-5\" : \"pr-5\",\n    ),\n  });\n\n  const isProcessing = mode !== \"transcribe\" && isRunning;\n  const canSend = resolvedValue.trim().length > 0 && !!onSubmitMessage;\n  const canStop = !!onStop;\n\n  const handleSendButtonClick = () => {\n    if (isProcessing) {\n      onStop?.();\n      return;\n    }\n    send();\n  };\n\n  const BoundAudioRecorder = renderSlot(audioRecorder, CopilotChatAudioRecorder, {\n    ref: audioRecorderRef,\n  });\n\n  const BoundSendButton = renderSlot(sendButton, CopilotChatInput.SendButton, {\n    onClick: handleSendButtonClick,\n    disabled: isProcessing ? !canStop : !canSend,\n    children: isProcessing && canStop ? <Square className=\"size-[18px] fill-current\" /> : undefined,\n  });\n\n  const BoundStartTranscribeButton = renderSlot(startTranscribeButton, CopilotChatInput.StartTranscribeButton, {\n    onClick: onStartTranscribe,\n  });\n\n  const BoundCancelTranscribeButton = renderSlot(cancelTranscribeButton, CopilotChatInput.CancelTranscribeButton, {\n    onClick: onCancelTranscribe,\n  });\n\n  const BoundFinishTranscribeButton = renderSlot(finishTranscribeButton, CopilotChatInput.FinishTranscribeButton, {\n    onClick: onFinishTranscribe,\n  });\n\n  const BoundAddMenuButton = renderSlot(addMenuButton, CopilotChatInput.AddMenuButton, {\n    disabled: mode === \"transcribe\",\n    onAddFile,\n    toolsMenu,\n  });\n\n  if (children) {\n    const childProps = {\n      textArea: BoundTextArea,\n      audioRecorder: BoundAudioRecorder,\n      sendButton: BoundSendButton,\n      startTranscribeButton: BoundStartTranscribeButton,\n      cancelTranscribeButton: BoundCancelTranscribeButton,\n      finishTranscribeButton: BoundFinishTranscribeButton,\n      addMenuButton: BoundAddMenuButton,\n      onSubmitMessage,\n      onStop,\n      isRunning,\n      onStartTranscribe,\n      onCancelTranscribe,\n      onFinishTranscribe,\n      onAddFile,\n      mode,\n      toolsMenu,\n      autoFocus,\n    } as CopilotChatInputChildrenArgs;\n\n    return <>{children(childProps)}</>;\n  }\n\n  const handleContainerClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    // Don't focus if clicking on buttons or other interactive elements\n    const target = e.target as HTMLElement;\n    if (target.tagName !== \"BUTTON\" && !target.closest(\"button\") && inputRef.current && mode === \"input\") {\n      inputRef.current.focus();\n    }\n  };\n\n  const ensureMeasurements = useCallback(() => {\n    const textarea = inputRef.current;\n    if (!textarea) {\n      return;\n    }\n\n    const previousValue = textarea.value;\n    const previousHeight = textarea.style.height;\n\n    textarea.style.height = \"auto\";\n\n    const computedStyle = window.getComputedStyle(textarea);\n    const paddingLeft = parseFloat(computedStyle.paddingLeft) || 0;\n    const paddingRight = parseFloat(computedStyle.paddingRight) || 0;\n    const paddingTop = parseFloat(computedStyle.paddingTop) || 0;\n    const paddingBottom = parseFloat(computedStyle.paddingBottom) || 0;\n\n    textarea.value = \"\";\n    const singleLineHeight = textarea.scrollHeight;\n    textarea.value = previousValue;\n\n    const contentHeight = singleLineHeight - paddingTop - paddingBottom;\n    const maxHeight = contentHeight * 5 + paddingTop + paddingBottom;\n\n    measurementsRef.current = {\n      singleLineHeight,\n      maxHeight,\n      paddingLeft,\n      paddingRight,\n    };\n\n    textarea.style.height = previousHeight;\n    textarea.style.maxHeight = `${maxHeight}px`;\n  }, []);\n\n  const adjustTextareaHeight = useCallback(() => {\n    const textarea = inputRef.current;\n    if (!textarea) {\n      return 0;\n    }\n\n    if (measurementsRef.current.singleLineHeight === 0) {\n      ensureMeasurements();\n    }\n\n    const { maxHeight } = measurementsRef.current;\n    if (maxHeight) {\n      textarea.style.maxHeight = `${maxHeight}px`;\n    }\n\n    textarea.style.height = \"auto\";\n    const scrollHeight = textarea.scrollHeight;\n    if (maxHeight) {\n      textarea.style.height = `${Math.min(scrollHeight, maxHeight)}px`;\n    } else {\n      textarea.style.height = `${scrollHeight}px`;\n    }\n\n    return scrollHeight;\n  }, [ensureMeasurements]);\n\n  const updateLayout = useCallback((nextLayout: \"compact\" | \"expanded\") => {\n    setLayout((prev) => {\n      if (prev === nextLayout) {\n        return prev;\n      }\n      ignoreResizeRef.current = true;\n      return nextLayout;\n    });\n  }, []);\n\n  const evaluateLayout = useCallback(() => {\n    if (mode !== \"input\") {\n      updateLayout(\"compact\");\n      return;\n    }\n\n    if (typeof window !== \"undefined\" && typeof window.matchMedia === \"function\") {\n      const isMobileViewport = window.matchMedia(\"(max-width: 767px)\").matches;\n      if (isMobileViewport) {\n        ensureMeasurements();\n        adjustTextareaHeight();\n        updateLayout(\"expanded\");\n        return;\n      }\n    }\n\n    const textarea = inputRef.current;\n    const grid = gridRef.current;\n    const addContainer = addButtonContainerRef.current;\n    const actionsContainer = actionsContainerRef.current;\n\n    if (!textarea || !grid || !addContainer || !actionsContainer) {\n      return;\n    }\n\n    if (measurementsRef.current.singleLineHeight === 0) {\n      ensureMeasurements();\n    }\n\n    const scrollHeight = adjustTextareaHeight();\n    const baseline = measurementsRef.current.singleLineHeight;\n    const hasExplicitBreak = resolvedValue.includes(\"\\n\");\n    const renderedMultiline = baseline > 0 ? scrollHeight > baseline + 1 : false;\n    let shouldExpand = hasExplicitBreak || renderedMultiline;\n\n    if (!shouldExpand) {\n      const gridStyles = window.getComputedStyle(grid);\n      const paddingLeft = parseFloat(gridStyles.paddingLeft) || 0;\n      const paddingRight = parseFloat(gridStyles.paddingRight) || 0;\n      const columnGap = parseFloat(gridStyles.columnGap) || 0;\n      const gridAvailableWidth = grid.clientWidth - paddingLeft - paddingRight;\n\n      if (gridAvailableWidth > 0) {\n        const addWidth = addContainer.getBoundingClientRect().width;\n        const actionsWidth = actionsContainer.getBoundingClientRect().width;\n        const compactWidth = Math.max(gridAvailableWidth - addWidth - actionsWidth - columnGap * 2, 0);\n\n        const canvas = measurementCanvasRef.current ?? document.createElement(\"canvas\");\n        if (!measurementCanvasRef.current) {\n          measurementCanvasRef.current = canvas;\n        }\n\n        const context = canvas.getContext(\"2d\");\n        if (context) {\n          const textareaStyles = window.getComputedStyle(textarea);\n          const font =\n            textareaStyles.font ||\n            `${textareaStyles.fontStyle} ${textareaStyles.fontVariant} ${textareaStyles.fontWeight} ${textareaStyles.fontSize}/${textareaStyles.lineHeight} ${textareaStyles.fontFamily}`;\n          context.font = font;\n\n          const compactInnerWidth = Math.max(\n            compactWidth - (measurementsRef.current.paddingLeft || 0) - (measurementsRef.current.paddingRight || 0),\n            0,\n          );\n\n          if (compactInnerWidth > 0) {\n            const lines = resolvedValue.length > 0 ? resolvedValue.split(\"\\n\") : [\"\"];\n            let longestWidth = 0;\n            for (const line of lines) {\n              const metrics = context.measureText(line || \" \");\n              if (metrics.width > longestWidth) {\n                longestWidth = metrics.width;\n              }\n            }\n\n            if (longestWidth > compactInnerWidth) {\n              shouldExpand = true;\n            }\n          }\n        }\n      }\n    }\n\n    const nextLayout = shouldExpand ? \"expanded\" : \"compact\";\n    updateLayout(nextLayout);\n  }, [adjustTextareaHeight, ensureMeasurements, mode, resolvedValue, updateLayout]);\n\n  useLayoutEffect(() => {\n    evaluateLayout();\n  }, [evaluateLayout]);\n\n  useEffect(() => {\n    if (typeof ResizeObserver === \"undefined\") {\n      return;\n    }\n\n    const textarea = inputRef.current;\n    const grid = gridRef.current;\n    const addContainer = addButtonContainerRef.current;\n    const actionsContainer = actionsContainerRef.current;\n\n    if (!textarea || !grid || !addContainer || !actionsContainer) {\n      return;\n    }\n\n    const scheduleEvaluation = () => {\n      if (ignoreResizeRef.current) {\n        ignoreResizeRef.current = false;\n        return;\n      }\n\n      if (typeof window === \"undefined\") {\n        evaluateLayout();\n        return;\n      }\n\n      if (resizeEvaluationRafRef.current !== null) {\n        cancelAnimationFrame(resizeEvaluationRafRef.current);\n      }\n\n      resizeEvaluationRafRef.current = window.requestAnimationFrame(() => {\n        resizeEvaluationRafRef.current = null;\n        evaluateLayout();\n      });\n    };\n\n    const observer = new ResizeObserver(() => {\n      scheduleEvaluation();\n    });\n\n    observer.observe(grid);\n    observer.observe(addContainer);\n    observer.observe(actionsContainer);\n    observer.observe(textarea);\n\n    return () => {\n      observer.disconnect();\n      if (typeof window !== \"undefined\" && resizeEvaluationRafRef.current !== null) {\n        cancelAnimationFrame(resizeEvaluationRafRef.current);\n        resizeEvaluationRafRef.current = null;\n      }\n    };\n  }, [evaluateLayout]);\n\n  const slashMenuVisible = commandQuery !== null && commandItems.length > 0;\n\n  useEffect(() => {\n    if (!slashMenuVisible || slashHighlightIndex < 0) {\n      return;\n    }\n\n    const active = slashMenuRef.current?.querySelector<HTMLElement>(\n      `[data-slash-index=\"${slashHighlightIndex}\"]`,\n    );\n    active?.scrollIntoView({ block: \"nearest\" });\n  }, [slashMenuVisible, slashHighlightIndex]);\n\n  const slashMenu = slashMenuVisible ? (\n    <div\n      data-testid=\"copilot-slash-menu\"\n      role=\"listbox\"\n      aria-label=\"Slash commands\"\n      ref={slashMenuRef}\n      className=\"absolute bottom-full left-0 right-0 z-30 mb-2 max-h-64 overflow-y-auto rounded-lg border border-border bg-white shadow-lg dark:border-[#3a3a3a] dark:bg-[#1f1f1f]\"\n      style={{ maxHeight: `${SLASH_MENU_MAX_VISIBLE_ITEMS * SLASH_MENU_ITEM_HEIGHT_PX}px` }}\n    >\n      {filteredCommands.length === 0 ? (\n        <div className=\"px-3 py-2 text-sm text-muted-foreground\">No commands found</div>\n      ) : (\n        filteredCommands.map((item, index) => {\n          const isActive = index === slashHighlightIndex;\n          return (\n            <button\n              key={`${item.label}-${index}`}\n              type=\"button\"\n              role=\"option\"\n              aria-selected={isActive}\n              data-active={isActive ? \"true\" : undefined}\n              data-slash-index={index}\n              className={twMerge(\n                \"w-full px-3 py-2 text-left text-sm transition-colors\",\n                \"hover:bg-muted dark:hover:bg-[#2f2f2f]\",\n                isActive ? \"bg-muted dark:bg-[#2f2f2f]\" : \"bg-transparent\",\n              )}\n              onMouseEnter={() => setSlashHighlightIndex(index)}\n              onMouseDown={(event) => {\n                event.preventDefault();\n                runCommand(item);\n              }}\n            >\n              {item.label}\n            </button>\n          );\n        })\n      )}\n    </div>\n  ) : null;\n\n  return (\n    <div\n      className={twMerge(\n        // Layout\n        \"flex w-full flex-col items-center justify-center\",\n        // Interaction\n        \"cursor-text\",\n        // Overflow and clipping\n        \"overflow-visible bg-clip-padding contain-inline-size\",\n        // Background\n        \"bg-white dark:bg-[#303030]\",\n        // Visual effects\n        \"shadow-[0_4px_4px_0_#0000000a,0_0_1px_0_#0000009e] rounded-[28px]\",\n        className,\n      )}\n      onClick={handleContainerClick}\n      {...props}\n      data-layout={isExpanded ? \"expanded\" : \"compact\"}\n    >\n      <div\n        ref={gridRef}\n        className={twMerge(\n          \"grid w-full gap-x-3 gap-y-3 px-3 py-2\",\n          isExpanded\n            ? \"grid-cols-[auto_minmax(0,1fr)_auto] grid-rows-[auto_auto]\"\n            : \"grid-cols-[auto_minmax(0,1fr)_auto] items-center\",\n        )}\n        data-layout={isExpanded ? \"expanded\" : \"compact\"}\n      >\n        <div\n          ref={addButtonContainerRef}\n          className={twMerge(\n            \"flex items-center\",\n            isExpanded ? \"row-start-2\" : \"row-start-1\",\n            \"col-start-1\",\n          )}\n        >\n          {BoundAddMenuButton}\n        </div>\n        <div\n          className={twMerge(\n            \"relative flex min-w-0 flex-col\",\n            isExpanded ? \"col-span-3 row-start-1\" : \"col-start-2 row-start-1\",\n          )}\n        >\n          {mode === \"transcribe\" ? (\n            BoundAudioRecorder\n          ) : (\n            <>\n              {BoundTextArea}\n              {slashMenu}\n            </>\n          )}\n        </div>\n        <div\n          ref={actionsContainerRef}\n          className={twMerge(\n            \"flex items-center justify-end gap-2\",\n            isExpanded ? \"col-start-3 row-start-2\" : \"col-start-3 row-start-1\",\n          )}\n        >\n          {mode === \"transcribe\" ? (\n            <>\n              {onCancelTranscribe && BoundCancelTranscribeButton}\n              {onFinishTranscribe && BoundFinishTranscribeButton}\n            </>\n          ) : (\n            <>\n              {onStartTranscribe && BoundStartTranscribeButton}\n              {BoundSendButton}\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace CopilotChatInput {\n  export const SendButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = ({ className, children, ...props }) => (\n    <div className=\"mr-[10px]\">\n      <Button\n        type=\"button\"\n        variant=\"chatInputToolbarPrimary\"\n        size=\"chatInputToolbarIcon\"\n        className={className}\n        {...props}\n      >\n        {children ?? <ArrowUp className=\"size-[18px]\" />}\n      </Button>\n    </div>\n  );\n\n  export const ToolbarButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement> & {\n      icon: React.ReactNode;\n      labelKey: keyof CopilotChatLabels;\n      defaultClassName?: string;\n    }\n  > = ({ icon, labelKey, defaultClassName, className, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            type=\"button\"\n            variant=\"chatInputToolbarSecondary\"\n            size=\"chatInputToolbarIcon\"\n            className={twMerge(defaultClassName, className)}\n            {...props}\n          >\n            {icon}\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent side=\"bottom\">\n          <p>{labels[labelKey]}</p>\n        </TooltipContent>\n      </Tooltip>\n    );\n  };\n\n  export const StartTranscribeButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = (props) => (\n    <ToolbarButton\n      icon={<Mic className=\"size-[18px]\" />}\n      labelKey=\"chatInputToolbarStartTranscribeButtonLabel\"\n      defaultClassName=\"mr-2\"\n      {...props}\n    />\n  );\n\n  export const CancelTranscribeButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = (props) => (\n    <ToolbarButton\n      icon={<X className=\"size-[18px]\" />}\n      labelKey=\"chatInputToolbarCancelTranscribeButtonLabel\"\n      defaultClassName=\"mr-2\"\n      {...props}\n    />\n  );\n\n  export const FinishTranscribeButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = (props) => (\n    <ToolbarButton\n      icon={<Check className=\"size-[18px]\" />}\n      labelKey=\"chatInputToolbarFinishTranscribeButtonLabel\"\n      defaultClassName=\"mr-[10px]\"\n      {...props}\n    />\n  );\n\n  export const AddMenuButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement> & {\n      toolsMenu?: (ToolsMenuItem | \"-\")[];\n      onAddFile?: () => void;\n    }\n  > = ({ className, toolsMenu, onAddFile, disabled, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n\n    const menuItems = useMemo<(ToolsMenuItem | \"-\")[]>(() => {\n      const items: (ToolsMenuItem | \"-\")[] = [];\n\n      if (onAddFile) {\n        items.push({\n          label: labels.chatInputToolbarAddButtonLabel,\n          action: onAddFile,\n        });\n      }\n\n      if (toolsMenu && toolsMenu.length > 0) {\n        if (items.length > 0) {\n          items.push(\"-\");\n        }\n\n        for (const item of toolsMenu) {\n          if (item === \"-\") {\n            if (items.length === 0 || items[items.length - 1] === \"-\") {\n              continue;\n            }\n            items.push(item);\n          } else {\n            items.push(item);\n          }\n        }\n\n        while (items.length > 0 && items[items.length - 1] === \"-\") {\n          items.pop();\n        }\n      }\n\n      return items;\n    }, [onAddFile, toolsMenu, labels.chatInputToolbarAddButtonLabel]);\n\n    const renderMenuItems = useCallback(\n      (items: (ToolsMenuItem | \"-\")[]): React.ReactNode =>\n        items.map((item, index) => {\n          if (item === \"-\") {\n            return <DropdownMenuSeparator key={`separator-${index}`} />;\n          }\n\n          if (item.items && item.items.length > 0) {\n            return (\n              <DropdownMenuSub key={`group-${index}`}>\n                <DropdownMenuSubTrigger>{item.label}</DropdownMenuSubTrigger>\n                <DropdownMenuSubContent>{renderMenuItems(item.items)}</DropdownMenuSubContent>\n              </DropdownMenuSub>\n            );\n          }\n\n          return (\n            <DropdownMenuItem key={`item-${index}`} onClick={item.action}>\n              {item.label}\n            </DropdownMenuItem>\n          );\n        }),\n      [],\n    );\n\n    const hasMenuItems = menuItems.length > 0;\n    const isDisabled = disabled || !hasMenuItems;\n\n    return (\n      <DropdownMenu>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <DropdownMenuTrigger asChild>\n              <Button\n                type=\"button\"\n                variant=\"chatInputToolbarSecondary\"\n                size=\"chatInputToolbarIcon\"\n                className={twMerge(\"ml-1\", className)}\n                disabled={isDisabled}\n                {...props}\n              >\n                <Plus className=\"size-[20px]\" />\n              </Button>\n            </DropdownMenuTrigger>\n          </TooltipTrigger>\n          <TooltipContent side=\"bottom\">\n            <p className=\"flex items-center gap-1 text-xs font-medium\">\n              <span>Add files and more</span>\n              <code className=\"rounded bg-[#4a4a4a] px-1 py-[1px] font-mono text-[11px] text-white dark:bg-[#e0e0e0] dark:text-black\">/</code>\n            </p>\n          </TooltipContent>\n        </Tooltip>\n        {hasMenuItems && (\n          <DropdownMenuContent side=\"top\" align=\"start\">\n            {renderMenuItems(menuItems)}\n          </DropdownMenuContent>\n        )}\n      </DropdownMenu>\n    );\n  };\n\n  export type TextAreaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>;\n\n  export const TextArea = forwardRef<HTMLTextAreaElement, TextAreaProps>(function TextArea(\n    { style, className, autoFocus, ...props },\n    ref,\n  ) {\n    const internalTextareaRef = useRef<HTMLTextAreaElement>(null);\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n\n    useImperativeHandle(ref, () => internalTextareaRef.current as HTMLTextAreaElement);\n\n    // Auto-scroll input into view on mobile when focused\n    useEffect(() => {\n      const textarea = internalTextareaRef.current;\n      if (!textarea) return;\n\n      const handleFocus = () => {\n        // Small delay to let the keyboard start appearing\n        setTimeout(() => {\n          textarea.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n        }, 300);\n      };\n\n      textarea.addEventListener(\"focus\", handleFocus);\n      return () => textarea.removeEventListener(\"focus\", handleFocus);\n    }, []);\n\n    useEffect(() => {\n      if (autoFocus) {\n        internalTextareaRef.current?.focus();\n      }\n    }, [autoFocus]);\n\n    return (\n      <textarea\n        ref={internalTextareaRef}\n        {...props}\n        style={{\n          overflow: \"auto\",\n          resize: \"none\",\n          ...style,\n        }}\n        placeholder={labels.chatInputPlaceholder}\n        className={twMerge(\n          \"bg-transparent outline-none antialiased font-regular leading-relaxed text-[16px] placeholder:text-[#00000077] dark:placeholder:text-[#fffc]\",\n          className,\n        )}\n        rows={1}\n      />\n    );\n  });\n\n  export const AudioRecorder = CopilotChatAudioRecorder;\n}\n\nCopilotChatInput.TextArea.displayName = \"CopilotChatInput.TextArea\";\nCopilotChatInput.SendButton.displayName = \"CopilotChatInput.SendButton\";\nCopilotChatInput.ToolbarButton.displayName = \"CopilotChatInput.ToolbarButton\";\nCopilotChatInput.StartTranscribeButton.displayName = \"CopilotChatInput.StartTranscribeButton\";\nCopilotChatInput.CancelTranscribeButton.displayName = \"CopilotChatInput.CancelTranscribeButton\";\nCopilotChatInput.FinishTranscribeButton.displayName = \"CopilotChatInput.FinishTranscribeButton\";\nCopilotChatInput.AddMenuButton.displayName = \"CopilotChatInput.AddMenuButton\";\n\nexport default CopilotChatInput;\n","import React, { createContext, useContext, ReactNode, useMemo, useState } from \"react\";\nimport { DEFAULT_AGENT_ID, randomUUID } from \"@copilotkitnext/shared\";\n\n// Default labels\nexport const CopilotChatDefaultLabels = {\n  chatInputPlaceholder: \"Type a message...\",\n  chatInputToolbarStartTranscribeButtonLabel: \"Transcribe\",\n  chatInputToolbarCancelTranscribeButtonLabel: \"Cancel\",\n  chatInputToolbarFinishTranscribeButtonLabel: \"Finish\",\n  chatInputToolbarAddButtonLabel: \"Add photos or files\",\n  chatInputToolbarToolsButtonLabel: \"Tools\",\n  assistantMessageToolbarCopyCodeLabel: \"Copy\",\n  assistantMessageToolbarCopyCodeCopiedLabel: \"Copied\",\n  assistantMessageToolbarCopyMessageLabel: \"Copy\",\n  assistantMessageToolbarThumbsUpLabel: \"Good response\",\n  assistantMessageToolbarThumbsDownLabel: \"Bad response\",\n  assistantMessageToolbarReadAloudLabel: \"Read aloud\",\n  assistantMessageToolbarRegenerateLabel: \"Regenerate\",\n  userMessageToolbarCopyMessageLabel: \"Copy\",\n  userMessageToolbarEditMessageLabel: \"Edit\",\n  chatDisclaimerText: \"AI can make mistakes. Please verify important information.\",\n  chatToggleOpenLabel: \"Open chat\",\n  chatToggleCloseLabel: \"Close chat\",\n  modalHeaderTitle: \"CopilotKit Chat\",\n};\n\nexport type CopilotChatLabels = typeof CopilotChatDefaultLabels;\n\n// Define the full configuration interface\nexport interface CopilotChatConfigurationValue {\n  labels: CopilotChatLabels;\n  agentId: string;\n  threadId: string;\n  isModalOpen: boolean;\n  setModalOpen: (open: boolean) => void;\n  isModalDefaultOpen: boolean;\n}\n\n// Create the configuration context\nconst CopilotChatConfiguration =\n  createContext<CopilotChatConfigurationValue | null>(null);\n\n// Provider props interface\nexport interface CopilotChatConfigurationProviderProps {\n  children: ReactNode;\n  labels?: Partial<CopilotChatLabels>;\n  agentId?: string;\n  threadId?: string;\n  isModalDefaultOpen?: boolean;\n}\n\n// Provider component\nexport const CopilotChatConfigurationProvider: React.FC<\n  CopilotChatConfigurationProviderProps\n> = ({ children, labels, agentId, threadId, isModalDefaultOpen }) => {\n  const parentConfig = useContext(CopilotChatConfiguration);\n\n  const mergedLabels: CopilotChatLabels = useMemo(\n    () => ({\n      ...CopilotChatDefaultLabels,\n      ...(parentConfig?.labels ?? {}),\n      ...(labels ?? {}),\n    }),\n    [labels, parentConfig?.labels],\n  );\n\n  const resolvedAgentId = agentId ?? parentConfig?.agentId ?? DEFAULT_AGENT_ID;\n\n  const resolvedThreadId = useMemo(() => {\n    if (threadId) {\n      return threadId;\n    }\n    if (parentConfig?.threadId) {\n      return parentConfig.threadId;\n    }\n    return randomUUID();\n  }, [threadId, parentConfig?.threadId]);\n\n  const resolvedDefaultOpen = isModalDefaultOpen ?? parentConfig?.isModalDefaultOpen ?? true;\n\n  const [internalModalOpen, setInternalModalOpen] = useState<boolean>(\n    parentConfig?.isModalOpen ?? resolvedDefaultOpen,\n  );\n\n  const resolvedIsModalOpen = parentConfig?.isModalOpen ?? internalModalOpen;\n  const resolvedSetModalOpen = parentConfig?.setModalOpen ?? setInternalModalOpen;\n\n  const configurationValue: CopilotChatConfigurationValue = useMemo(\n    () => ({\n      labels: mergedLabels,\n      agentId: resolvedAgentId,\n      threadId: resolvedThreadId,\n      isModalOpen: resolvedIsModalOpen,\n      setModalOpen: resolvedSetModalOpen,\n      isModalDefaultOpen: resolvedDefaultOpen,\n    }),\n    [\n      mergedLabels,\n      resolvedAgentId,\n      resolvedThreadId,\n      resolvedIsModalOpen,\n      resolvedSetModalOpen,\n      resolvedDefaultOpen,\n    ],\n  );\n\n  return (\n    <CopilotChatConfiguration.Provider value={configurationValue}>\n      {children}\n    </CopilotChatConfiguration.Provider>\n  );\n};\n\n// Hook to use the full configuration\nexport const useCopilotChatConfiguration =\n  (): CopilotChatConfigurationValue | null => {\n    const configuration = useContext(CopilotChatConfiguration);\n    return configuration;\n  };\n","import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 cursor-pointer\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        assistantMessageToolbarButton: [\n          \"cursor-pointer\",\n          // Background and text\n          \"p-0 text-[rgb(93,93,93)] hover:bg-[#E8E8E8]\",\n          // Dark mode - lighter gray for better contrast\n          \"dark:text-[rgb(243,243,243)] dark:hover:bg-[#303030]\",\n          // Shape and sizing\n          \"h-8 w-8\",\n          // Interactions\n          \"transition-colors\",\n          // Hover states\n          \"hover:text-[rgb(93,93,93)]\",\n          \"dark:hover:text-[rgb(243,243,243)]\",\n        ],\n        chatInputToolbarPrimary: [\n          \"cursor-pointer\",\n          // Background and text\n          \"bg-black text-white\",\n          // Dark mode\n          \"dark:bg-white dark:text-black dark:focus-visible:outline-white\",\n          // Shape and sizing\n          \"rounded-full\",\n          // Interactions\n          \"transition-colors\",\n          // Focus states\n          \"focus:outline-none\",\n          // Hover states\n          \"hover:opacity-70 disabled:hover:opacity-100\",\n          // Disabled states\n          \"disabled:cursor-not-allowed disabled:bg-[#00000014] disabled:text-[rgb(13,13,13)]\",\n          \"dark:disabled:bg-[#454545] dark:disabled:text-white \",\n        ],\n        chatInputToolbarSecondary: [\n          \"cursor-pointer\",\n          // Background and text\n          \"bg-transparent text-[#444444]\",\n          // Dark mode\n          \"dark:text-white dark:border-[#404040]\",\n          // Shape and sizing\n          \"rounded-full\",\n          // Interactions\n          \"transition-colors\",\n          // Focus states\n          \"focus:outline-none\",\n          // Hover states\n          \"hover:bg-[#f8f8f8] hover:text-[#333333]\",\n          \"dark:hover:bg-[#404040] dark:hover:text-[#FFFFFF]\",\n          // Disabled states\n          \"disabled:cursor-not-allowed disabled:opacity-50\",\n          \"disabled:hover:bg-transparent disabled:hover:text-[#444444]\",\n          \"dark:disabled:hover:bg-transparent dark:disabled:hover:text-[#CCCCCC]\",\n        ],\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        chatInputToolbarIcon: [\n          // Shape and sizing\n          \"h-9 w-9 rounded-full\",\n        ],\n        chatInputToolbarIconLabel: [\n          // Shape and sizing\n          \"h-9 px-3 rounded-full\",\n          // Layout\n          \"gap-2\",\n          // Typography\n          \"font-normal\",\n        ],\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n);\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean;\n  }) {\n  const Comp = asChild ? Slot : \"button\";\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  );\n}\n\nexport { Button, buttonVariants };\n","import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n","import * as React from \"react\";\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction TooltipProvider({\n  delayDuration = 0,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\n  return (\n    <TooltipPrimitive.Provider\n      data-slot=\"tooltip-provider\"\n      delayDuration={delayDuration}\n      {...props}\n    />\n  );\n}\n\nfunction Tooltip({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\n  return (\n    <TooltipProvider>\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\n    </TooltipProvider>\n  );\n}\n\nfunction TooltipTrigger({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />;\n}\n\nfunction TooltipContent({\n  className,\n  sideOffset = 0,\n  children,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\n  return (\n    <TooltipPrimitive.Portal>\n      <TooltipPrimitive.Content\n        data-slot=\"tooltip-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        <TooltipPrimitive.Arrow className=\"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]\" />\n      </TooltipPrimitive.Content>\n    </TooltipPrimitive.Portal>\n  );\n}\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n","\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { CheckIcon, ChevronRightIcon, CircleIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction DropdownMenu({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {\n  return <DropdownMenuPrimitive.Root data-slot=\"dropdown-menu\" {...props} />\n}\n\nfunction DropdownMenuPortal({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {\n  return (\n    <DropdownMenuPrimitive.Portal data-slot=\"dropdown-menu-portal\" {...props} />\n  )\n}\n\nfunction DropdownMenuTrigger({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {\n  return (\n    <DropdownMenuPrimitive.Trigger\n      data-slot=\"dropdown-menu-trigger\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuContent({\n  className,\n  sideOffset = 4,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {\n  return (\n    <DropdownMenuPrimitive.Portal>\n      <DropdownMenuPrimitive.Content\n        data-slot=\"dropdown-menu-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md\",\n          className\n        )}\n        {...props}\n      />\n    </DropdownMenuPrimitive.Portal>\n  )\n}\n\nfunction DropdownMenuGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {\n  return (\n    <DropdownMenuPrimitive.Group data-slot=\"dropdown-menu-group\" {...props} />\n  )\n}\n\nfunction DropdownMenuItem({\n  className,\n  inset,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {\n  inset?: boolean\n  variant?: \"default\" | \"destructive\"\n}) {\n  return (\n    <DropdownMenuPrimitive.Item\n      data-slot=\"dropdown-menu-item\"\n      data-inset={inset}\n      data-variant={variant}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuCheckboxItem({\n  className,\n  children,\n  checked,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {\n  return (\n    <DropdownMenuPrimitive.CheckboxItem\n      data-slot=\"dropdown-menu-checkbox-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      checked={checked}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.CheckboxItem>\n  )\n}\n\nfunction DropdownMenuRadioGroup({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {\n  return (\n    <DropdownMenuPrimitive.RadioGroup\n      data-slot=\"dropdown-menu-radio-group\"\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuRadioItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {\n  return (\n    <DropdownMenuPrimitive.RadioItem\n      data-slot=\"dropdown-menu-radio-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <CircleIcon className=\"size-2 fill-current\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.RadioItem>\n  )\n}\n\nfunction DropdownMenuLabel({\n  className,\n  inset,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.Label\n      data-slot=\"dropdown-menu-label\"\n      data-inset={inset}\n      className={cn(\n        \"px-2 py-1.5 text-sm font-medium data-[inset]:pl-8\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {\n  return (\n    <DropdownMenuPrimitive.Separator\n      data-slot=\"dropdown-menu-separator\"\n      className={cn(\"bg-border -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuShortcut({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      data-slot=\"dropdown-menu-shortcut\"\n      className={cn(\n        \"text-muted-foreground ml-auto text-xs tracking-widest\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DropdownMenuSub({\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {\n  return <DropdownMenuPrimitive.Sub data-slot=\"dropdown-menu-sub\" {...props} />\n}\n\nfunction DropdownMenuSubTrigger({\n  className,\n  inset,\n  children,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {\n  inset?: boolean\n}) {\n  return (\n    <DropdownMenuPrimitive.SubTrigger\n      data-slot=\"dropdown-menu-sub-trigger\"\n      data-inset={inset}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronRightIcon className=\"ml-auto size-4\" />\n    </DropdownMenuPrimitive.SubTrigger>\n  )\n}\n\nfunction DropdownMenuSubContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {\n  return (\n    <DropdownMenuPrimitive.SubContent\n      data-slot=\"dropdown-menu-sub-content\"\n      className={cn(\n        \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  DropdownMenu,\n  DropdownMenuPortal,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuLabel,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n}\n","import { useRef, useEffect, useImperativeHandle, forwardRef } from \"react\";\nimport { twMerge } from \"tailwind-merge\";\n\n/** Finite-state machine for every recorder implementation */\nexport type AudioRecorderState = \"idle\" | \"recording\" | \"processing\";\n\n/** Error subclass so callers can `instanceof`-guard recorder failures */\nexport class AudioRecorderError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"AudioRecorderError\";\n  }\n}\n\nexport const CopilotChatAudioRecorder = forwardRef<\n  any,\n  React.HTMLAttributes<HTMLDivElement>\n>((props, ref) => {\n  const { className, ...divProps } = props;\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  // Generate fake waveform that moves with time\n  const getLoudness = (n: number): number[] => {\n    const elapsed = Date.now() / 1000; // Use current timestamp directly\n    const samples: number[] = [];\n\n    for (let i = 0; i < n; i++) {\n      // Create a position that moves from left to right over time\n      const position = (i / n) * 10 + elapsed * 0.5; // Scroll speed (slower)\n\n      // Generate waveform using multiple sine waves for realism\n      const wave1 = Math.sin(position * 2) * 0.3;\n      const wave2 = Math.sin(position * 5 + elapsed) * 0.2;\n      const wave3 = Math.sin(position * 0.5 + elapsed * 0.3) * 0.4;\n\n      // Add some randomness for natural variation\n      const noise = (Math.random() - 0.5) * 0.1;\n\n      // Combine waves and add envelope for realistic amplitude variation\n      const envelope = Math.sin(elapsed * 0.7) * 0.5 + 0.5; // Slow amplitude modulation\n      let amplitude = (wave1 + wave2 + wave3 + noise) * envelope;\n\n      // Clamp to 0-1 range\n      amplitude = Math.max(0, Math.min(1, amplitude * 0.5 + 0.3));\n\n      samples.push(amplitude);\n    }\n\n    return samples;\n  };\n\n  // No setup needed - stub implementation\n\n  // Canvas rendering with 60fps animation\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    let animationId: number;\n\n    const draw = () => {\n      const rect = canvas.getBoundingClientRect();\n      const dpr = window.devicePixelRatio || 1;\n\n      // Update canvas dimensions if container resized\n      if (\n        canvas.width !== rect.width * dpr ||\n        canvas.height !== rect.height * dpr\n      ) {\n        canvas.width = rect.width * dpr;\n        canvas.height = rect.height * dpr;\n        ctx.scale(dpr, dpr);\n        ctx.imageSmoothingEnabled = false;\n      }\n\n      // Configuration\n      const barWidth = 2;\n      const minHeight = 2;\n      const maxHeight = 20;\n      const gap = 2;\n      const numSamples = Math.ceil(rect.width / (barWidth + gap));\n\n      // Get loudness data\n      const loudnessData = getLoudness(numSamples);\n\n      // Clear canvas\n      ctx.clearRect(0, 0, rect.width, rect.height);\n\n      // Get current foreground color\n      const computedStyle = getComputedStyle(canvas);\n      const currentForeground = computedStyle.color;\n\n      // Draw bars\n      ctx.fillStyle = currentForeground;\n      const centerY = rect.height / 2;\n\n      for (let i = 0; i < loudnessData.length; i++) {\n        const sample = loudnessData[i] ?? 0;\n        const barHeight = Math.round(\n          sample * (maxHeight - minHeight) + minHeight\n        );\n        const x = Math.round(i * (barWidth + gap));\n        const y = Math.round(centerY - barHeight / 2);\n\n        ctx.fillRect(x, y, barWidth, barHeight);\n      }\n\n      animationId = requestAnimationFrame(draw);\n    };\n\n    draw();\n\n    return () => {\n      if (animationId) {\n        cancelAnimationFrame(animationId);\n      }\n    };\n  }, []);\n\n  // Expose AudioRecorder API\n  useImperativeHandle(\n    ref,\n    () => ({\n      get state() {\n        return \"idle\" as AudioRecorderState;\n      },\n      start: async () => {\n        // Stub implementation - no actual recording\n      },\n      stop: () =>\n        new Promise<Blob>((resolve) => {\n          // Stub implementation - return empty blob\n          const emptyBlob = new Blob([], { type: \"audio/webm\" });\n          resolve(emptyBlob);\n        }),\n      dispose: () => {\n        // No cleanup needed\n      },\n    }),\n    []\n  );\n\n  return (\n    <div className={twMerge(\"h-[44px] w-full px-5\", className)} {...divProps}>\n      <canvas\n        ref={canvasRef}\n        className=\"w-full h-full\"\n        style={{ imageRendering: \"pixelated\" }}\n      />\n    </div>\n  );\n});\n\nCopilotChatAudioRecorder.displayName = \"WebAudioRecorder\";\n","import React from \"react\";\n\n/** Existing union (unchanged) */\nexport type SlotValue<C extends React.ComponentType<any>> =\n  | C\n  | string\n  | Partial<React.ComponentProps<C>>;\n\n/**\n * Shallow equality comparison for objects.\n */\nexport function shallowEqual<T extends Record<string, unknown>>(obj1: T, obj2: T): boolean {\n  const keys1 = Object.keys(obj1);\n  const keys2 = Object.keys(obj2);\n\n  if (keys1.length !== keys2.length) return false;\n\n  for (const key of keys1) {\n    if (obj1[key] !== obj2[key]) return false;\n  }\n\n  return true;\n}\n\n/** Utility: concrete React elements for every slot */\ntype SlotElements<S> = { [K in keyof S]: React.ReactElement };\n\nexport type WithSlots<\n  S extends Record<string, React.ComponentType<any>>,\n  Rest = {},\n> = {\n  /** Perslot overrides */\n  [K in keyof S]?: SlotValue<S[K]>;\n} & {\n  children?: (props: SlotElements<S> & Rest) => React.ReactNode;\n} & Omit<Rest, \"children\">;\n\n/**\n * Internal function to render a slot value as a React element (non-memoized).\n */\nfunction renderSlotElement(\n  slot: SlotValue<React.ComponentType<any>> | undefined,\n  DefaultComponent: React.ComponentType<any>,\n  props: Record<string, unknown>\n): React.ReactElement {\n  if (typeof slot === \"string\") {\n    return React.createElement(DefaultComponent, {\n      ...props,\n      className: slot,\n    });\n  }\n  if (typeof slot === \"function\") {\n    return React.createElement(slot as React.ComponentType<any>, props);\n  }\n\n  if (slot && typeof slot === \"object\" && !React.isValidElement(slot)) {\n    return React.createElement(DefaultComponent, {\n      ...props,\n      ...slot,\n    });\n  }\n\n  return React.createElement(DefaultComponent, props);\n}\n\n/**\n * Internal memoized wrapper component for renderSlot.\n * Uses forwardRef to support ref forwarding.\n */\nconst MemoizedSlotWrapper = React.memo(\n  React.forwardRef<unknown, any>(function MemoizedSlotWrapper(props, ref) {\n    const { $slot, $component, ...rest } = props;\n    const propsWithRef: Record<string, unknown> = ref !== null ? { ...rest, ref } : rest;\n    return renderSlotElement($slot, $component, propsWithRef);\n  }),\n  (prev: any, next: any) => {\n    // Compare slot and component references\n    if (prev.$slot !== next.$slot) return false;\n    if (prev.$component !== next.$component) return false;\n\n    // Shallow compare remaining props (ref is handled separately by React)\n    const { $slot: _ps, $component: _pc, ...prevRest } = prev;\n    const { $slot: _ns, $component: _nc, ...nextRest } = next;\n    return shallowEqual(\n      prevRest as Record<string, unknown>,\n      nextRest as Record<string, unknown>\n    );\n  }\n);\n\n/**\n * Renders a slot value as a memoized React element.\n * Automatically prevents unnecessary re-renders using shallow prop comparison.\n * Supports ref forwarding.\n *\n * @example\n * renderSlot(customInput, CopilotChatInput, { onSubmit: handleSubmit })\n */\nexport function renderSlot<C extends React.ComponentType<any>, P = React.ComponentProps<C>>(\n  slot: SlotValue<C> | undefined,\n  DefaultComponent: C,\n  props: P\n): React.ReactElement {\n  return React.createElement(MemoizedSlotWrapper, {\n    ...props,\n    $slot: slot,\n    $component: DefaultComponent,\n  } as any);\n}\n","import { AssistantMessage, Message } from \"@ag-ui/core\";\nimport { useState } from \"react\";\nimport {\n  Copy,\n  Check,\n  ThumbsUp,\n  ThumbsDown,\n  Volume2,\n  RefreshCw,\n} from \"lucide-react\";\nimport {\n  useCopilotChatConfiguration,\n  CopilotChatDefaultLabels,\n} from \"@/providers/CopilotChatConfigurationProvider\";\nimport { twMerge } from \"tailwind-merge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport \"katex/dist/katex.min.css\";\nimport { WithSlots, renderSlot } from \"@/lib/slots\";\nimport { Streamdown } from \"streamdown\";\nimport CopilotChatToolCallsView from \"./CopilotChatToolCallsView\";\n\nexport type CopilotChatAssistantMessageProps = WithSlots<\n  {\n    markdownRenderer: typeof CopilotChatAssistantMessage.MarkdownRenderer;\n    toolbar: typeof CopilotChatAssistantMessage.Toolbar;\n    copyButton: typeof CopilotChatAssistantMessage.CopyButton;\n    thumbsUpButton: typeof CopilotChatAssistantMessage.ThumbsUpButton;\n    thumbsDownButton: typeof CopilotChatAssistantMessage.ThumbsDownButton;\n    readAloudButton: typeof CopilotChatAssistantMessage.ReadAloudButton;\n    regenerateButton: typeof CopilotChatAssistantMessage.RegenerateButton;\n    toolCallsView: typeof CopilotChatToolCallsView;\n  },\n  {\n    onThumbsUp?: (message: AssistantMessage) => void;\n    onThumbsDown?: (message: AssistantMessage) => void;\n    onReadAloud?: (message: AssistantMessage) => void;\n    onRegenerate?: (message: AssistantMessage) => void;\n    message: AssistantMessage;\n    messages?: Message[];\n    isRunning?: boolean;\n    additionalToolbarItems?: React.ReactNode;\n    toolbarVisible?: boolean;\n  } & React.HTMLAttributes<HTMLDivElement>\n>;\n\nexport function CopilotChatAssistantMessage({\n  message,\n  messages,\n  isRunning,\n  onThumbsUp,\n  onThumbsDown,\n  onReadAloud,\n  onRegenerate,\n  additionalToolbarItems,\n  toolbarVisible = true,\n  markdownRenderer,\n  toolbar,\n  copyButton,\n  thumbsUpButton,\n  thumbsDownButton,\n  readAloudButton,\n  regenerateButton,\n  toolCallsView,\n  children,\n  className,\n  ...props\n}: CopilotChatAssistantMessageProps) {\n  const boundMarkdownRenderer = renderSlot(\n    markdownRenderer,\n    CopilotChatAssistantMessage.MarkdownRenderer,\n    {\n      content: message.content || \"\",\n      \n    }\n  );\n\n  const boundCopyButton = renderSlot(\n    copyButton,\n    CopilotChatAssistantMessage.CopyButton,\n    {\n      onClick: async () => {\n        if (message.content) {\n          try {\n            await navigator.clipboard.writeText(message.content);\n          } catch (err) {\n            console.error(\"Failed to copy message:\", err);\n          }\n        }\n      },\n    }\n  );\n\n  const boundThumbsUpButton = renderSlot(\n    thumbsUpButton,\n    CopilotChatAssistantMessage.ThumbsUpButton,\n    {\n      onClick: onThumbsUp,\n    }\n  );\n\n  const boundThumbsDownButton = renderSlot(\n    thumbsDownButton,\n    CopilotChatAssistantMessage.ThumbsDownButton,\n    {\n      onClick: onThumbsDown,\n    }\n  );\n\n  const boundReadAloudButton = renderSlot(\n    readAloudButton,\n    CopilotChatAssistantMessage.ReadAloudButton,\n    {\n      onClick: onReadAloud,\n    }\n  );\n\n  const boundRegenerateButton = renderSlot(\n    regenerateButton,\n    CopilotChatAssistantMessage.RegenerateButton,\n    {\n      onClick: onRegenerate,\n    }\n  );\n\n  const boundToolbar = renderSlot(\n    toolbar,\n    CopilotChatAssistantMessage.Toolbar,\n    {\n      children: (\n        <div className=\"flex items-center gap-1\">\n          {boundCopyButton}\n          {(onThumbsUp || thumbsUpButton) && boundThumbsUpButton}\n          {(onThumbsDown || thumbsDownButton) && boundThumbsDownButton}\n          {(onReadAloud || readAloudButton) && boundReadAloudButton}\n          {(onRegenerate || regenerateButton) && boundRegenerateButton}\n          {additionalToolbarItems}\n        </div>\n      ),\n    }\n  );\n\n  const boundToolCallsView = renderSlot(\n    toolCallsView,\n    CopilotChatToolCallsView,\n    {\n      message,\n      messages,\n    }\n  );\n\n  // Don't show toolbar if message has no content (only tool calls)\n  const hasContent = !!(message.content && message.content.trim().length > 0);\n  const isLatestAssistantMessage =\n    message.role === \"assistant\" && messages?.[messages.length - 1]?.id === message.id;\n  const shouldShowToolbar = toolbarVisible && hasContent && !(isRunning && isLatestAssistantMessage);\n\n  if (children) {\n    return (\n      <>\n        {children({\n          markdownRenderer: boundMarkdownRenderer,\n          toolbar: boundToolbar,\n          toolCallsView: boundToolCallsView,\n          copyButton: boundCopyButton,\n          thumbsUpButton: boundThumbsUpButton,\n          thumbsDownButton: boundThumbsDownButton,\n          readAloudButton: boundReadAloudButton,\n          regenerateButton: boundRegenerateButton,\n          message,\n          messages,\n          isRunning,\n          onThumbsUp,\n          onThumbsDown,\n          onReadAloud,\n          onRegenerate,\n          additionalToolbarItems,\n          toolbarVisible: shouldShowToolbar,\n        })}\n      </>\n    );\n  }\n\n  return (\n    <div\n      className={twMerge(\n        \"prose max-w-full break-words dark:prose-invert\",\n        className\n      )}\n      {...props}\n      data-message-id={message.id}\n    >\n      {boundMarkdownRenderer}\n      {boundToolCallsView}\n      {shouldShowToolbar && boundToolbar}\n    </div>\n  );\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace CopilotChatAssistantMessage {\n  export const MarkdownRenderer: React.FC<\n    Omit<React.ComponentProps<typeof Streamdown>, \"children\"> & {\n      content: string;\n    }\n  > = ({ content, className, ...props }) => (\n    <Streamdown className={className} {...props}>\n      {content ?? \"\"}\n    </Streamdown>\n  );\n\n  export const Toolbar: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({\n    className,\n    ...props\n  }) => (\n    <div\n      className={twMerge(\n        \"w-full bg-transparent flex items-center -ml-[5px] -mt-[0px]\",\n        className\n      )}\n      {...props}\n    />\n  );\n\n  export const ToolbarButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement> & {\n      title: string;\n      children: React.ReactNode;\n    }\n  > = ({ title, children, ...props }) => {\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            type=\"button\"\n            variant=\"assistantMessageToolbarButton\"\n            aria-label={title}\n            {...props}\n          >\n            {children}\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent side=\"bottom\">\n          <p>{title}</p>\n        </TooltipContent>\n      </Tooltip>\n    );\n  };\n\n  export const CopyButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ className, title, onClick, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    const [copied, setCopied] = useState(false);\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n\n      if (onClick) {\n        onClick(event);\n      }\n    };\n\n    return (\n      <ToolbarButton\n        title={title || labels.assistantMessageToolbarCopyMessageLabel}\n        onClick={handleClick}\n        className={className}\n        {...props}\n      >\n        {copied ? (\n          <Check className=\"size-[18px]\" />\n        ) : (\n          <Copy className=\"size-[18px]\" />\n        )}\n      </ToolbarButton>\n    );\n  };\n\n  export const ThumbsUpButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ title, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <ToolbarButton\n        title={title || labels.assistantMessageToolbarThumbsUpLabel}\n        {...props}\n      >\n        <ThumbsUp className=\"size-[18px]\" />\n      </ToolbarButton>\n    );\n  };\n\n  export const ThumbsDownButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ title, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <ToolbarButton\n        title={title || labels.assistantMessageToolbarThumbsDownLabel}\n        {...props}\n      >\n        <ThumbsDown className=\"size-[18px]\" />\n      </ToolbarButton>\n    );\n  };\n\n  export const ReadAloudButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ title, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <ToolbarButton\n        title={title || labels.assistantMessageToolbarReadAloudLabel}\n        {...props}\n      >\n        <Volume2 className=\"size-[20px]\" />\n      </ToolbarButton>\n    );\n  };\n\n  export const RegenerateButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ title, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <ToolbarButton\n        title={title || labels.assistantMessageToolbarRegenerateLabel}\n        {...props}\n      >\n        <RefreshCw className=\"size-[18px]\" />\n      </ToolbarButton>\n    );\n  };\n}\n\nCopilotChatAssistantMessage.MarkdownRenderer.displayName =\n  \"CopilotChatAssistantMessage.MarkdownRenderer\";\nCopilotChatAssistantMessage.Toolbar.displayName =\n  \"CopilotChatAssistantMessage.Toolbar\";\nCopilotChatAssistantMessage.CopyButton.displayName =\n  \"CopilotChatAssistantMessage.CopyButton\";\nCopilotChatAssistantMessage.ThumbsUpButton.displayName =\n  \"CopilotChatAssistantMessage.ThumbsUpButton\";\nCopilotChatAssistantMessage.ThumbsDownButton.displayName =\n  \"CopilotChatAssistantMessage.ThumbsDownButton\";\nCopilotChatAssistantMessage.ReadAloudButton.displayName =\n  \"CopilotChatAssistantMessage.ReadAloudButton\";\nCopilotChatAssistantMessage.RegenerateButton.displayName =\n  \"CopilotChatAssistantMessage.RegenerateButton\";\n\nexport default CopilotChatAssistantMessage;\n","import React, { useCallback, useMemo, useSyncExternalStore } from \"react\";\nimport { ToolCall, ToolMessage } from \"@ag-ui/core\";\nimport { ToolCallStatus } from \"@copilotkitnext/core\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { useCopilotChatConfiguration } from \"@/providers/CopilotChatConfigurationProvider\";\nimport { DEFAULT_AGENT_ID } from \"@copilotkitnext/shared\";\nimport { partialJSONParse } from \"@copilotkitnext/shared\";\nimport { ReactToolCallRenderer } from \"@/types/react-tool-call-renderer\";\n\nexport interface UseRenderToolCallProps {\n  toolCall: ToolCall;\n  toolMessage?: ToolMessage;\n}\n\n/**\n * Props for the memoized ToolCallRenderer component\n */\ninterface ToolCallRendererProps {\n  toolCall: ToolCall;\n  toolMessage?: ToolMessage;\n  RenderComponent: ReactToolCallRenderer<unknown>[\"render\"];\n  isExecuting: boolean;\n}\n\n/**\n * Memoized component that renders a single tool call.\n * This prevents unnecessary re-renders when parent components update\n * but the tool call data hasn't changed.\n */\nconst ToolCallRenderer = React.memo(\n  function ToolCallRenderer({\n    toolCall,\n    toolMessage,\n    RenderComponent,\n    isExecuting,\n  }: ToolCallRendererProps) {\n    // Memoize args based on the arguments string to maintain stable reference\n    const args = useMemo(\n      () => partialJSONParse(toolCall.function.arguments),\n      [toolCall.function.arguments]\n    );\n\n    const toolName = toolCall.function.name;\n\n    // Render based on status to preserve discriminated union type inference\n    if (toolMessage) {\n      return (\n        <RenderComponent\n          name={toolName}\n          args={args}\n          status={ToolCallStatus.Complete}\n          result={toolMessage.content}\n        />\n      );\n    } else if (isExecuting) {\n      return (\n        <RenderComponent\n          name={toolName}\n          args={args}\n          status={ToolCallStatus.Executing}\n          result={undefined}\n        />\n      );\n    } else {\n      return (\n        <RenderComponent\n          name={toolName}\n          args={args}\n          status={ToolCallStatus.InProgress}\n          result={undefined}\n        />\n      );\n    }\n  },\n  // Custom comparison function to prevent re-renders when tool call data hasn't changed\n  (prevProps, nextProps) => {\n    // Compare tool call identity and content\n    if (prevProps.toolCall.id !== nextProps.toolCall.id) return false;\n    if (prevProps.toolCall.function.name !== nextProps.toolCall.function.name) return false;\n    if (prevProps.toolCall.function.arguments !== nextProps.toolCall.function.arguments) return false;\n\n    // Compare tool message (result)\n    const prevResult = prevProps.toolMessage?.content;\n    const nextResult = nextProps.toolMessage?.content;\n    if (prevResult !== nextResult) return false;\n\n    // Compare executing state\n    if (prevProps.isExecuting !== nextProps.isExecuting) return false;\n\n    // Compare render component reference\n    if (prevProps.RenderComponent !== nextProps.RenderComponent) return false;\n\n    return true;\n  }\n);\n\n/**\n * Hook that returns a function to render tool calls based on the render functions\n * defined in CopilotKitProvider.\n *\n * @returns A function that takes a tool call and optional tool message and returns the rendered component\n */\nexport function useRenderToolCall() {\n  const { copilotkit, executingToolCallIds } = useCopilotKit();\n  const config = useCopilotChatConfiguration();\n  const agentId = config?.agentId ?? DEFAULT_AGENT_ID;\n\n  // Subscribe to render tool calls changes using useSyncExternalStore\n  // This ensures we always have the latest value, even if subscriptions run in any order\n  const renderToolCalls = useSyncExternalStore(\n    (callback) => {\n      return copilotkit.subscribe({\n        onRenderToolCallsChanged: callback,\n      }).unsubscribe;\n    },\n    () => copilotkit.renderToolCalls,\n    () => copilotkit.renderToolCalls\n  );\n\n  // Note: executingToolCallIds is now provided by CopilotKitProvider context.\n  // This is critical for HITL reconnection: when connecting to a thread with\n  // pending tool calls, the onToolExecutionStart event fires before child components\n  // mount. By tracking at the provider level, the executing state is already\n  // available when this hook first runs.\n\n  const renderToolCall = useCallback(\n    ({\n      toolCall,\n      toolMessage,\n    }: UseRenderToolCallProps): React.ReactElement | null => {\n      // Find the render config for this tool call by name\n      // For rendering, we show all tool calls regardless of agentId\n      // The agentId scoping only affects handler execution (in core)\n      // Priority order:\n      // 1. Exact match by name (prefer agent-specific if multiple exist)\n      // 2. Wildcard (*) renderer\n      const exactMatches = renderToolCalls.filter(\n        (rc) => rc.name === toolCall.function.name\n      );\n\n      // If multiple renderers with same name exist, prefer the one matching our agentId\n      const renderConfig =\n        exactMatches.find((rc) => rc.agentId === agentId) ||\n        exactMatches.find((rc) => !rc.agentId) ||\n        exactMatches[0] ||\n        renderToolCalls.find((rc) => rc.name === \"*\");\n\n      if (!renderConfig) {\n        return null;\n      }\n\n      const RenderComponent = renderConfig.render;\n      const isExecuting = executingToolCallIds.has(toolCall.id);\n\n      // Use the memoized ToolCallRenderer component to prevent unnecessary re-renders\n      return (\n        <ToolCallRenderer\n          key={toolCall.id}\n          toolCall={toolCall}\n          toolMessage={toolMessage}\n          RenderComponent={RenderComponent}\n          isExecuting={isExecuting}\n        />\n      );\n    },\n    [renderToolCalls, executingToolCallIds, agentId]\n  );\n\n  return renderToolCall;\n}\n","\"use client\";\n\nimport React, { createContext, useContext, ReactNode, useMemo, useEffect, useReducer, useRef, useState } from \"react\";\nimport { ReactActivityMessageRenderer, ReactToolCallRenderer } from \"../types\";\nimport { ReactCustomMessageRenderer } from \"../types/react-custom-message-renderer\";\nimport { ReactFrontendTool } from \"../types/frontend-tool\";\nimport { ReactHumanInTheLoop } from \"../types/human-in-the-loop\";\nimport { z } from \"zod\";\nimport { FrontendTool } from \"@copilotkitnext/core\";\nimport { AbstractAgent } from \"@ag-ui/client\";\nimport { CopilotKitCoreReact } from \"../lib/react-core\";\nimport { CopilotKitInspector } from \"../components/CopilotKitInspector\";\nimport {\n  MCPAppsActivityRenderer,\n  MCPAppsActivityContentSchema,\n  MCPAppsActivityType,\n} from \"../components/MCPAppsActivityRenderer\";\n\nconst HEADER_NAME = \"X-CopilotCloud-Public-Api-Key\";\nconst COPILOT_CLOUD_CHAT_URL = \"https://api.cloud.copilotkit.ai/copilotkit/v1\";\n\n// Define the context value interface - idiomatic React naming\nexport interface CopilotKitContextValue {\n  copilotkit: CopilotKitCoreReact;\n  /**\n   * Set of tool call IDs currently being executed.\n   * This is tracked at the provider level to ensure tool execution events\n   * are captured even before child components mount.\n   */\n  executingToolCallIds: ReadonlySet<string>;\n}\n\n// Empty set for default context value\nconst EMPTY_SET: ReadonlySet<string> = new Set();\n\n// Create the CopilotKit context\nconst CopilotKitContext = createContext<CopilotKitContextValue>({\n  copilotkit: null!,\n  executingToolCallIds: EMPTY_SET,\n});\n\n// Provider props interface\nexport interface CopilotKitProviderProps {\n  children: ReactNode;\n  runtimeUrl?: string;\n  headers?: Record<string, string>;\n  /**\n   * The Copilot Cloud public API key.\n   */\n  publicApiKey?: string;\n  /**\n   * Alias for `publicApiKey`\n   **/\n  publicLicenseKey?: string;\n  properties?: Record<string, unknown>;\n  useSingleEndpoint?: boolean;\n  agents__unsafe_dev_only?: Record<string, AbstractAgent>;\n  renderToolCalls?: ReactToolCallRenderer<any>[];\n  renderActivityMessages?: ReactActivityMessageRenderer<any>[];\n  renderCustomMessages?: ReactCustomMessageRenderer[];\n  frontendTools?: ReactFrontendTool[];\n  humanInTheLoop?: ReactHumanInTheLoop[];\n  showDevConsole?: boolean | \"auto\";\n}\n\n// Small helper to normalize array props to a stable reference and warn\nfunction useStableArrayProp<T>(\n  prop: T[] | undefined,\n  warningMessage?: string,\n  isMeaningfulChange?: (initial: T[], next: T[]) => boolean,\n): T[] {\n  const empty = useMemo<T[]>(() => [], []);\n  const value = prop ?? empty;\n  const initial = useRef(value);\n\n  useEffect(() => {\n    if (\n      warningMessage &&\n      value !== initial.current &&\n      (isMeaningfulChange ? isMeaningfulChange(initial.current, value) : true)\n    ) {\n      console.error(warningMessage);\n    }\n  }, [value, warningMessage]);\n\n  return value;\n}\n\n// Provider component\nexport const CopilotKitProvider: React.FC<CopilotKitProviderProps> = ({\n  children,\n  runtimeUrl,\n  headers = {},\n  publicApiKey,\n  publicLicenseKey,\n  properties = {},\n  agents__unsafe_dev_only: agents = {},\n  renderToolCalls,\n  renderActivityMessages,\n  renderCustomMessages,\n  frontendTools,\n  humanInTheLoop,\n  showDevConsole = false,\n  useSingleEndpoint = false,\n}) => {\n  const [shouldRenderInspector, setShouldRenderInspector] = useState(false);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    if (showDevConsole === true) {\n      // Explicitly show the inspector\n      setShouldRenderInspector(true);\n    } else if (showDevConsole === \"auto\") {\n      // Show on localhost or 127.0.0.1 only\n      const localhostHosts = new Set([\"localhost\", \"127.0.0.1\"]);\n      if (localhostHosts.has(window.location.hostname)) {\n        setShouldRenderInspector(true);\n      } else {\n        setShouldRenderInspector(false);\n      }\n    } else {\n      // showDevConsole is false or undefined (default false)\n      setShouldRenderInspector(false);\n    }\n  }, [showDevConsole]);\n\n  // Normalize array props to stable references with clear dev warnings\n  const renderToolCallsList = useStableArrayProp<ReactToolCallRenderer<any>>(\n    renderToolCalls,\n    \"renderToolCalls must be a stable array. If you want to dynamically add or remove tools, use `useFrontendTool` instead.\",\n    (initial, next) => {\n      // Only warn if the shape (names+agentId) changed. Allow identity changes\n      // to support updated closures from parents (e.g., Storybook state).\n      const key = (rc?: ReactToolCallRenderer<unknown>) => `${rc?.agentId ?? \"\"}:${rc?.name ?? \"\"}`;\n      const setFrom = (arr: ReactToolCallRenderer<unknown>[]) => new Set(arr.map(key));\n      const a = setFrom(initial);\n      const b = setFrom(next);\n      if (a.size !== b.size) return true;\n      for (const k of a) if (!b.has(k)) return true;\n      return false;\n    },\n  );\n\n  const renderCustomMessagesList = useStableArrayProp<ReactCustomMessageRenderer>(\n    renderCustomMessages,\n    \"renderCustomMessages must be a stable array.\",\n  );\n\n  const renderActivityMessagesList = useStableArrayProp<ReactActivityMessageRenderer<any>>(\n    renderActivityMessages,\n    \"renderActivityMessages must be a stable array.\",\n  );\n\n  // Built-in activity renderers that are always included\n  const builtInActivityRenderers = useMemo<ReactActivityMessageRenderer<any>[]>(() => [\n    {\n      activityType: MCPAppsActivityType,\n      content: MCPAppsActivityContentSchema,\n      render: MCPAppsActivityRenderer,\n    },\n  ], []);\n\n  // Combine user-provided activity renderers with built-in ones\n  // User-provided renderers take precedence (come first) so they can override built-ins\n  const allActivityRenderers = useMemo(() => {\n    return [...renderActivityMessagesList, ...builtInActivityRenderers];\n  }, [renderActivityMessagesList, builtInActivityRenderers]);\n\n  const resolvedPublicKey = publicApiKey ?? publicLicenseKey;\n  const hasLocalAgents = agents && Object.keys(agents).length > 0;\n\n  // Merge a provided publicApiKey into headers (without overwriting an explicit header).\n  const mergedHeaders = useMemo(() => {\n    if (!resolvedPublicKey) return headers;\n    if (headers[HEADER_NAME]) return headers;\n    return {\n      ...headers,\n      [HEADER_NAME]: resolvedPublicKey,\n    };\n  }, [headers, resolvedPublicKey]);\n\n  if (!runtimeUrl && !resolvedPublicKey && !hasLocalAgents) {\n    const message = \"Missing required prop: 'runtimeUrl' or 'publicApiKey' or 'publicLicenseKey'\";\n    if (process.env.NODE_ENV === \"production\") {\n      throw new Error(message);\n    } else {\n      // In dev/test we warn but allow to facilitate local agents and unit tests.\n      console.warn(message);\n    }\n  }\n\n  const chatApiEndpoint = runtimeUrl ?? (resolvedPublicKey ? COPILOT_CLOUD_CHAT_URL : undefined);\n\n  const frontendToolsList = useStableArrayProp<ReactFrontendTool>(\n    frontendTools,\n    \"frontendTools must be a stable array. If you want to dynamically add or remove tools, use `useFrontendTool` instead.\",\n  );\n  const humanInTheLoopList = useStableArrayProp<ReactHumanInTheLoop>(\n    humanInTheLoop,\n    \"humanInTheLoop must be a stable array. If you want to dynamically add or remove human-in-the-loop tools, use `useHumanInTheLoop` instead.\",\n  );\n\n  // Note: warnings for array identity changes are handled by useStableArrayProp\n\n  // Process humanInTheLoop tools to create handlers and add render components\n  const processedHumanInTheLoopTools = useMemo(() => {\n    const processedTools: FrontendTool[] = [];\n    const processedRenderToolCalls: ReactToolCallRenderer<unknown>[] = [];\n\n    humanInTheLoopList.forEach((tool) => {\n      // Create a promise-based handler for each human-in-the-loop tool\n      const frontendTool: FrontendTool = {\n        name: tool.name,\n        description: tool.description,\n        parameters: tool.parameters,\n        followUp: tool.followUp,\n        ...(tool.agentId && { agentId: tool.agentId }),\n        handler: async () => {\n          // This handler will be replaced by the hook when it runs\n          // For provider-level tools, we create a basic handler that waits for user interaction\n          return new Promise((resolve) => {\n            // The actual implementation will be handled by the render component\n            // This is a placeholder that the hook will override\n            console.warn(`Human-in-the-loop tool '${tool.name}' called but no interactive handler is set up.`);\n            resolve(undefined);\n          });\n        },\n      };\n      processedTools.push(frontendTool);\n\n      // Add the render component to renderToolCalls\n      if (tool.render) {\n        processedRenderToolCalls.push({\n          name: tool.name,\n          args: tool.parameters!,\n          render: tool.render,\n          ...(tool.agentId && { agentId: tool.agentId }),\n        } as ReactToolCallRenderer<unknown>);\n      }\n    });\n\n    return { tools: processedTools, renderToolCalls: processedRenderToolCalls };\n  }, [humanInTheLoopList]);\n\n  // Combine all tools for CopilotKitCore\n  const allTools = useMemo(() => {\n    const tools: FrontendTool[] = [];\n\n    // Add frontend tools\n    tools.push(...frontendToolsList);\n\n    // Add processed human-in-the-loop tools\n    tools.push(...processedHumanInTheLoopTools.tools);\n\n    return tools;\n  }, [frontendToolsList, processedHumanInTheLoopTools]);\n\n  // Combine all render tool calls\n  const allRenderToolCalls = useMemo(() => {\n    const combined: ReactToolCallRenderer<unknown>[] = [...renderToolCallsList];\n\n    // Add render components from frontend tools\n    frontendToolsList.forEach((tool) => {\n      if (tool.render) {\n        // For wildcard tools without parameters, default to z.any()\n        const args = tool.parameters || (tool.name === \"*\" ? z.any() : undefined);\n        if (args) {\n          combined.push({\n            name: tool.name,\n            args: args,\n            render: tool.render,\n          } as ReactToolCallRenderer<unknown>);\n        }\n      }\n    });\n\n    // Add render components from human-in-the-loop tools\n    combined.push(...processedHumanInTheLoopTools.renderToolCalls);\n\n    return combined;\n  }, [renderToolCallsList, frontendToolsList, processedHumanInTheLoopTools]);\n\n  const copilotkit = useMemo(() => {\n    const copilotkit = new CopilotKitCoreReact({\n      runtimeUrl: chatApiEndpoint,\n      runtimeTransport: useSingleEndpoint ? \"single\" : \"rest\",\n      headers: mergedHeaders,\n      properties,\n      agents__unsafe_dev_only: agents,\n      tools: allTools,\n      renderToolCalls: allRenderToolCalls,\n      renderActivityMessages: allActivityRenderers,\n      renderCustomMessages: renderCustomMessagesList,\n    });\n\n    return copilotkit;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [allTools, allRenderToolCalls, allActivityRenderers, renderCustomMessagesList, useSingleEndpoint]);\n\n  // Subscribe to render tool calls changes to force re-renders\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  useEffect(() => {\n    const subscription = copilotkit.subscribe({\n      onRenderToolCallsChanged: () => {\n        forceUpdate();\n      },\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [copilotkit]);\n\n  // Track executing tool call IDs at the provider level.\n  // This is critical for HITL reconnection: when connecting to a thread with\n  // pending tool calls, the onToolExecutionStart event fires before child components\n  // (like CopilotChatToolCallsView) mount. By tracking at the provider level,\n  // we ensure the executing state is captured and available when children mount.\n  const [executingToolCallIds, setExecutingToolCallIds] = useState<ReadonlySet<string>>(() => new Set());\n\n  useEffect(() => {\n    const subscription = copilotkit.subscribe({\n      onToolExecutionStart: ({ toolCallId }) => {\n        setExecutingToolCallIds((prev) => {\n          if (prev.has(toolCallId)) return prev;\n          const next = new Set(prev);\n          next.add(toolCallId);\n          return next;\n        });\n      },\n      onToolExecutionEnd: ({ toolCallId }) => {\n        setExecutingToolCallIds((prev) => {\n          if (!prev.has(toolCallId)) return prev;\n          const next = new Set(prev);\n          next.delete(toolCallId);\n          return next;\n        });\n      },\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [copilotkit]);\n\n  useEffect(() => {\n    copilotkit.setRuntimeUrl(chatApiEndpoint);\n    copilotkit.setRuntimeTransport(useSingleEndpoint ? \"single\" : \"rest\");\n    copilotkit.setHeaders(mergedHeaders);\n    copilotkit.setProperties(properties);\n    copilotkit.setAgents__unsafe_dev_only(agents);\n  }, [chatApiEndpoint, mergedHeaders, properties, agents, useSingleEndpoint]);\n\n  return (\n    <CopilotKitContext.Provider\n      value={{\n        copilotkit,\n        executingToolCallIds,\n      }}\n    >\n      {children}\n      {shouldRenderInspector ? <CopilotKitInspector core={copilotkit} /> : null}\n    </CopilotKitContext.Provider>\n  );\n};\n\n// Hook to use the CopilotKit instance - returns the full context value\nexport const useCopilotKit = (): CopilotKitContextValue => {\n  const context = useContext(CopilotKitContext);\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  if (!context) {\n    throw new Error(\"useCopilotKit must be used within CopilotKitProvider\");\n  }\n  useEffect(() => {\n    const subscription = context.copilotkit.subscribe({\n      onRuntimeConnectionStatusChanged: () => {\n        forceUpdate();\n      },\n    });\n    return () => {\n      subscription.unsubscribe();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return context;\n};\n","import { ReactActivityMessageRenderer, ReactToolCallRenderer } from \"@/types\";\nimport { ReactCustomMessageRenderer } from \"@/types/react-custom-message-renderer\";\nimport {\n  CopilotKitCore,\n  CopilotKitCoreConfig,\n  CopilotKitCoreSubscriber,\n  CopilotKitCoreSubscription,\n} from \"@copilotkitnext/core\";\n\nexport interface CopilotKitCoreReactConfig extends CopilotKitCoreConfig {\n  // Add any additional configuration properties specific to the React implementation\n  renderToolCalls?: ReactToolCallRenderer<any>[];\n  renderActivityMessages?: ReactActivityMessageRenderer<any>[];\n\n  // Add custom message renderers\n  renderCustomMessages?: ReactCustomMessageRenderer[];\n}\n\nexport interface CopilotKitCoreReactSubscriber extends CopilotKitCoreSubscriber {\n  onRenderToolCallsChanged?: (event: {\n    copilotkit: CopilotKitCore;\n    renderToolCalls: ReactToolCallRenderer<any>[];\n  }) => void | Promise<void>;\n}\n\nexport class CopilotKitCoreReact extends CopilotKitCore {\n  private _renderToolCalls: ReactToolCallRenderer<any>[] = [];\n  private _renderCustomMessages: ReactCustomMessageRenderer[] = [];\n  private _renderActivityMessages: ReactActivityMessageRenderer<any>[] = [];\n\n  constructor(config: CopilotKitCoreReactConfig) {\n    super(config);\n    this._renderToolCalls = config.renderToolCalls ?? [];\n    this._renderCustomMessages = config.renderCustomMessages ?? [];\n    this._renderActivityMessages = config.renderActivityMessages ?? [];\n  }\n\n  get renderCustomMessages(): Readonly<ReactCustomMessageRenderer[]> {\n    return this._renderCustomMessages;\n  }\n\n  get renderActivityMessages(): Readonly<ReactActivityMessageRenderer<any>>[] {\n    return this._renderActivityMessages;\n  }\n\n  get renderToolCalls(): Readonly<ReactToolCallRenderer<any>>[] {\n    return this._renderToolCalls;\n  }\n\n  setRenderToolCalls(renderToolCalls: ReactToolCallRenderer<any>[]): void {\n    this._renderToolCalls = renderToolCalls;\n\n    // Notify React-specific subscribers\n    void this.notifySubscribers(\n      (subscriber) => {\n        const reactSubscriber = subscriber as CopilotKitCoreReactSubscriber;\n        if (reactSubscriber.onRenderToolCallsChanged) {\n          reactSubscriber.onRenderToolCallsChanged({\n            copilotkit: this,\n            renderToolCalls: this.renderToolCalls,\n          });\n        }\n      },\n      \"Subscriber onRenderToolCallsChanged error:\"\n    );\n  }\n\n  // Override to accept React-specific subscriber type\n  subscribe(subscriber: CopilotKitCoreReactSubscriber): CopilotKitCoreSubscription {\n    return super.subscribe(subscriber);\n  }\n}\n","import * as React from \"react\";\nimport { createComponent } from \"@lit-labs/react\";\nimport type { CopilotKitCore } from \"@copilotkitnext/core\";\n\ntype CopilotKitInspectorBaseProps = {\n  core?: CopilotKitCore | null;\n  [key: string]: unknown;\n};\n\ntype InspectorComponent = React.ComponentType<CopilotKitInspectorBaseProps>;\n\nexport interface CopilotKitInspectorProps extends CopilotKitInspectorBaseProps {}\n\nexport const CopilotKitInspector: React.FC<CopilotKitInspectorProps> = ({ core, ...rest }) => {\n  const [InspectorComponent, setInspectorComponent] = React.useState<InspectorComponent | null>(null);\n\n  React.useEffect(() => {\n    let mounted = true;\n\n    // Load the web component only on the client to keep SSR output stable.\n    import(\"@copilotkitnext/web-inspector\").then((mod) => {\n      mod.defineWebInspector?.();\n\n      const Component = createComponent({\n        tagName: mod.WEB_INSPECTOR_TAG,\n        elementClass: mod.WebInspectorElement,\n        react: React,\n      }) as InspectorComponent;\n\n      if (mounted) {\n        setInspectorComponent(() => Component);\n      }\n    });\n\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // During SSR (and until the client finishes loading), render nothing to keep markup consistent.\n  if (!InspectorComponent) return null;\n\n  return <InspectorComponent {...rest} core={core ?? null} />;\n};\n\nCopilotKitInspector.displayName = \"CopilotKitInspector\";\n","\"use client\";\n\nimport React, { useEffect, useRef, useState, useCallback } from \"react\";\nimport { z } from \"zod\";\nimport type { AbstractAgent, RunAgentResult } from \"@ag-ui/client\";\n\n// Protocol version supported\nconst PROTOCOL_VERSION = \"2025-06-18\";\n\n// Sandbox proxy HTML - embedded to avoid requiring users to add a file to their public folder\nconst SANDBOX_HTML = `<!doctype html>\n<html>\n<head>\n<meta charset=\"utf-8\" />\n<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; img-src * data: blob: 'unsafe-inline'; media-src * blob: data:; font-src * blob: data:; script-src 'self' 'wasm-unsafe-eval' 'unsafe-inline' 'unsafe-eval' blob: data: http://localhost:* https://localhost:*; style-src * blob: data: 'unsafe-inline'; connect-src *; frame-src * blob: data: http://localhost:* https://localhost:*; base-uri 'self';\" />\n<style>html,body{margin:0;padding:0;height:100%;width:100%;overflow:hidden}*{box-sizing:border-box}iframe{background-color:transparent;border:none;padding:0;overflow:hidden;width:100%;height:100%}</style>\n</head>\n<body>\n<script>\nif(window.self===window.top){throw new Error(\"This file must be used in an iframe.\")}\nconst inner=document.createElement(\"iframe\");\ninner.style=\"width:100%;height:100%;border:none;\";\ninner.setAttribute(\"sandbox\",\"allow-scripts allow-same-origin allow-forms\");\ndocument.body.appendChild(inner);\nwindow.addEventListener(\"message\",async(event)=>{\nif(event.source===window.parent){\nif(event.data&&event.data.method===\"ui/notifications/sandbox-resource-ready\"){\nconst{html,sandbox}=event.data.params;\nif(typeof sandbox===\"string\")inner.setAttribute(\"sandbox\",sandbox);\nif(typeof html===\"string\")inner.srcdoc=html;\n}else if(inner&&inner.contentWindow){\ninner.contentWindow.postMessage(event.data,\"*\");\n}\n}else if(event.source===inner.contentWindow){\nwindow.parent.postMessage(event.data,\"*\");\n}\n});\nwindow.parent.postMessage({jsonrpc:\"2.0\",method:\"ui/notifications/sandbox-proxy-ready\",params:{}},\"*\");\n</script>\n</body>\n</html>`;\n\n/**\n * Queue for serializing MCP app requests to an agent.\n * Ensures requests wait for the agent to stop running and are processed one at a time.\n */\nclass MCPAppsRequestQueue {\n  private queues = new Map<string, Array<{\n    execute: () => Promise<RunAgentResult>;\n    resolve: (result: RunAgentResult) => void;\n    reject: (error: Error) => void;\n  }>>();\n  private processing = new Map<string, boolean>();\n\n  /**\n   * Add a request to the queue for a specific agent thread.\n   * Returns a promise that resolves when the request completes.\n   */\n  async enqueue(\n    agent: AbstractAgent,\n    request: () => Promise<RunAgentResult>\n  ): Promise<RunAgentResult> {\n    const threadId = agent.threadId || \"default\";\n\n    return new Promise((resolve, reject) => {\n      // Get or create queue for this thread\n      let queue = this.queues.get(threadId);\n      if (!queue) {\n        queue = [];\n        this.queues.set(threadId, queue);\n      }\n\n      // Add request to queue\n      queue.push({ execute: request, resolve, reject });\n\n      // Start processing if not already running\n      this.processQueue(threadId, agent);\n    });\n  }\n\n  private async processQueue(threadId: string, agent: AbstractAgent): Promise<void> {\n    // If already processing this queue, return\n    if (this.processing.get(threadId)) {\n      return;\n    }\n\n    this.processing.set(threadId, true);\n\n    try {\n      const queue = this.queues.get(threadId);\n      if (!queue) return;\n\n      while (queue.length > 0) {\n        const item = queue[0]!;\n\n        try {\n          // Wait for any active run to complete before processing\n          await this.waitForAgentIdle(agent);\n\n          // Execute the request\n          const result = await item.execute();\n          item.resolve(result);\n        } catch (error) {\n          item.reject(error instanceof Error ? error : new Error(String(error)));\n        }\n\n        // Remove processed item\n        queue.shift();\n      }\n    } finally {\n      this.processing.set(threadId, false);\n    }\n  }\n\n  private waitForAgentIdle(agent: AbstractAgent): Promise<void> {\n    return new Promise((resolve) => {\n      if (!agent.isRunning) {\n        resolve();\n        return;\n      }\n\n      let done = false;\n      const finish = () => {\n        if (done) return;\n        done = true;\n        clearInterval(checkInterval);\n        sub.unsubscribe();\n        resolve();\n      };\n\n      const sub = agent.subscribe({\n        onRunFinalized: finish,\n        onRunFailed: finish,\n      });\n\n      // Fallback for reconnect scenarios where events don't fire\n      const checkInterval = setInterval(() => {\n        if (!agent.isRunning) finish();\n      }, 500);\n    });\n  }\n}\n\n// Global queue instance for all MCP app requests\nconst mcpAppsRequestQueue = new MCPAppsRequestQueue();\n\n/**\n * Activity type for MCP Apps events - must match the middleware's MCPAppsActivityType\n */\nexport const MCPAppsActivityType = \"mcp-apps\";\n\n// Zod schema for activity content validation (middleware 0.0.2 format)\nexport const MCPAppsActivityContentSchema = z.object({\n  result: z.object({\n    content: z.array(z.any()).optional(),\n    structuredContent: z.any().optional(),\n    isError: z.boolean().optional(),\n  }),\n  // Resource URI to fetch (e.g., \"ui://server/dashboard\")\n  resourceUri: z.string(),\n  // MD5 hash of server config (renamed from serverId in 0.0.1)\n  serverHash: z.string(),\n  // Optional stable server ID from config (takes precedence over serverHash)\n  serverId: z.string().optional(),\n  // Original tool input arguments\n  toolInput: z.record(z.unknown()).optional(),\n});\n\nexport type MCPAppsActivityContent = z.infer<typeof MCPAppsActivityContentSchema>;\n\n// Type for the resource fetched from the server\ninterface FetchedResource {\n  uri: string;\n  mimeType?: string;\n  text?: string;\n  blob?: string;\n  _meta?: {\n    ui?: {\n      prefersBorder?: boolean;\n      csp?: {\n        connectDomains?: string[];\n        resourceDomains?: string[];\n      };\n    };\n  };\n}\n\ninterface JSONRPCRequest {\n  jsonrpc: \"2.0\";\n  id: string | number;\n  method: string;\n  params?: Record<string, unknown>;\n}\n\ninterface JSONRPCResponse {\n  jsonrpc: \"2.0\";\n  id: string | number;\n  result?: unknown;\n  error?: { code: number; message: string };\n}\n\ninterface JSONRPCNotification {\n  jsonrpc: \"2.0\";\n  method: string;\n  params?: Record<string, unknown>;\n}\n\ntype JSONRPCMessage = JSONRPCRequest | JSONRPCResponse | JSONRPCNotification;\n\nfunction isRequest(msg: JSONRPCMessage): msg is JSONRPCRequest {\n  return \"id\" in msg && \"method\" in msg;\n}\n\nfunction isNotification(msg: JSONRPCMessage): msg is JSONRPCNotification {\n  return !(\"id\" in msg) && \"method\" in msg;\n}\n\n/**\n * Props for the activity renderer component\n */\ninterface MCPAppsActivityRendererProps {\n  activityType: string;\n  content: MCPAppsActivityContent;\n  message: unknown; // ActivityMessage from @ag-ui/core\n  agent: AbstractAgent | undefined;\n}\n\n/**\n * MCP Apps Extension Activity Renderer\n *\n * Renders MCP Apps UI in a sandboxed iframe with full protocol support.\n * Fetches resource content on-demand via proxied MCP requests.\n */\nexport const MCPAppsActivityRenderer: React.FC<MCPAppsActivityRendererProps> = function MCPAppsActivityRenderer({ content, agent }) {\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const iframeRef = useRef<HTMLIFrameElement | null>(null);\n  const [iframeReady, setIframeReady] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [iframeSize, setIframeSize] = useState<{ width?: number; height?: number }>({});\n  const [fetchedResource, setFetchedResource] = useState<FetchedResource | null>(null);\n\n  // Use refs for values that shouldn't trigger re-renders but need latest values\n  const contentRef = useRef(content);\n  contentRef.current = content;\n\n  // Store agent in a ref for use in async handlers\n  const agentRef = useRef(agent);\n  agentRef.current = agent;\n\n  // Ref to track fetch state - survives StrictMode remounts\n  const fetchStateRef = useRef<{\n    inProgress: boolean;\n    promise: Promise<FetchedResource | null> | null;\n    resourceUri: string | null;\n  }>({ inProgress: false, promise: null, resourceUri: null });\n\n  // Callback to send a message to the iframe\n  const sendToIframe = useCallback((msg: JSONRPCMessage) => {\n    if (iframeRef.current?.contentWindow) {\n      console.log(\"[MCPAppsRenderer] Sending to iframe:\", msg);\n      iframeRef.current.contentWindow.postMessage(msg, \"*\");\n    }\n  }, []);\n\n  // Callback to send a JSON-RPC response\n  const sendResponse = useCallback((id: string | number, result: unknown) => {\n    sendToIframe({\n      jsonrpc: \"2.0\",\n      id,\n      result,\n    });\n  }, [sendToIframe]);\n\n  // Callback to send a JSON-RPC error response\n  const sendErrorResponse = useCallback((id: string | number, code: number, message: string) => {\n    sendToIframe({\n      jsonrpc: \"2.0\",\n      id,\n      error: { code, message },\n    });\n  }, [sendToIframe]);\n\n  // Callback to send a notification\n  const sendNotification = useCallback((method: string, params?: Record<string, unknown>) => {\n    sendToIframe({\n      jsonrpc: \"2.0\",\n      method,\n      params: params || {},\n    });\n  }, [sendToIframe]);\n\n  // Effect 0: Fetch the resource content on mount\n  // Uses ref-based deduplication to handle React StrictMode double-mounting\n  useEffect(() => {\n    const { resourceUri, serverHash, serverId } = content;\n\n    // Check if we already have a fetch in progress for this resource\n    // This handles StrictMode double-mounting - second mount reuses first mount's promise\n    if (fetchStateRef.current.inProgress && fetchStateRef.current.resourceUri === resourceUri) {\n      // Reuse the existing promise\n      fetchStateRef.current.promise?.then((resource) => {\n        if (resource) {\n          setFetchedResource(resource);\n          setIsLoading(false);\n        }\n      }).catch((err) => {\n        setError(err instanceof Error ? err : new Error(String(err)));\n        setIsLoading(false);\n      });\n      return;\n    }\n\n    if (!agent) {\n      setError(new Error(\"No agent available to fetch resource\"));\n      setIsLoading(false);\n      return;\n    }\n\n    // Mark fetch as in progress\n    fetchStateRef.current.inProgress = true;\n    fetchStateRef.current.resourceUri = resourceUri;\n\n    // Create the fetch promise using the queue to serialize requests\n    const fetchPromise = (async (): Promise<FetchedResource | null> => {\n      try {\n        // Use queue to wait for agent to be idle and serialize requests\n        const runResult = await mcpAppsRequestQueue.enqueue(agent, () =>\n          agent.runAgent({\n            forwardedProps: {\n              __proxiedMCPRequest: {\n                serverHash,\n                serverId, // optional, takes precedence if provided\n                method: \"resources/read\",\n                params: { uri: resourceUri },\n              },\n            },\n          })\n        );\n\n        // Extract resource from result\n        // The response format is: { contents: [{ uri, mimeType, text?, blob?, _meta? }] }\n        const resultData = runResult.result as { contents?: FetchedResource[] } | undefined;\n        const resource = resultData?.contents?.[0];\n\n        if (!resource) {\n          throw new Error(\"No resource content in response\");\n        }\n\n        return resource;\n      } catch (err) {\n        console.error(\"[MCPAppsRenderer] Failed to fetch resource:\", err);\n        throw err;\n      } finally {\n        // Mark fetch as complete\n        fetchStateRef.current.inProgress = false;\n      }\n    })();\n\n    // Store the promise for potential reuse\n    fetchStateRef.current.promise = fetchPromise;\n\n    // Handle the result\n    fetchPromise.then((resource) => {\n      if (resource) {\n        setFetchedResource(resource);\n        setIsLoading(false);\n      }\n    }).catch((err) => {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setIsLoading(false);\n    });\n\n    // No cleanup needed - we want the fetch to complete even if StrictMode unmounts\n  }, [agent, content]);\n\n  // Effect 1: Setup sandbox proxy iframe and communication (after resource is fetched)\n  useEffect(() => {\n    // Wait for resource to be fetched\n    if (isLoading || !fetchedResource) {\n      return;\n    }\n\n    // Capture container reference at effect start (refs are cleared during unmount)\n    const container = containerRef.current;\n    if (!container) {\n      return;\n    }\n\n    let mounted = true;\n    let messageHandler: ((event: MessageEvent) => void) | null = null;\n    let initialListener: ((event: MessageEvent) => void) | null = null;\n    let createdIframe: HTMLIFrameElement | null = null;\n\n    const setup = async () => {\n      try {\n        // Create sandbox proxy iframe\n        const iframe = document.createElement(\"iframe\");\n        createdIframe = iframe; // Track for cleanup\n        iframe.style.width = \"100%\";\n        iframe.style.height = \"100px\"; // Start small, will be resized by size-changed notification\n        iframe.style.border = \"none\";\n        iframe.style.backgroundColor = \"transparent\";\n        iframe.style.display = \"block\";\n        iframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin allow-forms\");\n\n        // Wait for sandbox proxy to be ready\n        const sandboxReady = new Promise<void>((resolve) => {\n          initialListener = (event: MessageEvent) => {\n            if (event.source === iframe.contentWindow) {\n              if (event.data?.method === \"ui/notifications/sandbox-proxy-ready\") {\n                if (initialListener) {\n                  window.removeEventListener(\"message\", initialListener);\n                  initialListener = null;\n                }\n                resolve();\n              }\n            }\n          };\n          window.addEventListener(\"message\", initialListener);\n        });\n\n        // Check mounted before adding to DOM (handles StrictMode double-mount)\n        if (!mounted) {\n          if (initialListener) {\n            window.removeEventListener(\"message\", initialListener);\n            initialListener = null;\n          }\n          return;\n        }\n\n        // Set iframe content and add to DOM\n        iframe.srcdoc = SANDBOX_HTML;\n        iframeRef.current = iframe;\n        container.appendChild(iframe);\n\n        // Wait for sandbox proxy to signal ready\n        await sandboxReady;\n        if (!mounted) return;\n\n        console.log(\"[MCPAppsRenderer] Sandbox proxy ready\");\n\n        // Setup message handler for JSON-RPC messages from the inner iframe\n        messageHandler = async (event: MessageEvent) => {\n          if (event.source !== iframe.contentWindow) return;\n\n          const msg = event.data as JSONRPCMessage;\n          if (!msg || typeof msg !== \"object\" || msg.jsonrpc !== \"2.0\") return;\n\n          console.log(\"[MCPAppsRenderer] Received from iframe:\", msg);\n\n          // Handle requests (need response)\n          if (isRequest(msg)) {\n            switch (msg.method) {\n              case \"ui/initialize\": {\n                // Respond with host capabilities\n                sendResponse(msg.id, {\n                  protocolVersion: PROTOCOL_VERSION,\n                  hostInfo: {\n                    name: \"CopilotKit MCP Apps Host\",\n                    version: \"1.0.0\",\n                  },\n                  hostCapabilities: {\n                    openLinks: {},\n                    logging: {},\n                  },\n                  hostContext: {\n                    theme: \"light\",\n                    platform: \"web\",\n                  },\n                });\n                break;\n              }\n\n              case \"ui/message\": {\n                // Add message to CopilotKit chat\n                const currentAgent = agentRef.current;\n\n                if (!currentAgent) {\n                  console.warn(\"[MCPAppsRenderer] ui/message: No agent available\");\n                  sendResponse(msg.id, { isError: false });\n                  break;\n                }\n\n                try {\n                  const params = msg.params as {\n                    role?: string;\n                    content?: Array<{ type: string; text?: string }>;\n                  };\n\n                  // Extract text content from the message\n                  const textContent = params.content\n                    ?.filter((c) => c.type === \"text\" && c.text)\n                    .map((c) => c.text)\n                    .join(\"\\n\") || \"\";\n\n                  if (textContent) {\n                    currentAgent.addMessage({\n                      id: crypto.randomUUID(),\n                      role: (params.role as \"user\" | \"assistant\") || \"user\",\n                      content: textContent,\n                    });\n                  }\n                  sendResponse(msg.id, { isError: false });\n                } catch (err) {\n                  console.error(\"[MCPAppsRenderer] ui/message error:\", err);\n                  sendResponse(msg.id, { isError: true });\n                }\n                break;\n              }\n\n              case \"ui/open-link\": {\n                // Open URL in new tab\n                const url = msg.params?.url as string | undefined;\n                if (url) {\n                  window.open(url, \"_blank\", \"noopener,noreferrer\");\n                  sendResponse(msg.id, { isError: false });\n                } else {\n                  sendErrorResponse(msg.id, -32602, \"Missing url parameter\");\n                }\n                break;\n              }\n\n              case \"tools/call\": {\n                // Proxy tool call to MCP server via agent.runAgent()\n                const { serverHash, serverId } = contentRef.current;\n                const currentAgent = agentRef.current;\n\n                if (!serverHash) {\n                  sendErrorResponse(msg.id, -32603, \"No server hash available for proxying\");\n                  break;\n                }\n\n                if (!currentAgent) {\n                  sendErrorResponse(msg.id, -32603, \"No agent available for proxying\");\n                  break;\n                }\n\n                try {\n                  // Use queue to wait for agent to be idle and serialize requests\n                  const runResult = await mcpAppsRequestQueue.enqueue(currentAgent, () =>\n                    currentAgent.runAgent({\n                      forwardedProps: {\n                        __proxiedMCPRequest: {\n                          serverHash,\n                          serverId, // optional, takes precedence if provided\n                          method: \"tools/call\",\n                          params: msg.params,\n                        },\n                      },\n                    })\n                  );\n\n                  // The result from runAgent contains the MCP response\n                  sendResponse(msg.id, runResult.result || {});\n                } catch (err) {\n                  console.error(\"[MCPAppsRenderer] tools/call error:\", err);\n                  sendErrorResponse(msg.id, -32603, String(err));\n                }\n                break;\n              }\n\n              default:\n                sendErrorResponse(msg.id, -32601, `Method not found: ${msg.method}`);\n            }\n          }\n\n          // Handle notifications (no response needed)\n          if (isNotification(msg)) {\n            switch (msg.method) {\n              case \"ui/notifications/initialized\": {\n                console.log(\"[MCPAppsRenderer] Inner iframe initialized\");\n                if (mounted) {\n                  setIframeReady(true);\n                }\n                break;\n              }\n\n              case \"ui/notifications/size-changed\": {\n                const { width, height } = msg.params || {};\n                console.log(\"[MCPAppsRenderer] Size change:\", { width, height });\n                if (mounted) {\n                  setIframeSize({\n                    width: typeof width === \"number\" ? width : undefined,\n                    height: typeof height === \"number\" ? height : undefined,\n                  });\n                }\n                break;\n              }\n\n              case \"notifications/message\": {\n                // Logging notification from the app\n                console.log(\"[MCPAppsRenderer] App log:\", msg.params);\n                break;\n              }\n            }\n          }\n        };\n\n        window.addEventListener(\"message\", messageHandler);\n\n        // Extract HTML content from fetched resource\n        let html: string;\n        if (fetchedResource.text) {\n          html = fetchedResource.text;\n        } else if (fetchedResource.blob) {\n          html = atob(fetchedResource.blob);\n        } else {\n          throw new Error(\"Resource has no text or blob content\");\n        }\n\n        // Send the resource content to the sandbox proxy\n        sendNotification(\"ui/notifications/sandbox-resource-ready\", { html });\n\n      } catch (err) {\n        console.error(\"[MCPAppsRenderer] Setup error:\", err);\n        if (mounted) {\n          setError(err instanceof Error ? err : new Error(String(err)));\n        }\n      }\n    };\n\n    setup();\n\n    return () => {\n      mounted = false;\n      // Clean up initial listener if still active\n      if (initialListener) {\n        window.removeEventListener(\"message\", initialListener);\n        initialListener = null;\n      }\n      if (messageHandler) {\n        window.removeEventListener(\"message\", messageHandler);\n      }\n      // Remove the iframe we created (using tracked reference, not DOM query)\n      // This works even if containerRef.current is null during unmount\n      if (createdIframe) {\n        createdIframe.remove();\n        createdIframe = null;\n      }\n      iframeRef.current = null;\n    };\n  }, [isLoading, fetchedResource, sendNotification, sendResponse, sendErrorResponse]);\n\n  // Effect 2: Update iframe size when it changes\n  useEffect(() => {\n    if (iframeRef.current) {\n      if (iframeSize.width !== undefined) {\n        // Use minWidth with min() to allow expansion but cap at 100%\n        iframeRef.current.style.minWidth = `min(${iframeSize.width}px, 100%)`;\n        iframeRef.current.style.width = \"100%\";\n      }\n      if (iframeSize.height !== undefined) {\n        iframeRef.current.style.height = `${iframeSize.height}px`;\n      }\n    }\n  }, [iframeSize]);\n\n  // Effect 3: Send tool input when iframe ready\n  useEffect(() => {\n    if (iframeReady && content.toolInput) {\n      console.log(\"[MCPAppsRenderer] Sending tool input:\", content.toolInput);\n      sendNotification(\"ui/notifications/tool-input\", {\n        arguments: content.toolInput,\n      });\n    }\n  }, [iframeReady, content.toolInput, sendNotification]);\n\n  // Effect 4: Send tool result when iframe ready\n  useEffect(() => {\n    if (iframeReady && content.result) {\n      console.log(\"[MCPAppsRenderer] Sending tool result:\", content.result);\n      sendNotification(\"ui/notifications/tool-result\", content.result);\n    }\n  }, [iframeReady, content.result, sendNotification]);\n\n  // Determine border styling based on prefersBorder metadata from fetched resource\n  // true = show border/background, false = none, undefined = host decides (we default to none)\n  const prefersBorder = fetchedResource?._meta?.ui?.prefersBorder;\n  const borderStyle = prefersBorder === true\n    ? {\n        borderRadius: \"8px\",\n        backgroundColor: \"#f9f9f9\",\n        border: \"1px solid #e0e0e0\",\n      }\n    : {};\n\n  return (\n    <div\n      ref={containerRef}\n      style={{\n        width: \"100%\",\n        height: iframeSize.height ? `${iframeSize.height}px` : \"auto\",\n        minHeight: \"100px\",\n        overflow: \"hidden\",\n        position: \"relative\",\n        ...borderStyle,\n      }}\n    >\n      {isLoading && (\n        <div style={{ padding: \"1rem\", color: \"#666\" }}>\n          Loading...\n        </div>\n      )}\n      {error && (\n        <div style={{ color: \"red\", padding: \"1rem\" }}>\n          Error: {error.message}\n        </div>\n      )}\n    </div>\n  );\n};\n","import { useCopilotChatConfiguration, useCopilotKit } from \"@/providers\";\nimport { ReactCustomMessageRendererPosition } from \"@/types/react-custom-message-renderer\";\nimport { Message } from \"@ag-ui/core\";\n\ninterface UseRenderCustomMessagesParams {\n  message: Message;\n  position: ReactCustomMessageRendererPosition;\n}\n\nexport function useRenderCustomMessages() {\n  const { copilotkit } = useCopilotKit();\n  const config = useCopilotChatConfiguration();\n\n  if (!config) {\n    return null;\n  }\n\n  const { agentId, threadId } = config;\n\n  const customMessageRenderers = copilotkit.renderCustomMessages\n    .filter((renderer) => renderer.agentId === undefined || renderer.agentId === agentId)\n    .sort((a, b) => {\n      const aHasAgent = a.agentId !== undefined;\n      const bHasAgent = b.agentId !== undefined;\n      if (aHasAgent === bHasAgent) return 0;\n      return aHasAgent ? -1 : 1;\n    });\n\n  return function (params: UseRenderCustomMessagesParams) {\n    if (!customMessageRenderers.length) {\n      return null;\n    }\n    const { message, position } = params;\n    const runId = copilotkit.getRunIdForMessage(agentId, threadId, message.id)!;\n    const agent = copilotkit.getAgent(agentId);\n    if (!agent) {\n      throw new Error(\"Agent not found\");\n    }\n\n    const messagesIdsInRun = agent.messages\n      .filter((msg) => copilotkit.getRunIdForMessage(agentId, threadId, msg.id) === runId)\n      .map((msg) => msg.id);\n\n    const messageIndex = agent.messages.findIndex((msg) => msg.id === message.id) ?? 0;\n    const messageIndexInRun = Math.min(messagesIdsInRun.indexOf(message.id), 0);\n    const numberOfMessagesInRun = messagesIdsInRun.length;\n    const stateSnapshot = copilotkit.getStateByRun(agentId, threadId, runId);\n\n    let result = null;\n    for (const renderer of customMessageRenderers) {\n      if (!renderer.render) {\n        continue;\n      }\n      const Component = renderer.render;\n      result = (\n        <Component\n          key={`${runId}-${message.id}-${position}`}\n          message={message}\n          position={position}\n          runId={runId}\n          messageIndex={messageIndex}\n          messageIndexInRun={messageIndexInRun}\n          numberOfMessagesInRun={numberOfMessagesInRun}\n          agentId={agentId}\n          stateSnapshot={stateSnapshot}\n        />\n      );\n      if (result) {\n        break;\n      }\n    }\n    return result;\n  };\n}\n","import { ActivityMessage } from \"@ag-ui/core\";\nimport { DEFAULT_AGENT_ID } from \"@copilotkitnext/shared\";\nimport { useCopilotKit, useCopilotChatConfiguration } from \"@/providers\";\nimport { useCallback, useMemo } from \"react\";\nimport { ReactActivityMessageRenderer } from \"@/types\";\n\nexport function useRenderActivityMessage() {\n  const { copilotkit } = useCopilotKit();\n  const config = useCopilotChatConfiguration();\n  const agentId = config?.agentId ?? DEFAULT_AGENT_ID;\n\n  const renderers = copilotkit.renderActivityMessages;\n\n  // Find the renderer for a given activity type\n  const findRenderer = useCallback(\n    (activityType: string): ReactActivityMessageRenderer<unknown> | null => {\n      if (!renderers.length) {\n        return null;\n      }\n\n      const matches = renderers.filter(\n        (renderer) => renderer.activityType === activityType\n      );\n\n      return (\n        matches.find((candidate) => candidate.agentId === agentId) ??\n        matches.find((candidate) => candidate.agentId === undefined) ??\n        renderers.find((candidate) => candidate.activityType === \"*\") ??\n        null\n      );\n    },\n    [agentId, renderers]\n  );\n\n  const renderActivityMessage = useCallback(\n    (message: ActivityMessage): React.ReactElement | null => {\n      const renderer = findRenderer(message.activityType);\n\n      if (!renderer) {\n        return null;\n      }\n\n      const parseResult = renderer.content.safeParse(message.content);\n\n      if (!parseResult.success) {\n        console.warn(\n          `Failed to parse content for activity message '${message.activityType}':`,\n          parseResult.error\n        );\n        return null;\n      }\n\n      const Component = renderer.render;\n      const agent = copilotkit.getAgent(agentId);\n\n      return (\n        <Component\n          key={message.id}\n          activityType={message.activityType}\n          content={parseResult.data}\n          message={message}\n          agent={agent}\n        />\n      );\n    },\n    [agentId, copilotkit, findRenderer]\n  );\n\n  return useMemo(\n    () => ({ renderActivityMessage, findRenderer }),\n    [renderActivityMessage, findRenderer]\n  );\n}\n","import { useEffect } from \"react\";\nimport { useCopilotKit } from \"../providers/CopilotKitProvider\";\nimport { ReactFrontendTool } from \"../types/frontend-tool\";\nimport { ReactToolCallRenderer } from \"../types/react-tool-call-renderer\";\n\nconst EMPTY_DEPS: ReadonlyArray<unknown> = [];\n\nexport function useFrontendTool<\n  T extends Record<string, unknown> = Record<string, unknown>,\n>(tool: ReactFrontendTool<T>, deps?: ReadonlyArray<unknown>) {\n  const { copilotkit } = useCopilotKit();\n  const extraDeps = deps ?? EMPTY_DEPS;\n\n  useEffect(() => {\n    const name = tool.name;\n\n    // Always register/override the tool for this name on mount\n    if (copilotkit.getTool({ toolName: name, agentId: tool.agentId })) {\n      console.warn(\n        `Tool '${name}' already exists for agent '${tool.agentId || 'global'}'. Overriding with latest registration.`\n      );\n      copilotkit.removeTool(name, tool.agentId);\n    }\n    copilotkit.addTool(tool);\n\n    // Register/override renderer by name and agentId through core\n    if (tool.render) {\n      // Get current render tool calls and merge with new entry\n      const keyOf = (rc: ReactToolCallRenderer<any>) => `${rc.agentId ?? \"\"}:${rc.name}`;\n      const currentRenderToolCalls = copilotkit.renderToolCalls as ReactToolCallRenderer<any>[];\n\n      // Build map from existing entries\n      const mergedMap = new Map<string, ReactToolCallRenderer<any>>();\n      for (const rc of currentRenderToolCalls) {\n        mergedMap.set(keyOf(rc), rc);\n      }\n\n      // Add/overwrite with new entry\n      const newEntry = {\n        name,\n        args: tool.parameters,\n        agentId: tool.agentId,\n        render: tool.render,\n      } as ReactToolCallRenderer<any>;\n      mergedMap.set(keyOf(newEntry), newEntry);\n\n      // Set the merged list back\n      copilotkit.setRenderToolCalls(Array.from(mergedMap.values()));\n    }\n\n    return () => {\n      copilotkit.removeTool(name, tool.agentId);\n      // we are intentionally not removing the render here so that the tools can still render in the chat history\n    };\n    // Depend on stable keys by default and allow callers to opt into\n    // additional dependencies for dynamic tool configuration.\n  }, [tool.name, copilotkit, extraDeps.length, ...extraDeps]);\n}\n","import { ReactToolCallRenderer } from \"@/types/react-tool-call-renderer\";\nimport { useFrontendTool } from \"./use-frontend-tool\";\nimport { ReactFrontendTool } from \"@/types/frontend-tool\";\nimport { ReactHumanInTheLoop } from \"@/types/human-in-the-loop\";\nimport { useCallback, useRef, useEffect } from \"react\";\nimport React from \"react\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\n\nexport function useHumanInTheLoop<T extends Record<string, unknown> = Record<string, unknown>>(\n  tool: ReactHumanInTheLoop<T>,\n  deps?: ReadonlyArray<unknown>,\n) {\n  const { copilotkit } = useCopilotKit();\n  const resolvePromiseRef = useRef<((result: unknown) => void) | null>(null);\n\n  const respond = useCallback(async (result: unknown) => {\n    if (resolvePromiseRef.current) {\n      resolvePromiseRef.current(result);\n      resolvePromiseRef.current = null;\n    }\n  }, []);\n\n  const handler = useCallback(async () => {\n    return new Promise((resolve) => {\n      resolvePromiseRef.current = resolve;\n    });\n  }, []);\n\n  const RenderComponent: ReactToolCallRenderer<T>[\"render\"] = useCallback(\n    (props) => {\n      const ToolComponent = tool.render;\n\n      // Enhance props based on current status\n      if (props.status === \"inProgress\") {\n        const enhancedProps = {\n          ...props,\n          name: tool.name,\n          description: tool.description || \"\",\n          respond: undefined,\n        };\n        return React.createElement(ToolComponent, enhancedProps);\n      } else if (props.status === \"executing\") {\n        const enhancedProps = {\n          ...props,\n          name: tool.name,\n          description: tool.description || \"\",\n          respond,\n        };\n        return React.createElement(ToolComponent, enhancedProps);\n      } else if (props.status === \"complete\") {\n        const enhancedProps = {\n          ...props,\n          name: tool.name,\n          description: tool.description || \"\",\n          respond: undefined,\n        };\n        return React.createElement(ToolComponent, enhancedProps);\n      }\n\n      // Fallback - just render with original props\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return React.createElement(ToolComponent, props as any);\n    },\n    [tool.render, tool.name, tool.description, respond],\n  );\n\n  const frontendTool: ReactFrontendTool<T> = {\n    ...tool,\n    handler,\n    render: RenderComponent,\n  };\n\n  useFrontendTool(frontendTool, deps);\n\n  // Human-in-the-loop tools should remove their renderer on unmount\n  // since they can't respond to user interactions anymore\n  useEffect(() => {\n    return () => {\n      const keyOf = (rc: ReactToolCallRenderer<any>) => `${rc.agentId ?? \"\"}:${rc.name}`;\n      const currentRenderToolCalls = copilotkit.renderToolCalls as ReactToolCallRenderer<any>[];\n      const filtered = currentRenderToolCalls.filter(\n        (rc) => keyOf(rc) !== keyOf({ name: tool.name, agentId: tool.agentId } as any),\n      );\n      copilotkit.setRenderToolCalls(filtered);\n    };\n  }, [copilotkit, tool.name, tool.agentId]);\n}\n","import { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { useMemo, useEffect, useReducer } from \"react\";\nimport { DEFAULT_AGENT_ID } from \"@copilotkitnext/shared\";\nimport { AbstractAgent } from \"@ag-ui/client\";\nimport { ProxiedCopilotRuntimeAgent, CopilotKitCoreRuntimeConnectionStatus } from \"@copilotkitnext/core\";\n\nexport enum UseAgentUpdate {\n  OnMessagesChanged = \"OnMessagesChanged\",\n  OnStateChanged = \"OnStateChanged\",\n  OnRunStatusChanged = \"OnRunStatusChanged\",\n}\n\nconst ALL_UPDATES: UseAgentUpdate[] = [\n  UseAgentUpdate.OnMessagesChanged,\n  UseAgentUpdate.OnStateChanged,\n  UseAgentUpdate.OnRunStatusChanged,\n];\n\nexport interface UseAgentProps {\n  agentId?: string;\n  updates?: UseAgentUpdate[];\n}\n\nexport function useAgent({ agentId, updates }: UseAgentProps = {}) {\n  agentId ??= DEFAULT_AGENT_ID;\n\n  const { copilotkit } = useCopilotKit();\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  const updateFlags = useMemo(\n    () => updates ?? ALL_UPDATES,\n    [JSON.stringify(updates)]\n  );\n\n  const agent: AbstractAgent = useMemo(() => {\n    const existing = copilotkit.getAgent(agentId);\n    if (existing) {\n      return existing;\n    }\n\n    const isRuntimeConfigured = copilotkit.runtimeUrl !== undefined;\n    const status = copilotkit.runtimeConnectionStatus;\n\n    // While runtime is not yet synced, return a provisional runtime agent\n    if (\n      isRuntimeConfigured &&\n      (status === CopilotKitCoreRuntimeConnectionStatus.Disconnected ||\n        status === CopilotKitCoreRuntimeConnectionStatus.Connecting)\n    ) {\n      const provisional = new ProxiedCopilotRuntimeAgent({\n        runtimeUrl: copilotkit.runtimeUrl,\n        agentId,\n        transport: copilotkit.runtimeTransport,\n      });\n      // Apply current headers so runs/connects inherit them\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (provisional as any).headers = { ...copilotkit.headers };\n      return provisional;\n    }\n\n    // If no runtime is configured (dev/local), return a no-op agent to satisfy the\n    // non-undefined contract without forcing network behavior.\n    // After runtime has synced (Connected or Error) or no runtime configured and the agent doesn't exist, throw a descriptive error\n    const knownAgents = Object.keys(copilotkit.agents ?? {});\n    const runtimePart = isRuntimeConfigured ? `runtimeUrl=${copilotkit.runtimeUrl}` : \"no runtimeUrl\";\n    throw new Error(\n      `useAgent: Agent '${agentId}' not found after runtime sync (${runtimePart}). ` +\n        (knownAgents.length ? `Known agents: [${knownAgents.join(\", \")}]` : \"No agents registered.\") +\n        \" Verify your runtime /info and/or agents__unsafe_dev_only.\",\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    agentId,\n    copilotkit.agents,\n    copilotkit.runtimeConnectionStatus,\n    copilotkit.runtimeUrl,\n    copilotkit.runtimeTransport,\n    JSON.stringify(copilotkit.headers),\n    copilotkit,\n  ]);\n\n  useEffect(() => {\n    if (updateFlags.length === 0) {\n      return;\n    }\n\n    const handlers: Parameters<AbstractAgent[\"subscribe\"]>[0] = {};\n\n    if (updateFlags.includes(UseAgentUpdate.OnMessagesChanged)) {\n      // Content stripping for immutableContent renderers is handled by CopilotKitCoreReact\n      handlers.onMessagesChanged = () => {\n        forceUpdate();\n      };\n    }\n\n    if (updateFlags.includes(UseAgentUpdate.OnStateChanged)) {\n      handlers.onStateChanged = forceUpdate;\n    }\n\n    if (updateFlags.includes(UseAgentUpdate.OnRunStatusChanged)) {\n      handlers.onRunInitialized = forceUpdate;\n      handlers.onRunFinalized = forceUpdate;\n      handlers.onRunFailed = forceUpdate;\n    }\n\n    const subscription = agent.subscribe(handlers);\n    return () => subscription.unsubscribe();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [agent, forceUpdate, JSON.stringify(updateFlags)]);\n\n  return {\n    agent,\n  };\n}\n","import { useCopilotKit } from \"../providers/CopilotKitProvider\";\nimport { useEffect, useMemo } from \"react\";\n\n/**\n * Represents any value that can be serialized to JSON.\n */\nexport type JsonSerializable =\n  | string\n  | number\n  | boolean\n  | null\n  | JsonSerializable[]\n  | { [key: string]: JsonSerializable };\n\n/**\n * Context configuration for useAgentContext.\n * Accepts any JSON-serializable value which will be converted to a string.\n */\nexport interface AgentContextInput {\n  /** A human-readable description of what this context represents */\n  description: string;\n  /** The context value - will be converted to a JSON string if not already a string */\n  value: JsonSerializable;\n}\n\nexport function useAgentContext(context: AgentContextInput) {\n  const { description, value } = context;\n  const { copilotkit } = useCopilotKit();\n\n  const stringValue = useMemo(() => {\n    if (typeof value === \"string\") {\n      return value;\n    }\n    return JSON.stringify(value);\n  }, [value]);\n\n  useEffect(() => {\n    if (!copilotkit) return;\n\n    const id = copilotkit.addContext({ description, value: stringValue });\n    return () => {\n      copilotkit.removeContext(id);\n    };\n  }, [description, stringValue, copilotkit]);\n}\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { Suggestion } from \"@copilotkitnext/core\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { useCopilotChatConfiguration } from \"@/providers/CopilotChatConfigurationProvider\";\nimport { DEFAULT_AGENT_ID } from \"@copilotkitnext/shared\";\n\nexport interface UseSuggestionsOptions {\n  agentId?: string;\n}\n\nexport interface UseSuggestionsResult {\n  suggestions: Suggestion[];\n  reloadSuggestions: () => void;\n  clearSuggestions: () => void;\n  isLoading: boolean;\n}\n\nexport function useSuggestions({ agentId }: UseSuggestionsOptions = {}): UseSuggestionsResult {\n  const { copilotkit } = useCopilotKit();\n  const config = useCopilotChatConfiguration();\n  const resolvedAgentId = useMemo(() => agentId ?? config?.agentId ?? DEFAULT_AGENT_ID, [agentId, config?.agentId]);\n\n  const [suggestions, setSuggestions] = useState<Suggestion[]>(() => {\n    const result = copilotkit.getSuggestions(resolvedAgentId);\n    return result.suggestions;\n  });\n  const [isLoading, setIsLoading] = useState(() => {\n    const result = copilotkit.getSuggestions(resolvedAgentId);\n    return result.isLoading;\n  });\n\n  useEffect(() => {\n    const result = copilotkit.getSuggestions(resolvedAgentId);\n    setSuggestions(result.suggestions);\n    setIsLoading(result.isLoading);\n  }, [copilotkit, resolvedAgentId]);\n\n  useEffect(() => {\n    const subscription = copilotkit.subscribe({\n      onSuggestionsChanged: ({ agentId: changedAgentId, suggestions }) => {\n        if (changedAgentId !== resolvedAgentId) {\n          return;\n        }\n        setSuggestions(suggestions);\n      },\n      onSuggestionsStartedLoading: ({ agentId: changedAgentId }) => {\n        if (changedAgentId !== resolvedAgentId) {\n          return;\n        }\n        setIsLoading(true);\n      },\n      onSuggestionsFinishedLoading: ({ agentId: changedAgentId }) => {\n        if (changedAgentId !== resolvedAgentId) {\n          return;\n        }\n        setIsLoading(false);\n      },\n      onSuggestionsConfigChanged: () => {\n        const result = copilotkit.getSuggestions(resolvedAgentId);\n        setSuggestions(result.suggestions);\n        setIsLoading(result.isLoading);\n      },\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [copilotkit, resolvedAgentId]);\n\n  const reloadSuggestions = useCallback(() => {\n    copilotkit.reloadSuggestions(resolvedAgentId);\n    // Loading state is handled by onSuggestionsStartedLoading event\n  }, [copilotkit, resolvedAgentId]);\n\n  const clearSuggestions = useCallback(() => {\n    copilotkit.clearSuggestions(resolvedAgentId);\n    // State updates are handled by onSuggestionsChanged event\n  }, [copilotkit, resolvedAgentId]);\n\n  return {\n    suggestions,\n    reloadSuggestions,\n    clearSuggestions,\n    isLoading,\n  };\n}\n","import { useCallback, useEffect, useMemo, useRef } from \"react\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { useCopilotChatConfiguration } from \"@/providers/CopilotChatConfigurationProvider\";\nimport { DEFAULT_AGENT_ID } from \"@copilotkitnext/shared\";\nimport {\n  DynamicSuggestionsConfig,\n  StaticSuggestionsConfig,\n  SuggestionsConfig,\n  Suggestion,\n} from \"@copilotkitnext/core\";\n\ntype StaticSuggestionInput = Omit<Suggestion, \"isLoading\"> & Partial<Pick<Suggestion, \"isLoading\">>;\n\ntype StaticSuggestionsConfigInput = Omit<StaticSuggestionsConfig, \"suggestions\"> & {\n  suggestions: StaticSuggestionInput[];\n};\n\ntype SuggestionsConfigInput = DynamicSuggestionsConfig | StaticSuggestionsConfigInput;\n\nexport function useConfigureSuggestions(\n  config: SuggestionsConfigInput | null | undefined,\n  deps?: ReadonlyArray<unknown>,\n): void {\n  const { copilotkit } = useCopilotKit();\n  const chatConfig = useCopilotChatConfiguration();\n  const extraDeps = deps ?? [];\n\n  const resolvedConsumerAgentId = useMemo(() => chatConfig?.agentId ?? DEFAULT_AGENT_ID, [chatConfig?.agentId]);\n\n  const rawConsumerAgentId = useMemo(() => (config ? (config as SuggestionsConfigInput).consumerAgentId : undefined), [config]);\n\n  const normalizationCacheRef = useRef<{ serialized: string | null; config: SuggestionsConfig | null }>({\n    serialized: null,\n    config: null,\n  });\n\n  const { normalizedConfig, serializedConfig } = useMemo(() => {\n    if (!config) {\n      normalizationCacheRef.current = { serialized: null, config: null };\n      return { normalizedConfig: null, serializedConfig: null };\n    }\n\n    if (config.available === \"disabled\") {\n      normalizationCacheRef.current = { serialized: null, config: null };\n      return { normalizedConfig: null, serializedConfig: null };\n    }\n\n    let built: SuggestionsConfig;\n    if (isDynamicConfig(config)) {\n      built = {\n        ...config,\n      } satisfies DynamicSuggestionsConfig;\n    } else {\n      const normalizedSuggestions = normalizeStaticSuggestions(config.suggestions);\n      const baseConfig: StaticSuggestionsConfig = {\n        ...config,\n        suggestions: normalizedSuggestions,\n      };\n      built = baseConfig;\n    }\n\n    const serialized = JSON.stringify(built);\n    const cache = normalizationCacheRef.current;\n    if (cache.serialized === serialized && cache.config) {\n      return { normalizedConfig: cache.config, serializedConfig: serialized };\n    }\n\n    normalizationCacheRef.current = { serialized, config: built };\n    return { normalizedConfig: built, serializedConfig: serialized };\n  }, [config, resolvedConsumerAgentId, ...extraDeps]);\n  const latestConfigRef = useRef<SuggestionsConfig | null>(null);\n  latestConfigRef.current = normalizedConfig;\n  const previousSerializedConfigRef = useRef<string | null>(null);\n\n  const targetAgentId = useMemo(() => {\n    if (!normalizedConfig) {\n      return resolvedConsumerAgentId;\n    }\n    const consumer = (normalizedConfig as StaticSuggestionsConfig | DynamicSuggestionsConfig).consumerAgentId;\n    if (!consumer || consumer === \"*\") {\n      return resolvedConsumerAgentId;\n    }\n    return consumer;\n  }, [normalizedConfig, resolvedConsumerAgentId]);\n\n  const isGlobalConfig = rawConsumerAgentId === undefined || rawConsumerAgentId === \"*\";\n\n  const requestReload = useCallback(() => {\n    if (!normalizedConfig) {\n      return;\n    }\n\n    if (isGlobalConfig) {\n      const agents = Object.values(copilotkit.agents ?? {});\n      for (const entry of agents) {\n        const agentId = entry.agentId;\n        if (!agentId) {\n          continue;\n        }\n        if (!entry.isRunning) {\n          copilotkit.reloadSuggestions(agentId);\n        }\n      }\n      return;\n    }\n\n    if (!targetAgentId) {\n      return;\n    }\n\n    copilotkit.reloadSuggestions(targetAgentId);\n  }, [copilotkit, isGlobalConfig, normalizedConfig, targetAgentId]);\n\n  useEffect(() => {\n    if (!serializedConfig || !latestConfigRef.current) {\n      return;\n    }\n\n    const id = copilotkit.addSuggestionsConfig(latestConfigRef.current);\n\n    requestReload();\n\n    return () => {\n      copilotkit.removeSuggestionsConfig(id);\n    };\n  }, [copilotkit, serializedConfig, requestReload]);\n\n  useEffect(() => {\n    if (!normalizedConfig) {\n      previousSerializedConfigRef.current = null;\n      return;\n    }\n    if (serializedConfig && previousSerializedConfigRef.current === serializedConfig) {\n      return;\n    }\n    if (serializedConfig) {\n      previousSerializedConfigRef.current = serializedConfig;\n    }\n    requestReload();\n  }, [normalizedConfig, requestReload, serializedConfig]);\n\n  useEffect(() => {\n    if (!normalizedConfig || extraDeps.length === 0) {\n      return;\n    }\n    requestReload();\n  }, [extraDeps.length, normalizedConfig, requestReload, ...extraDeps]);\n\n}\n\nfunction isDynamicConfig(config: SuggestionsConfigInput): config is DynamicSuggestionsConfig {\n  return \"instructions\" in config;\n}\n\nfunction normalizeStaticSuggestions(suggestions: StaticSuggestionInput[]): Suggestion[] {\n  return suggestions.map((suggestion) => ({\n    ...suggestion,\n    isLoading: suggestion.isLoading ?? false,\n  }));\n}\n","import { useRenderToolCall } from \"@/hooks\";\nimport { AssistantMessage, Message, ToolMessage } from \"@ag-ui/core\";\nimport React from \"react\";\n\nexport type CopilotChatToolCallsViewProps = {\n  message: AssistantMessage;\n  messages?: Message[];\n};\n\nexport function CopilotChatToolCallsView({\n  message,\n  messages = [],\n}: CopilotChatToolCallsViewProps) {\n  const renderToolCall = useRenderToolCall();\n\n  if (!message.toolCalls || message.toolCalls.length === 0) {\n    return null;\n  }\n\n  return (\n    <>\n      {message.toolCalls.map((toolCall) => {\n        const toolMessage = messages.find(\n          (m) => m.role === \"tool\" && m.toolCallId === toolCall.id\n        ) as ToolMessage | undefined;\n\n        return (\n          <React.Fragment key={toolCall.id}>\n            {renderToolCall({\n              toolCall,\n              toolMessage,\n            })}\n          </React.Fragment>\n        );\n      })}\n    </>\n  );\n}\n\nexport default CopilotChatToolCallsView;\n","import { useMemo, useState } from \"react\";\nimport { Copy, Check, Edit, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport {\n  useCopilotChatConfiguration,\n  CopilotChatDefaultLabels,\n} from \"@/providers/CopilotChatConfigurationProvider\";\nimport { twMerge } from \"tailwind-merge\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserMessage } from \"@ag-ui/core\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { renderSlot, WithSlots } from \"@/lib/slots\";\n\nfunction flattenUserMessageContent(content?: UserMessage[\"content\"]): string {\n  if (!content) {\n    return \"\";\n  }\n\n  if (typeof content === \"string\") {\n    return content;\n  }\n\n  return content\n    .map((part) => {\n      if (\n        part &&\n        typeof part === \"object\" &&\n        \"type\" in part &&\n        (part as { type?: unknown }).type === \"text\" &&\n        typeof (part as { text?: unknown }).text === \"string\"\n      ) {\n        return (part as { text: string }).text;\n      }\n      return \"\";\n    })\n    .filter((text) => text.length > 0)\n    .join(\"\\n\");\n}\n\nexport interface CopilotChatUserMessageOnEditMessageProps {\n  message: UserMessage;\n}\n\nexport interface CopilotChatUserMessageOnSwitchToBranchProps {\n  message: UserMessage;\n  branchIndex: number;\n  numberOfBranches: number;\n}\n\nexport type CopilotChatUserMessageProps = WithSlots<\n  {\n    messageRenderer: typeof CopilotChatUserMessage.MessageRenderer;\n    toolbar: typeof CopilotChatUserMessage.Toolbar;\n    copyButton: typeof CopilotChatUserMessage.CopyButton;\n    editButton: typeof CopilotChatUserMessage.EditButton;\n    branchNavigation: typeof CopilotChatUserMessage.BranchNavigation;\n  },\n  {\n    onEditMessage?: (props: CopilotChatUserMessageOnEditMessageProps) => void;\n    onSwitchToBranch?: (\n      props: CopilotChatUserMessageOnSwitchToBranchProps\n    ) => void;\n    message: UserMessage;\n    branchIndex?: number;\n    numberOfBranches?: number;\n    additionalToolbarItems?: React.ReactNode;\n  } & React.HTMLAttributes<HTMLDivElement>\n>;\n\nexport function CopilotChatUserMessage({\n  message,\n  onEditMessage,\n  branchIndex,\n  numberOfBranches,\n  onSwitchToBranch,\n  additionalToolbarItems,\n  messageRenderer,\n  toolbar,\n  copyButton,\n  editButton,\n  branchNavigation,\n  children,\n  className,\n  ...props\n}: CopilotChatUserMessageProps) {\n  const flattenedContent = useMemo(\n    () => flattenUserMessageContent(message.content),\n    [message.content]\n  );\n\n  const BoundMessageRenderer = renderSlot(\n    messageRenderer,\n    CopilotChatUserMessage.MessageRenderer,\n    {\n      content: flattenedContent,\n    }\n  );\n\n  const BoundCopyButton = renderSlot(\n    copyButton,\n    CopilotChatUserMessage.CopyButton,\n    {\n      onClick: async () => {\n        if (flattenedContent) {\n          try {\n            await navigator.clipboard.writeText(flattenedContent);\n          } catch (err) {\n            console.error(\"Failed to copy message:\", err);\n          }\n        }\n      },\n    }\n  );\n\n  const BoundEditButton = renderSlot(\n    editButton,\n    CopilotChatUserMessage.EditButton,\n    {\n      onClick: () => onEditMessage?.({ message }),\n    }\n  );\n\n  const BoundBranchNavigation = renderSlot(\n    branchNavigation,\n    CopilotChatUserMessage.BranchNavigation,\n    {\n      currentBranch: branchIndex,\n      numberOfBranches,\n      onSwitchToBranch,\n      message,\n    }\n  );\n\n  const showBranchNavigation =\n    numberOfBranches && numberOfBranches > 1 && onSwitchToBranch;\n\n  const BoundToolbar = renderSlot(toolbar, CopilotChatUserMessage.Toolbar, {\n    children: (\n      <div className=\"flex items-center gap-1 justify-end\">\n        {additionalToolbarItems}\n        {BoundCopyButton}\n        {onEditMessage && BoundEditButton}\n        {showBranchNavigation && BoundBranchNavigation}\n      </div>\n    ),\n  });\n\n  if (children) {\n    return (\n      <>\n        {children({\n          messageRenderer: BoundMessageRenderer,\n          toolbar: BoundToolbar,\n          copyButton: BoundCopyButton,\n          editButton: BoundEditButton,\n          branchNavigation: BoundBranchNavigation,\n          message,\n          branchIndex,\n          numberOfBranches,\n          additionalToolbarItems,\n        })}\n      </>\n    );\n  }\n\n  return (\n    <div\n      className={twMerge(\"flex flex-col items-end group pt-10\", className)}\n      data-message-id={message.id}\n      {...props}\n    >\n      {BoundMessageRenderer}\n      {BoundToolbar}\n    </div>\n  );\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace CopilotChatUserMessage {\n  export const Container: React.FC<\n    React.PropsWithChildren<React.HTMLAttributes<HTMLDivElement>>\n  > = ({ children, className, ...props }) => (\n    <div\n      className={twMerge(\"flex flex-col items-end group\", className)}\n      {...props}\n    >\n      {children}\n    </div>\n  );\n\n  export const MessageRenderer: React.FC<{\n    content: string;\n    className?: string;\n  }> = ({ content, className }) => (\n    <div\n      className={twMerge(\n        \"prose dark:prose-invert bg-muted relative max-w-[80%] rounded-[18px] px-4 py-1.5 data-[multiline]:py-3 inline-block whitespace-pre-wrap\",\n        className\n      )}\n    >\n      {content}\n    </div>\n  );\n\n  export const Toolbar: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({\n    className,\n    ...props\n  }) => (\n    <div\n      className={twMerge(\n        \"w-full bg-transparent flex items-center justify-end -mr-[5px] mt-[4px] invisible group-hover:visible\",\n        className\n      )}\n      {...props}\n    />\n  );\n\n  export const ToolbarButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement> & {\n      title: string;\n      children: React.ReactNode;\n    }\n  > = ({ title, children, className, ...props }) => {\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            type=\"button\"\n            variant=\"assistantMessageToolbarButton\"\n            aria-label={title}\n            className={twMerge(className)}\n            {...props}\n          >\n            {children}\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent side=\"bottom\">\n          <p>{title}</p>\n        </TooltipContent>\n      </Tooltip>\n    );\n  };\n\n  export const CopyButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement> & { copied?: boolean }\n  > = ({ className, title, onClick, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    const [copied, setCopied] = useState(false);\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n\n      if (onClick) {\n        onClick(event);\n      }\n    };\n\n    return (\n      <ToolbarButton\n        title={title || labels.userMessageToolbarCopyMessageLabel}\n        onClick={handleClick}\n        className={className}\n        {...props}\n      >\n        {copied ? (\n          <Check className=\"size-[18px]\" />\n        ) : (\n          <Copy className=\"size-[18px]\" />\n        )}\n      </ToolbarButton>\n    );\n  };\n\n  export const EditButton: React.FC<\n    React.ButtonHTMLAttributes<HTMLButtonElement>\n  > = ({ className, title, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n    return (\n      <ToolbarButton\n        title={title || labels.userMessageToolbarEditMessageLabel}\n        className={className}\n        {...props}\n      >\n        <Edit className=\"size-[18px]\" />\n      </ToolbarButton>\n    );\n  };\n\n  export const BranchNavigation: React.FC<\n    React.HTMLAttributes<HTMLDivElement> & {\n      currentBranch?: number;\n      numberOfBranches?: number;\n      onSwitchToBranch?: (\n        props: CopilotChatUserMessageOnSwitchToBranchProps\n      ) => void;\n      message: UserMessage;\n    }\n  > = ({\n    className,\n    currentBranch = 0,\n    numberOfBranches = 1,\n    onSwitchToBranch,\n    message,\n    ...props\n  }) => {\n    if (!numberOfBranches || numberOfBranches <= 1 || !onSwitchToBranch) {\n      return null;\n    }\n\n    const canGoPrev = currentBranch > 0;\n    const canGoNext = currentBranch < numberOfBranches - 1;\n\n    return (\n      <div className={twMerge(\"flex items-center gap-1\", className)} {...props}>\n        <Button\n          type=\"button\"\n          variant=\"assistantMessageToolbarButton\"\n          onClick={() =>\n            onSwitchToBranch?.({\n              branchIndex: currentBranch - 1,\n              numberOfBranches,\n              message,\n            })\n          }\n          disabled={!canGoPrev}\n          className=\"h-6 w-6 p-0\"\n        >\n          <ChevronLeft className=\"size-[20px]\" />\n        </Button>\n        <span className=\"text-sm text-muted-foreground px-0 font-medium\">\n          {currentBranch + 1}/{numberOfBranches}\n        </span>\n        <Button\n          type=\"button\"\n          variant=\"assistantMessageToolbarButton\"\n          onClick={() =>\n            onSwitchToBranch?.({\n              branchIndex: currentBranch + 1,\n              numberOfBranches,\n              message,\n            })\n          }\n          disabled={!canGoNext}\n          className=\"h-6 w-6 p-0\"\n        >\n          <ChevronRight className=\"size-[20px]\" />\n        </Button>\n      </div>\n    );\n  };\n}\n\nCopilotChatUserMessage.Container.displayName =\n  \"CopilotChatUserMessage.Container\";\nCopilotChatUserMessage.MessageRenderer.displayName =\n  \"CopilotChatUserMessage.MessageRenderer\";\nCopilotChatUserMessage.Toolbar.displayName = \"CopilotChatUserMessage.Toolbar\";\nCopilotChatUserMessage.ToolbarButton.displayName =\n  \"CopilotChatUserMessage.ToolbarButton\";\nCopilotChatUserMessage.CopyButton.displayName =\n  \"CopilotChatUserMessage.CopyButton\";\nCopilotChatUserMessage.EditButton.displayName =\n  \"CopilotChatUserMessage.EditButton\";\nCopilotChatUserMessage.BranchNavigation.displayName =\n  \"CopilotChatUserMessage.BranchNavigation\";\n\nexport default CopilotChatUserMessage;\n","import React from \"react\";\nimport { Loader2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface CopilotChatSuggestionPillProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  /** Optional icon to render on the left side when not loading. */\n  icon?: React.ReactNode;\n  /** Whether the pill should display a loading spinner. */\n  isLoading?: boolean;\n}\n\nconst baseClasses =\n  \"group inline-flex h-7 sm:h-8 items-center gap-1 sm:gap-1.5 rounded-full border border-border/60 bg-background px-2.5 sm:px-3 text-[11px] sm:text-xs leading-none text-foreground transition-colors cursor-pointer hover:bg-accent/60 hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:text-muted-foreground disabled:hover:bg-background disabled:hover:text-muted-foreground pointer-events-auto\";\n\nconst labelClasses = \"whitespace-nowrap font-medium leading-none\";\n\nexport const CopilotChatSuggestionPill = React.forwardRef<\n  HTMLButtonElement,\n  CopilotChatSuggestionPillProps\n>(function CopilotChatSuggestionPill(\n  { className, children, icon, isLoading, type, ...props },\n  ref\n) {\n  const showIcon = !isLoading && icon;\n\n  return (\n    <button\n      ref={ref}\n      data-slot=\"suggestion-pill\"\n      className={cn(baseClasses, className)}\n      type={type ?? \"button\"}\n      aria-busy={isLoading || undefined}\n      disabled={isLoading || props.disabled}\n      {...props}\n    >\n      {isLoading ? (\n        <span className=\"flex h-3.5 sm:h-4 w-3.5 sm:w-4 items-center justify-center text-muted-foreground\">\n          <Loader2 className=\"h-3.5 sm:h-4 w-3.5 sm:w-4 animate-spin\" aria-hidden=\"true\" />\n        </span>\n      ) : (\n        showIcon && (\n          <span className=\"flex h-3.5 sm:h-4 w-3.5 sm:w-4 items-center justify-center text-muted-foreground\">{icon}</span>\n        )\n      )}\n      <span className={labelClasses}>{children}</span>\n    </button>\n  );\n});\n\nCopilotChatSuggestionPill.displayName = \"CopilotChatSuggestionPill\";\n\nexport default CopilotChatSuggestionPill;\n","import React from \"react\";\nimport { Suggestion } from \"@copilotkitnext/core\";\nimport { renderSlot, WithSlots } from \"@/lib/slots\";\nimport { cn } from \"@/lib/utils\";\nimport CopilotChatSuggestionPill, {\n  CopilotChatSuggestionPillProps,\n} from \"./CopilotChatSuggestionPill\";\n\nconst DefaultContainer = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(function DefaultContainer({ className, ...props }, ref) {\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"flex flex-wrap items-center gap-1.5 sm:gap-2 pl-0 pr-4 sm:px-0 pointer-events-none\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\n\nexport type CopilotChatSuggestionViewProps = WithSlots<\n  {\n    container: typeof DefaultContainer;\n    suggestion: typeof CopilotChatSuggestionPill;\n  },\n  {\n    suggestions: Suggestion[];\n    onSelectSuggestion?: (suggestion: Suggestion, index: number) => void;\n    loadingIndexes?: ReadonlyArray<number>;\n  } & React.HTMLAttributes<HTMLDivElement>\n>;\n\nexport const CopilotChatSuggestionView = React.forwardRef<\n  HTMLDivElement,\n  CopilotChatSuggestionViewProps\n>(function CopilotChatSuggestionView(\n  {\n    suggestions,\n    onSelectSuggestion,\n    loadingIndexes,\n    container,\n    suggestion: suggestionSlot,\n    className,\n    children,\n    ...restProps\n  },\n  ref,\n) {\n  const loadingSet = React.useMemo(() => {\n    if (!loadingIndexes || loadingIndexes.length === 0) {\n      return new Set<number>();\n    }\n    return new Set(loadingIndexes);\n  }, [loadingIndexes]);\n\n  const ContainerElement = renderSlot(container, DefaultContainer, {\n    ref,\n    className,\n    ...restProps,\n  });\n\n  const suggestionElements = suggestions.map((suggestion, index) => {\n    const isLoading = loadingSet.has(index) || suggestion.isLoading === true;\n    const pill = renderSlot<\n      typeof CopilotChatSuggestionPill,\n      CopilotChatSuggestionPillProps\n    >(suggestionSlot, CopilotChatSuggestionPill, {\n      children: suggestion.title,\n      isLoading,\n      type: \"button\",\n      onClick: () => onSelectSuggestion?.(suggestion, index),\n    });\n\n    return React.cloneElement(pill, {\n      key: `${suggestion.title}-${index}`,\n    });\n  });\n\n  const boundContainer = React.cloneElement(\n    ContainerElement,\n    undefined,\n    suggestionElements,\n  );\n\n  if (typeof children === \"function\") {\n    const sampleSuggestion = renderSlot<\n      typeof CopilotChatSuggestionPill,\n      CopilotChatSuggestionPillProps\n    >(suggestionSlot, CopilotChatSuggestionPill, {\n      children: suggestions[0]?.title ?? \"\",\n      isLoading:\n        suggestions.length > 0 ? loadingSet.has(0) || suggestions[0]?.isLoading === true : false,\n      type: \"button\",\n    });\n\n    return (\n      <>\n        {children({\n          container: boundContainer,\n          suggestion: sampleSuggestion,\n          suggestions,\n          onSelectSuggestion,\n          loadingIndexes,\n          className,\n          ...restProps,\n        })}\n      </>\n    );\n  }\n\n  if (children) {\n    return (\n      <>\n        {boundContainer}\n        {children}\n      </>\n    );\n  }\n\n  return boundContainer;\n});\n\nCopilotChatSuggestionView.displayName = \"CopilotChatSuggestionView\";\n\nexport default CopilotChatSuggestionView;\n","import React, { useEffect, useReducer } from \"react\";\nimport { WithSlots, renderSlot } from \"@/lib/slots\";\nimport CopilotChatAssistantMessage from \"./CopilotChatAssistantMessage\";\nimport CopilotChatUserMessage from \"./CopilotChatUserMessage\";\nimport { ActivityMessage, AssistantMessage, Message, UserMessage } from \"@ag-ui/core\";\nimport { twMerge } from \"tailwind-merge\";\nimport { useRenderActivityMessage, useRenderCustomMessages } from \"@/hooks\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { useCopilotChatConfiguration } from \"@/providers/CopilotChatConfigurationProvider\";\n\n\n/**\n * Memoized wrapper for assistant messages to prevent re-renders when other messages change.\n */\nconst MemoizedAssistantMessage = React.memo(\n  function MemoizedAssistantMessage({\n    message,\n    messages,\n    isRunning,\n    AssistantMessageComponent,\n  }: {\n    message: AssistantMessage;\n    messages: Message[];\n    isRunning: boolean;\n    AssistantMessageComponent: typeof CopilotChatAssistantMessage;\n  }) {\n    return (\n      <AssistantMessageComponent\n        message={message}\n        messages={messages}\n        isRunning={isRunning}\n      />\n    );\n  },\n  (prevProps, nextProps) => {\n    // Only re-render if this specific message changed\n    if (prevProps.message.id !== nextProps.message.id) return false;\n    if (prevProps.message.content !== nextProps.message.content) return false;\n\n    // Compare tool calls if present\n    const prevToolCalls = prevProps.message.toolCalls;\n    const nextToolCalls = nextProps.message.toolCalls;\n    if (prevToolCalls?.length !== nextToolCalls?.length) return false;\n    if (prevToolCalls && nextToolCalls) {\n      for (let i = 0; i < prevToolCalls.length; i++) {\n        const prevTc = prevToolCalls[i];\n        const nextTc = nextToolCalls[i];\n        if (!prevTc || !nextTc) return false;\n        if (prevTc.id !== nextTc.id) return false;\n        if (prevTc.function.arguments !== nextTc.function.arguments) return false;\n      }\n    }\n\n    // Check if tool results changed for this message's tool calls\n    // Tool results are separate messages with role=\"tool\" that reference tool call IDs\n    if (prevToolCalls && prevToolCalls.length > 0) {\n      const toolCallIds = new Set(prevToolCalls.map(tc => tc.id));\n\n      const prevToolResults = prevProps.messages.filter(\n        m => m.role === \"tool\" && toolCallIds.has((m as any).toolCallId)\n      );\n      const nextToolResults = nextProps.messages.filter(\n        m => m.role === \"tool\" && toolCallIds.has((m as any).toolCallId)\n      );\n\n      // If number of tool results changed, re-render\n      if (prevToolResults.length !== nextToolResults.length) return false;\n\n      // If any tool result content changed, re-render\n      for (let i = 0; i < prevToolResults.length; i++) {\n        if ((prevToolResults[i] as any).content !== (nextToolResults[i] as any).content) return false;\n      }\n    }\n\n    // Only care about isRunning if this message is CURRENTLY the latest\n    // (we don't need to re-render just because a message stopped being the latest)\n    const nextIsLatest = nextProps.messages[nextProps.messages.length - 1]?.id === nextProps.message.id;\n    if (nextIsLatest && prevProps.isRunning !== nextProps.isRunning) return false;\n\n    // Check if component reference changed\n    if (prevProps.AssistantMessageComponent !== nextProps.AssistantMessageComponent) return false;\n\n    return true;\n  }\n);\n\n/**\n * Memoized wrapper for user messages to prevent re-renders when other messages change.\n */\nconst MemoizedUserMessage = React.memo(\n  function MemoizedUserMessage({\n    message,\n    UserMessageComponent,\n  }: {\n    message: UserMessage;\n    UserMessageComponent: typeof CopilotChatUserMessage;\n  }) {\n    return <UserMessageComponent message={message} />;\n  },\n  (prevProps, nextProps) => {\n    // Only re-render if this specific message changed\n    if (prevProps.message.id !== nextProps.message.id) return false;\n    if (prevProps.message.content !== nextProps.message.content) return false;\n    if (prevProps.UserMessageComponent !== nextProps.UserMessageComponent) return false;\n    return true;\n  }\n);\n\n/**\n * Memoized wrapper for activity messages to prevent re-renders when other messages change.\n */\nconst MemoizedActivityMessage = React.memo(\n  function MemoizedActivityMessage({\n    message,\n    renderActivityMessage,\n  }: {\n    message: ActivityMessage;\n    renderActivityMessage: (message: ActivityMessage) => React.ReactElement | null;\n  }) {\n    return renderActivityMessage(message);\n  },\n  (prevProps, nextProps) => {\n    // Message ID changed = different message, must re-render\n    if (prevProps.message.id !== nextProps.message.id) return false;\n\n    // Activity type changed = must re-render\n    if (prevProps.message.activityType !== nextProps.message.activityType) return false;\n\n    // Compare content using JSON.stringify (native code, handles deep comparison)\n    if (JSON.stringify(prevProps.message.content) !== JSON.stringify(nextProps.message.content)) return false;\n\n    return true;\n  }\n);\n\n/**\n * Memoized wrapper for custom messages to prevent re-renders when other messages change.\n */\nconst MemoizedCustomMessage = React.memo(\n  function MemoizedCustomMessage({\n    message,\n    position,\n    renderCustomMessage,\n  }: {\n    message: Message;\n    position: \"before\" | \"after\";\n    renderCustomMessage: (params: { message: Message; position: \"before\" | \"after\" }) => React.ReactElement | null;\n    stateSnapshot?: unknown;\n  }) {\n    return renderCustomMessage({ message, position });\n  },\n  (prevProps, nextProps) => {\n    // Only re-render if the message or position changed\n    if (prevProps.message.id !== nextProps.message.id) return false;\n    if (prevProps.position !== nextProps.position) return false;\n    // Compare message content - for assistant messages this is a string, for others may differ\n    if (prevProps.message.content !== nextProps.message.content) return false;\n    if (prevProps.message.role !== nextProps.message.role) return false;\n    // Compare state snapshot - custom renderers may depend on state\n    if (JSON.stringify(prevProps.stateSnapshot) !== JSON.stringify(nextProps.stateSnapshot)) return false;\n    // Note: We don't compare renderCustomMessage function reference because it changes\n    // frequently. The message and state comparison is sufficient to determine if a re-render is needed.\n    return true;\n  }\n);\n\nexport type CopilotChatMessageViewProps = Omit<\n  WithSlots<\n    {\n      assistantMessage: typeof CopilotChatAssistantMessage;\n      userMessage: typeof CopilotChatUserMessage;\n      cursor: typeof CopilotChatMessageView.Cursor;\n    },\n    {\n      isRunning?: boolean;\n      messages?: Message[];\n    } & React.HTMLAttributes<HTMLDivElement>\n  >,\n  \"children\"\n> & {\n  children?: (props: {\n    isRunning: boolean;\n    messages: Message[];\n    messageElements: React.ReactElement[];\n  }) => React.ReactElement;\n};\n\nexport function CopilotChatMessageView({\n  messages = [],\n  assistantMessage,\n  userMessage,\n  cursor,\n  isRunning = false,\n  children,\n  className,\n  ...props\n}: CopilotChatMessageViewProps) {\n  const renderCustomMessage = useRenderCustomMessages();\n  const { renderActivityMessage } = useRenderActivityMessage();\n  const { copilotkit } = useCopilotKit();\n  const config = useCopilotChatConfiguration();\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\n\n  // Subscribe to state changes so custom message renderers re-render when state updates.\n  useEffect(() => {\n    if (!config?.agentId) return;\n    const agent = copilotkit.getAgent(config.agentId);\n    if (!agent) return;\n\n    const subscription = agent.subscribe({\n      onStateChanged: forceUpdate,\n    });\n    return () => subscription.unsubscribe();\n  }, [config?.agentId, copilotkit, forceUpdate]);\n\n  // Helper to get state snapshot for a message (used for memoization)\n  const getStateSnapshotForMessage = (messageId: string): unknown => {\n    if (!config) return undefined;\n    const runId = copilotkit.getRunIdForMessage(config.agentId, config.threadId, messageId);\n    if (!runId) return undefined;\n    return copilotkit.getStateByRun(config.agentId, config.threadId, runId);\n  };\n\n  const messageElements: React.ReactElement[] = messages\n    .flatMap((message) => {\n      const elements: (React.ReactElement | null | undefined)[] = [];\n      const stateSnapshot = getStateSnapshotForMessage(message.id);\n\n      // Render custom message before (using memoized wrapper)\n      if (renderCustomMessage) {\n        elements.push(\n          <MemoizedCustomMessage\n            key={`${message.id}-custom-before`}\n            message={message}\n            position=\"before\"\n            renderCustomMessage={renderCustomMessage}\n            stateSnapshot={stateSnapshot}\n          />\n        );\n      }\n\n      // Render the main message using memoized wrappers to prevent unnecessary re-renders\n      if (message.role === \"assistant\") {\n        // Determine the component to use (custom slot or default)\n        const AssistantComponent = (\n          typeof assistantMessage === \"function\"\n            ? assistantMessage\n            : CopilotChatAssistantMessage\n        ) as typeof CopilotChatAssistantMessage;\n\n        elements.push(\n          <MemoizedAssistantMessage\n            key={message.id}\n            message={message as AssistantMessage}\n            messages={messages}\n            isRunning={isRunning}\n            AssistantMessageComponent={AssistantComponent}\n          />\n        );\n      } else if (message.role === \"user\") {\n        // Determine the component to use (custom slot or default)\n        const UserComponent = (\n          typeof userMessage === \"function\"\n            ? userMessage\n            : CopilotChatUserMessage\n        ) as typeof CopilotChatUserMessage;\n\n        elements.push(\n          <MemoizedUserMessage\n            key={message.id}\n            message={message as UserMessage}\n            UserMessageComponent={UserComponent}\n          />\n        );\n      } else if (message.role === \"activity\") {\n        // Use memoized wrapper to prevent re-renders when other messages change\n        const activityMsg = message as ActivityMessage;\n        elements.push(\n          <MemoizedActivityMessage\n            key={message.id}\n            message={activityMsg}\n            renderActivityMessage={renderActivityMessage}\n          />\n        );\n      }\n\n      // Render custom message after (using memoized wrapper)\n      if (renderCustomMessage) {\n        elements.push(\n          <MemoizedCustomMessage\n            key={`${message.id}-custom-after`}\n            message={message}\n            position=\"after\"\n            renderCustomMessage={renderCustomMessage}\n            stateSnapshot={stateSnapshot}\n          />\n        );\n      }\n\n      return elements;\n    })\n    .filter(Boolean) as React.ReactElement[];\n\n  if (children) {\n    return children({ messageElements, messages, isRunning });\n  }\n\n  return (\n    <div className={twMerge(\"flex flex-col\", className)} {...props}>\n      {messageElements}\n      {isRunning && renderSlot(cursor, CopilotChatMessageView.Cursor, {})}\n    </div>\n  );\n}\n\nCopilotChatMessageView.Cursor = function Cursor({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={twMerge(\"w-[11px] h-[11px] rounded-full bg-foreground animate-pulse-cursor ml-1\", className)}\n      {...props}\n    />\n  );\n};\n\nexport default CopilotChatMessageView;\n","import React, { useRef, useState, useEffect } from \"react\";\nimport { WithSlots, SlotValue, renderSlot } from \"@/lib/slots\";\nimport CopilotChatMessageView from \"./CopilotChatMessageView\";\nimport CopilotChatInput, { CopilotChatInputProps } from \"./CopilotChatInput\";\nimport CopilotChatSuggestionView, { CopilotChatSuggestionViewProps } from \"./CopilotChatSuggestionView\";\nimport { Suggestion } from \"@copilotkitnext/core\";\nimport { Message } from \"@ag-ui/core\";\nimport { twMerge } from \"tailwind-merge\";\nimport { StickToBottom, useStickToBottom, useStickToBottomContext } from \"use-stick-to-bottom\";\nimport { ChevronDown } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\nimport { useCopilotChatConfiguration, CopilotChatDefaultLabels } from \"@/providers/CopilotChatConfigurationProvider\";\nimport { useKeyboardHeight } from \"@/hooks/use-keyboard-height\";\n\nexport type CopilotChatViewProps = WithSlots<\n  {\n    messageView: typeof CopilotChatMessageView;\n    scrollView: React.FC<React.HTMLAttributes<HTMLDivElement>>;\n    scrollToBottomButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>>;\n    input: typeof CopilotChatInput;\n    inputContainer: React.FC<React.HTMLAttributes<HTMLDivElement> & { children: React.ReactNode }>;\n    feather: React.FC<React.HTMLAttributes<HTMLDivElement>>;\n    disclaimer: React.FC<React.HTMLAttributes<HTMLDivElement>>;\n    suggestionView: typeof CopilotChatSuggestionView;\n  },\n  {\n    messages?: Message[];\n    autoScroll?: boolean;\n    inputProps?: Partial<Omit<CopilotChatInputProps, \"children\">>;\n    isRunning?: boolean;\n    suggestions?: Suggestion[];\n    suggestionLoadingIndexes?: ReadonlyArray<number>;\n    onSelectSuggestion?: (suggestion: Suggestion, index: number) => void;\n  } & React.HTMLAttributes<HTMLDivElement>\n>;\n\nexport function CopilotChatView({\n  messageView,\n  input,\n  scrollView,\n  scrollToBottomButton,\n  feather,\n  inputContainer,\n  disclaimer,\n  suggestionView,\n  messages = [],\n  autoScroll = true,\n  inputProps,\n  isRunning = false,\n  suggestions,\n  suggestionLoadingIndexes,\n  onSelectSuggestion,\n  children,\n  className,\n  ...props\n}: CopilotChatViewProps) {\n  const inputContainerRef = useRef<HTMLDivElement>(null);\n  const [inputContainerHeight, setInputContainerHeight] = useState(0);\n  const [isResizing, setIsResizing] = useState(false);\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Track keyboard state for mobile\n  const { isKeyboardOpen, keyboardHeight, availableHeight } = useKeyboardHeight();\n\n  // Track input container height changes\n  useEffect(() => {\n    const element = inputContainerRef.current;\n    if (!element) return;\n\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        const newHeight = entry.contentRect.height;\n\n        // Update height and set resizing state\n        setInputContainerHeight((prevHeight) => {\n          if (newHeight !== prevHeight) {\n            setIsResizing(true);\n\n            // Clear existing timeout\n            if (resizeTimeoutRef.current) {\n              clearTimeout(resizeTimeoutRef.current);\n            }\n\n            // Set isResizing to false after a short delay\n            resizeTimeoutRef.current = setTimeout(() => {\n              setIsResizing(false);\n            }, 250);\n\n            return newHeight;\n          }\n          return prevHeight;\n        });\n      }\n    });\n\n    resizeObserver.observe(element);\n\n    // Set initial height\n    setInputContainerHeight(element.offsetHeight);\n\n    return () => {\n      resizeObserver.disconnect();\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const BoundMessageView = renderSlot(messageView, CopilotChatMessageView, {\n    messages,\n    isRunning,\n  });\n\n  const BoundInput = renderSlot(input, CopilotChatInput, (inputProps ?? {}) as CopilotChatInputProps);\n\n  const hasSuggestions = Array.isArray(suggestions) && suggestions.length > 0;\n  const BoundSuggestionView = hasSuggestions\n    ? renderSlot(suggestionView, CopilotChatSuggestionView, {\n        suggestions,\n        loadingIndexes: suggestionLoadingIndexes,\n        onSelectSuggestion,\n        className: \"mb-3 lg:ml-4 lg:mr-4 ml-0 mr-0\",\n      })\n    : null;\n\n  const BoundFeather = renderSlot(feather, CopilotChatView.Feather, {});\n\n  const BoundScrollView = renderSlot(scrollView, CopilotChatView.ScrollView, {\n    autoScroll,\n    scrollToBottomButton,\n    inputContainerHeight,\n    isResizing,\n    children: (\n      <div style={{ paddingBottom: `${inputContainerHeight + (hasSuggestions ? 4 : 32)}px` }}>\n        <div className=\"max-w-3xl mx-auto\">\n          {BoundMessageView}\n          {hasSuggestions ? <div className=\"pl-0 pr-4 sm:px-0 mt-4\">{BoundSuggestionView}</div> : null}\n        </div>\n      </div>\n    ),\n  });\n\n  const BoundScrollToBottomButton = renderSlot(scrollToBottomButton, CopilotChatView.ScrollToBottomButton, {});\n\n  const BoundDisclaimer = renderSlot(disclaimer, CopilotChatView.Disclaimer, {});\n\n  const BoundInputContainer = renderSlot(inputContainer, CopilotChatView.InputContainer, {\n    ref: inputContainerRef,\n    keyboardHeight: isKeyboardOpen ? keyboardHeight : 0,\n    children: (\n      <>\n        <div className=\"max-w-3xl mx-auto py-0 px-4 sm:px-0 [div[data-sidebar-chat]_&]:px-8 [div[data-popup-chat]_&]:px-6 pointer-events-auto\">\n          {BoundInput}\n        </div>\n        {BoundDisclaimer}\n      </>\n    ),\n  });\n\n  if (children) {\n    return children({\n      messageView: BoundMessageView,\n      input: BoundInput,\n      scrollView: BoundScrollView,\n      scrollToBottomButton: BoundScrollToBottomButton,\n      feather: BoundFeather,\n      inputContainer: BoundInputContainer,\n      disclaimer: BoundDisclaimer,\n      suggestionView: BoundSuggestionView ?? <></>,\n    });\n  }\n\n  return (\n    <div className={twMerge(\"relative h-full\", className)} {...props}>\n      {BoundScrollView}\n\n      {BoundFeather}\n\n      {BoundInputContainer}\n    </div>\n  );\n}\n\nexport namespace CopilotChatView {\n  // Inner component that has access to StickToBottom context\n  const ScrollContent: React.FC<{\n    children: React.ReactNode;\n    scrollToBottomButton?: SlotValue<React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>>>;\n    inputContainerHeight: number;\n    isResizing: boolean;\n  }> = ({ children, scrollToBottomButton, inputContainerHeight, isResizing }) => {\n    const { isAtBottom, scrollToBottom } = useStickToBottomContext();\n\n    return (\n      <>\n        <StickToBottom.Content className=\"overflow-y-scroll overflow-x-hidden\">\n        <div className=\"px-4 sm:px-0 [div[data-sidebar-chat]_&]:px-8 [div[data-popup-chat]_&]:px-6\">{children}</div>\n        </StickToBottom.Content>\n\n        {/* Scroll to bottom button - hidden during resize */}\n        {!isAtBottom && !isResizing && (\n          <div\n            className=\"absolute inset-x-0 flex justify-center z-10 pointer-events-none\"\n            style={{\n              bottom: `${inputContainerHeight + 16}px`,\n            }}\n          >\n            {renderSlot(scrollToBottomButton, CopilotChatView.ScrollToBottomButton, {\n              onClick: () => scrollToBottom(),\n            })}\n          </div>\n        )}\n      </>\n    );\n  };\n\n  export const ScrollView: React.FC<\n    React.HTMLAttributes<HTMLDivElement> & {\n      autoScroll?: boolean;\n      scrollToBottomButton?: SlotValue<React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>>>;\n      inputContainerHeight?: number;\n      isResizing?: boolean;\n    }\n  > = ({\n    children,\n    autoScroll = true,\n    scrollToBottomButton,\n    inputContainerHeight = 0,\n    isResizing = false,\n    className,\n    ...props\n  }) => {\n    const [hasMounted, setHasMounted] = useState(false);\n    const { scrollRef, contentRef, scrollToBottom } = useStickToBottom();\n    const [showScrollButton, setShowScrollButton] = useState(false);\n\n    useEffect(() => {\n      setHasMounted(true);\n    }, []);\n\n    // Monitor scroll position for non-autoscroll mode\n    useEffect(() => {\n      if (autoScroll) return; // Skip for autoscroll mode\n\n      const scrollElement = scrollRef.current;\n      if (!scrollElement) return;\n\n      const checkScroll = () => {\n        const atBottom = scrollElement.scrollHeight - scrollElement.scrollTop - scrollElement.clientHeight < 10;\n        setShowScrollButton(!atBottom);\n      };\n\n      checkScroll();\n      scrollElement.addEventListener(\"scroll\", checkScroll);\n\n      // Also check on resize\n      const resizeObserver = new ResizeObserver(checkScroll);\n      resizeObserver.observe(scrollElement);\n\n      return () => {\n        scrollElement.removeEventListener(\"scroll\", checkScroll);\n        resizeObserver.disconnect();\n      };\n    }, [scrollRef, autoScroll]);\n\n    if (!hasMounted) {\n      return (\n        <div className=\"h-full max-h-full flex flex-col min-h-0 overflow-y-scroll overflow-x-hidden\">\n          <div className=\"px-4 sm:px-0 [div[data-sidebar-chat]_&]:px-8 [div[data-popup-chat]_&]:px-6\">{children}</div>\n        </div>\n      );\n    }\n\n    // When autoScroll is false, we don't use StickToBottom\n    if (!autoScroll) {\n      return (\n        <div\n          ref={scrollRef}\n          className={cn(\n            \"h-full max-h-full flex flex-col min-h-0 overflow-y-scroll overflow-x-hidden relative\",\n            className,\n          )}\n          {...props}\n        >\n          <div ref={contentRef} className=\"px-4 sm:px-0 [div[data-sidebar-chat]_&]:px-8 [div[data-popup-chat]_&]:px-6\">\n            {children}\n          </div>\n\n          {/* Scroll to bottom button for manual mode */}\n          {showScrollButton && !isResizing && (\n            <div\n              className=\"absolute inset-x-0 flex justify-center z-10 pointer-events-none\"\n              style={{\n                bottom: `${inputContainerHeight + 16}px`,\n              }}\n            >\n              {renderSlot(scrollToBottomButton, CopilotChatView.ScrollToBottomButton, {\n                onClick: () => scrollToBottom(),\n              })}\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <StickToBottom\n        className={cn(\"h-full max-h-full flex flex-col min-h-0 relative\", className)}\n        resize=\"smooth\"\n        initial=\"smooth\"\n        {...props}\n      >\n        <ScrollContent\n          scrollToBottomButton={scrollToBottomButton}\n          inputContainerHeight={inputContainerHeight}\n          isResizing={isResizing}\n        >\n          {children}\n        </ScrollContent>\n      </StickToBottom>\n    );\n  };\n\n  export const ScrollToBottomButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = ({\n    className,\n    ...props\n  }) => (\n    <Button\n      variant=\"outline\"\n      size=\"sm\"\n      className={twMerge(\n        \"rounded-full w-10 h-10 p-0 pointer-events-auto\",\n        \"bg-white dark:bg-gray-900\",\n        \"shadow-lg border border-gray-200 dark:border-gray-700\",\n        \"hover:bg-gray-50 dark:hover:bg-gray-800\",\n        \"flex items-center justify-center cursor-pointer\",\n        className,\n      )}\n      {...props}\n    >\n      <ChevronDown className=\"w-4 h-4 text-gray-600 dark:text-white\" />\n    </Button>\n  );\n\n  export const Feather: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({ className, style, ...props }) => (\n    <div\n      className={cn(\n        \"absolute bottom-0 left-0 right-4 h-24 pointer-events-none z-10 bg-gradient-to-t\",\n        \"from-white via-white to-transparent\",\n        \"dark:from-[rgb(33,33,33)] dark:via-[rgb(33,33,33)]\",\n        className,\n      )}\n      style={style}\n      {...props}\n    />\n  );\n\n  export const InputContainer = React.forwardRef<\n    HTMLDivElement,\n    React.HTMLAttributes<HTMLDivElement> & { children: React.ReactNode; keyboardHeight?: number }\n  >(({ children, className, keyboardHeight = 0, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn(\"absolute bottom-0 left-0 right-0 z-20 pointer-events-none\", className)}\n      style={{\n        // Adjust position when keyboard is open to keep input visible\n        transform: keyboardHeight > 0 ? `translateY(-${keyboardHeight}px)` : undefined,\n        transition: \"transform 0.2s ease-out\",\n      }}\n      {...props}\n    >\n      {children}\n    </div>\n  ));\n\n  InputContainer.displayName = \"CopilotChatView.InputContainer\";\n\n  export const Disclaimer: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({ className, ...props }) => {\n    const config = useCopilotChatConfiguration();\n    const labels = config?.labels ?? CopilotChatDefaultLabels;\n\n    return (\n      <div\n        className={cn(\"text-center text-xs text-muted-foreground py-3 px-4 max-w-3xl mx-auto\", className)}\n        {...props}\n      >\n        {labels.chatDisclaimerText}\n      </div>\n    );\n  };\n}\n\nexport default CopilotChatView;\n","import { useState, useEffect } from \"react\";\n\nexport interface KeyboardState {\n  isKeyboardOpen: boolean;\n  keyboardHeight: number;\n  availableHeight: number;\n  viewportHeight: number;\n}\n\n/**\n * Hook to detect mobile keyboard appearance and calculate available viewport height.\n * Uses the Visual Viewport API to track keyboard state on mobile devices.\n *\n * @returns KeyboardState object with keyboard information\n */\nexport function useKeyboardHeight(): KeyboardState {\n  const [keyboardState, setKeyboardState] = useState<KeyboardState>({\n    isKeyboardOpen: false,\n    keyboardHeight: 0,\n    availableHeight: typeof window !== \"undefined\" ? window.innerHeight : 0,\n    viewportHeight: typeof window !== \"undefined\" ? window.innerHeight : 0,\n  });\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    // Check if Visual Viewport API is available\n    const visualViewport = window.visualViewport;\n    if (!visualViewport) {\n      return;\n    }\n\n    const updateKeyboardState = () => {\n      const layoutHeight = window.innerHeight;\n      const visualHeight = visualViewport.height;\n\n      // Calculate keyboard height (difference between layout and visual viewport)\n      const keyboardHeight = Math.max(0, layoutHeight - visualHeight);\n\n      // Keyboard is considered open if the height difference is significant (> 150px)\n      const isKeyboardOpen = keyboardHeight > 150;\n\n      setKeyboardState({\n        isKeyboardOpen,\n        keyboardHeight,\n        availableHeight: visualHeight,\n        viewportHeight: layoutHeight,\n      });\n    };\n\n    // Initial state\n    updateKeyboardState();\n\n    // Listen for viewport changes\n    visualViewport.addEventListener(\"resize\", updateKeyboardState);\n    visualViewport.addEventListener(\"scroll\", updateKeyboardState);\n\n    return () => {\n      visualViewport.removeEventListener(\"resize\", updateKeyboardState);\n      visualViewport.removeEventListener(\"scroll\", updateKeyboardState);\n    };\n  }, []);\n\n  return keyboardState;\n}\n","import { useAgent } from \"@/hooks/use-agent\";\nimport { useSuggestions } from \"@/hooks/use-suggestions\";\nimport { CopilotChatView, CopilotChatViewProps } from \"./CopilotChatView\";\nimport CopilotChatInput, { CopilotChatInputProps } from \"./CopilotChatInput\";\nimport {\n  CopilotChatConfigurationProvider,\n  CopilotChatLabels,\n  useCopilotChatConfiguration,\n} from \"@/providers/CopilotChatConfigurationProvider\";\nimport { DEFAULT_AGENT_ID, randomUUID } from \"@copilotkitnext/shared\";\nimport { Suggestion } from \"@copilotkitnext/core\";\nimport { useCallback, useEffect, useMemo } from \"react\";\nimport { merge } from \"ts-deepmerge\";\nimport { useCopilotKit } from \"@/providers/CopilotKitProvider\";\nimport { AbstractAgent, AGUIConnectNotImplementedError } from \"@ag-ui/client\";\nimport { renderSlot, SlotValue } from \"@/lib/slots\";\n\nexport type CopilotChatProps = Omit<\n  CopilotChatViewProps,\n  \"messages\" | \"isRunning\" | \"suggestions\" | \"suggestionLoadingIndexes\" | \"onSelectSuggestion\"\n> & {\n  agentId?: string;\n  threadId?: string;\n  labels?: Partial<CopilotChatLabels>;\n  chatView?: SlotValue<typeof CopilotChatView>;\n  isModalDefaultOpen?: boolean;\n};\nexport function CopilotChat({ agentId, threadId, labels, chatView, isModalDefaultOpen, ...props }: CopilotChatProps) {\n  // Check for existing configuration provider\n  const existingConfig = useCopilotChatConfiguration();\n\n  // Apply priority: props > existing config > defaults\n  const resolvedAgentId = agentId ?? existingConfig?.agentId ?? DEFAULT_AGENT_ID;\n  const resolvedThreadId = useMemo(\n    () => threadId ?? existingConfig?.threadId ?? randomUUID(),\n    [threadId, existingConfig?.threadId],\n  );\n\n  const { agent } = useAgent({ agentId: resolvedAgentId });\n  const { copilotkit } = useCopilotKit();\n  const { suggestions: autoSuggestions } = useSuggestions({ agentId: resolvedAgentId });\n\n  const {\n    inputProps: providedInputProps,\n    messageView: providedMessageView,\n    suggestionView: providedSuggestionView,\n    ...restProps\n  } = props;\n\n  useEffect(() => {\n    const connect = async (agent: AbstractAgent) => {\n      try {\n        await copilotkit.connectAgent({ agent });\n      } catch (error) {\n        if (error instanceof AGUIConnectNotImplementedError) {\n          // connect not implemented, ignore\n        } else {\n          throw error;\n        }\n      }\n    };\n    agent.threadId = resolvedThreadId;\n    connect(agent);\n    return () => {};\n  }, [resolvedThreadId, agent, copilotkit, resolvedAgentId]);\n\n  const onSubmitInput = useCallback(\n    async (value: string) => {\n      agent.addMessage({\n        id: randomUUID(),\n        role: \"user\",\n        content: value,\n      });\n      try {\n        await copilotkit.runAgent({ agent });\n      } catch (error) {\n        console.error(\"CopilotChat: runAgent failed\", error);\n      }\n    },\n    [agent, copilotkit],\n  );\n\n  const handleSelectSuggestion = useCallback(\n    async (suggestion: Suggestion) => {\n      agent.addMessage({\n        id: randomUUID(),\n        role: \"user\",\n        content: suggestion.message,\n      });\n\n      try {\n        await copilotkit.runAgent({ agent });\n      } catch (error) {\n        console.error(\"CopilotChat: runAgent failed after selecting suggestion\", error);\n      }\n    },\n    [agent, copilotkit],\n  );\n\n  const stopCurrentRun = useCallback(() => {\n    try {\n      copilotkit.stopAgent({ agent });\n    } catch (error) {\n      console.error(\"CopilotChat: stopAgent failed\", error);\n      try {\n        agent.abortRun();\n      } catch (abortError) {\n        console.error(\"CopilotChat: abortRun fallback failed\", abortError);\n      }\n    }\n  }, [agent, copilotkit]);\n\n  const mergedProps = merge(\n    {\n      isRunning: agent.isRunning,\n      suggestions: autoSuggestions,\n      onSelectSuggestion: handleSelectSuggestion,\n      suggestionView: providedSuggestionView,\n    },\n    {\n      ...restProps,\n      ...(typeof providedMessageView === \"string\"\n        ? { messageView: { className: providedMessageView } }\n        : providedMessageView !== undefined\n          ? { messageView: providedMessageView }\n          : {}),\n    },\n  );\n\n  const providedStopHandler = providedInputProps?.onStop;\n  const hasMessages = agent.messages.length > 0;\n  const shouldAllowStop = agent.isRunning && hasMessages;\n  const effectiveStopHandler = shouldAllowStop ? (providedStopHandler ?? stopCurrentRun) : providedStopHandler;\n\n  const finalInputProps = {\n    ...providedInputProps,\n    onSubmitMessage: onSubmitInput,\n    onStop: effectiveStopHandler,\n    isRunning: agent.isRunning,\n  } as Partial<CopilotChatInputProps> & { onSubmitMessage: (value: string) => void };\n\n  finalInputProps.mode = agent.isRunning ? \"processing\" : (finalInputProps.mode ?? \"input\");\n\n  // Memoize messages array - only create new reference when content actually changes\n  // (agent.messages is mutated in place, so we need a new reference for React to detect changes)\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const messages = useMemo(() => [...agent.messages], [JSON.stringify(agent.messages)]);\n\n  const finalProps = merge(mergedProps, {\n    messages,\n    inputProps: finalInputProps,\n  }) as CopilotChatViewProps;\n\n  // Always create a provider with merged values\n  // This ensures priority: props > existing config > defaults\n  const RenderedChatView = renderSlot(chatView, CopilotChatView, finalProps);\n\n  return (\n    <CopilotChatConfigurationProvider\n      agentId={resolvedAgentId}\n      threadId={resolvedThreadId}\n      labels={labels}\n      isModalDefaultOpen={isModalDefaultOpen}\n    >\n      {RenderedChatView}\n    </CopilotChatConfigurationProvider>\n  );\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace CopilotChat {\n  export const View = CopilotChatView;\n}\n","import React, { useState, MouseEvent } from \"react\";\nimport { MessageCircle, X } from \"lucide-react\";\n\nimport { renderSlot, SlotValue } from \"@/lib/slots\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  CopilotChatDefaultLabels,\n  useCopilotChatConfiguration,\n} from \"@/providers/CopilotChatConfigurationProvider\";\n\nconst DefaultOpenIcon: React.FC<React.SVGProps<SVGSVGElement>> = ({\n  className,\n  ...props\n}) => (\n  <MessageCircle className={cn(\"h-6 w-6\", className)} strokeWidth={1.75} fill=\"currentColor\" {...props} />\n);\n\nconst DefaultCloseIcon: React.FC<React.SVGProps<SVGSVGElement>> = ({\n  className,\n  ...props\n}) => <X className={cn(\"h-6 w-6\", className)} strokeWidth={1.75} {...props} />;\n\nDefaultOpenIcon.displayName = \"CopilotChatToggleButton.OpenIcon\";\nDefaultCloseIcon.displayName = \"CopilotChatToggleButton.CloseIcon\";\n\nexport interface CopilotChatToggleButtonProps\n  extends Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, \"children\"> {\n  /** Optional slot override for the chat (closed) icon. */\n  openIcon?: SlotValue<typeof DefaultOpenIcon>;\n  /** Optional slot override for the close icon. */\n  closeIcon?: SlotValue<typeof DefaultCloseIcon>;\n}\n\nconst ICON_TRANSITION_STYLE: React.CSSProperties = Object.freeze({\n  transition: \"opacity 120ms ease-out, transform 260ms cubic-bezier(0.22, 1, 0.36, 1)\",\n});\n\nconst ICON_WRAPPER_BASE =\n  \"pointer-events-none absolute inset-0 flex items-center justify-center will-change-transform\";\n\nconst BUTTON_BASE_CLASSES = cn(\n  \"fixed bottom-6 right-6 z-[1100] flex h-14 w-14 items-center justify-center\",\n  \"rounded-full border border-primary bg-primary text-primary-foreground\",\n  \"shadow-sm transition-all duration-200 ease-out\",\n  \"hover:scale-[1.04] hover:shadow-md\",\n  \"cursor-pointer\",\n  \"active:scale-[0.96]\",\n  \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/50 focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n  \"disabled:pointer-events-none disabled:opacity-60\"\n);\n\nexport const CopilotChatToggleButton = React.forwardRef<\n  HTMLButtonElement,\n  CopilotChatToggleButtonProps\n>(function CopilotChatToggleButton({ openIcon, closeIcon, className, ...buttonProps }, ref) {\n  const { onClick, type, disabled, ...restProps } = buttonProps;\n\n  const configuration = useCopilotChatConfiguration();\n  const labels = configuration?.labels ?? CopilotChatDefaultLabels;\n\n  const [fallbackOpen, setFallbackOpen] = useState(false);\n\n  const isOpen = configuration?.isModalOpen ?? fallbackOpen;\n  const setModalOpen = configuration?.setModalOpen ?? setFallbackOpen;\n\n  const handleClick = (event: MouseEvent<HTMLButtonElement>) => {\n    if (disabled) {\n      return;\n    }\n\n    if (onClick) {\n      onClick(event);\n    }\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    const nextOpen = !isOpen;\n    setModalOpen(nextOpen);\n  };\n\n  const renderedOpenIcon = renderSlot(\n    openIcon,\n    DefaultOpenIcon,\n    {\n      className: \"h-6 w-6\",\n      \"aria-hidden\": true,\n      focusable: false,\n    }\n  );\n\n  const renderedCloseIcon = renderSlot(\n    closeIcon,\n    DefaultCloseIcon,\n    {\n      className: \"h-6 w-6\",\n      \"aria-hidden\": true,\n      focusable: false,\n    }\n  );\n\n  const openIconElement = (\n    <span\n      aria-hidden=\"true\"\n      data-slot=\"chat-toggle-button-open-icon\"\n      className={ICON_WRAPPER_BASE}\n      style={{\n        ...ICON_TRANSITION_STYLE,\n        opacity: isOpen ? 0 : 1,\n        transform: `scale(${isOpen ? 0.75 : 1}) rotate(${isOpen ? 90 : 0}deg)`,\n      }}\n    >\n      {renderedOpenIcon}\n    </span>\n  );\n\n  const closeIconElement = (\n    <span\n      aria-hidden=\"true\"\n      data-slot=\"chat-toggle-button-close-icon\"\n      className={ICON_WRAPPER_BASE}\n      style={{\n        ...ICON_TRANSITION_STYLE,\n        opacity: isOpen ? 1 : 0,\n        transform: `scale(${isOpen ? 1 : 0.75}) rotate(${isOpen ? 0 : -90}deg)`,\n      }}\n    >\n      {renderedCloseIcon}\n    </span>\n  );\n\n  return (\n    <button\n      ref={ref}\n      type={type ?? \"button\"}\n      data-slot=\"chat-toggle-button\"\n      data-state={isOpen ? \"open\" : \"closed\"}\n      className={cn(BUTTON_BASE_CLASSES, className)}\n      aria-label={isOpen ? labels.chatToggleCloseLabel : labels.chatToggleOpenLabel}\n      aria-pressed={isOpen}\n      disabled={disabled}\n      onClick={handleClick}\n      {...restProps}\n    >\n      {openIconElement}\n      {closeIconElement}\n    </button>\n  );\n});\nCopilotChatToggleButton.displayName = \"CopilotChatToggleButton\";\nexport default CopilotChatToggleButton;\n\nexport {\n  DefaultOpenIcon as CopilotChatToggleButtonOpenIcon,\n  DefaultCloseIcon as CopilotChatToggleButtonCloseIcon,\n};\n","import React, { useEffect, useRef, useState } from \"react\";\n\nimport CopilotChatView, { CopilotChatViewProps } from \"./CopilotChatView\";\nimport { useCopilotChatConfiguration } from \"@/providers/CopilotChatConfigurationProvider\";\nimport CopilotChatToggleButton from \"./CopilotChatToggleButton\";\nimport { cn } from \"@/lib/utils\";\nimport { CopilotModalHeader } from \"./CopilotModalHeader\";\nimport { renderSlot, SlotValue } from \"@/lib/slots\";\n\nconst DEFAULT_SIDEBAR_WIDTH = 480;\nconst SIDEBAR_TRANSITION_MS = 260;\n\nexport type CopilotSidebarViewProps = CopilotChatViewProps & {\n  header?: SlotValue<typeof CopilotModalHeader>;\n  width?: number | string;\n};\n\nexport function CopilotSidebarView({ header, width, ...props }: CopilotSidebarViewProps) {\n  const configuration = useCopilotChatConfiguration();\n\n  const isSidebarOpen = configuration?.isModalOpen ?? false;\n\n  const sidebarRef = useRef<HTMLDivElement | null>(null);\n  const [sidebarWidth, setSidebarWidth] = useState<number | string>(width ?? DEFAULT_SIDEBAR_WIDTH);\n\n  // Helper to convert width to CSS value\n  const widthToCss = (w: number | string): string => {\n    return typeof w === \"number\" ? `${w}px` : w;\n  };\n\n  // Helper to extract numeric value for body margin (only works with px values)\n  const widthToMargin = (w: number | string): string => {\n    if (typeof w === \"number\") {\n      return `${w}px`;\n    }\n    // For string values, use as-is (assumes valid CSS unit)\n    return w;\n  };\n\n  useEffect(() => {\n    // If width is explicitly provided, don't measure\n    if (width !== undefined) {\n      return;\n    }\n\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    const element = sidebarRef.current;\n    if (!element) {\n      return;\n    }\n\n    const updateWidth = () => {\n      const rect = element.getBoundingClientRect();\n      if (rect.width > 0) {\n        setSidebarWidth(rect.width);\n      }\n    };\n\n    updateWidth();\n\n    if (typeof ResizeObserver !== \"undefined\") {\n      const observer = new ResizeObserver(() => updateWidth());\n      observer.observe(element);\n      return () => observer.disconnect();\n    }\n\n    window.addEventListener(\"resize\", updateWidth);\n    return () => window.removeEventListener(\"resize\", updateWidth);\n  }, [width]);\n\n  const headerElement = renderSlot(header, CopilotModalHeader, {});\n\n  return (\n    <>\n      {isSidebarOpen && (\n        <style\n          dangerouslySetInnerHTML={{\n            __html: `\n            @media (min-width: 768px) {\n              body {\n                margin-inline-end: ${widthToMargin(sidebarWidth)};\n                transition: margin-inline-end ${SIDEBAR_TRANSITION_MS}ms ease;\n              }\n            }`,\n          }}\n        />\n      )}\n      <CopilotChatToggleButton />\n      <aside\n        ref={sidebarRef}\n        data-copilot-sidebar\n        className={cn(\n          \"fixed right-0 top-0 z-[1200] flex\",\n          // Height with dvh fallback and safe area support\n          \"h-[100vh] h-[100dvh] max-h-screen\",\n          // Responsive width: full on mobile, custom on desktop\n          \"w-full\",\n          \"border-l border-border bg-background text-foreground shadow-xl\",\n          \"transition-transform duration-300 ease-out\",\n          isSidebarOpen ? \"translate-x-0\" : \"translate-x-full pointer-events-none\",\n        )}\n        style={{\n          // Use CSS custom property for responsive width\n          [\"--sidebar-width\" as string]: widthToCss(sidebarWidth),\n          // Safe area insets for iOS\n          paddingTop: \"env(safe-area-inset-top)\",\n          paddingBottom: \"env(safe-area-inset-bottom)\",\n        } as React.CSSProperties}\n        aria-hidden={!isSidebarOpen}\n        aria-label=\"Copilot chat sidebar\"\n        role=\"complementary\"\n      >\n        <div className=\"flex h-full w-full flex-col overflow-hidden\">\n          {headerElement}\n          <div className=\"flex-1 overflow-hidden\" data-sidebar-chat>\n            <CopilotChatView {...props} />\n          </div>\n        </div>\n      </aside>\n    </>\n  );\n}\n\nCopilotSidebarView.displayName = \"CopilotSidebarView\";\n\nexport default CopilotSidebarView;\n","import React, { useCallback } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\nimport { useCopilotChatConfiguration, CopilotChatDefaultLabels } from \"@/providers/CopilotChatConfigurationProvider\";\nimport { renderSlot, WithSlots } from \"@/lib/slots\";\nimport { X } from \"lucide-react\";\n\ntype HeaderSlots = {\n  titleContent: typeof CopilotModalHeader.Title;\n  closeButton: typeof CopilotModalHeader.CloseButton;\n};\n\ntype HeaderRestProps = {\n  title?: string;\n} & Omit<React.HTMLAttributes<HTMLDivElement>, \"children\">;\n\nexport type CopilotModalHeaderProps = WithSlots<HeaderSlots, HeaderRestProps>;\n\nexport function CopilotModalHeader({\n  title,\n  titleContent,\n  closeButton,\n  children,\n  className,\n  ...rest\n}: CopilotModalHeaderProps) {\n  const configuration = useCopilotChatConfiguration();\n\n  const fallbackTitle = configuration?.labels.modalHeaderTitle ?? CopilotChatDefaultLabels.modalHeaderTitle;\n  const resolvedTitle = title ?? fallbackTitle;\n\n  const handleClose = useCallback(() => {\n    configuration?.setModalOpen(false);\n  }, [configuration]);\n\n  const BoundTitle = renderSlot(titleContent, CopilotModalHeader.Title, {\n    children: resolvedTitle,\n  });\n\n  const BoundCloseButton = renderSlot(closeButton, CopilotModalHeader.CloseButton, {\n    onClick: handleClose,\n  });\n\n  if (children) {\n    return children({\n      titleContent: BoundTitle,\n      closeButton: BoundCloseButton,\n      title: resolvedTitle,\n      ...rest,\n    });\n  }\n\n  return (\n    <header\n      data-slot=\"copilot-modal-header\"\n      className={cn(\n        \"flex items-center justify-between border-b border-border px-4 py-4\",\n        \"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/80\",\n        className,\n      )}\n      {...rest}\n    >\n      <div className=\"flex w-full items-center gap-2\">\n        <div className=\"flex-1\" aria-hidden=\"true\" />\n        <div className=\"flex flex-1 justify-center text-center\">{BoundTitle}</div>\n        <div className=\"flex flex-1 justify-end\">{BoundCloseButton}</div>\n      </div>\n    </header>\n  );\n}\n\nCopilotModalHeader.displayName = \"CopilotModalHeader\";\n\nexport namespace CopilotModalHeader {\n  export const Title: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({ children, className, ...props }) => (\n    <div\n      className={cn(\n        \"w-full text-base font-medium leading-none tracking-tight text-foreground\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n    </div>\n  );\n\n  export const CloseButton: React.FC<React.ButtonHTMLAttributes<HTMLButtonElement>> = ({\n    className,\n    ...props\n  }) => (\n    <button\n      type=\"button\"\n      className={cn(\n        \"inline-flex size-8 items-center justify-center rounded-full text-muted-foreground transition cursor-pointer\",\n        \"hover:bg-muted hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\",\n        className,\n      )}\n      aria-label=\"Close\"\n      {...props}\n    >\n      <X className=\"h-4 w-4\" aria-hidden=\"true\" />\n    </button>\n  );\n}\n\nCopilotModalHeader.Title.displayName = \"CopilotModalHeader.Title\";\nCopilotModalHeader.CloseButton.displayName = \"CopilotModalHeader.CloseButton\";\n\nexport default CopilotModalHeader;\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport CopilotChatView, { CopilotChatViewProps } from \"./CopilotChatView\";\nimport CopilotChatToggleButton from \"./CopilotChatToggleButton\";\nimport { CopilotModalHeader } from \"./CopilotModalHeader\";\nimport { cn } from \"@/lib/utils\";\nimport { renderSlot, SlotValue } from \"@/lib/slots\";\nimport {\n  CopilotChatDefaultLabels,\n  useCopilotChatConfiguration,\n} from \"@/providers/CopilotChatConfigurationProvider\";\n\nconst DEFAULT_POPUP_WIDTH = 420;\nconst DEFAULT_POPUP_HEIGHT = 560;\n\nexport type CopilotPopupViewProps = CopilotChatViewProps & {\n  header?: SlotValue<typeof CopilotModalHeader>;\n  width?: number | string;\n  height?: number | string;\n  clickOutsideToClose?: boolean;\n};\n\nconst dimensionToCss = (value: number | string | undefined, fallback: number): string => {\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    return `${value}px`;\n  }\n\n  if (typeof value === \"string\" && value.trim().length > 0) {\n    return value;\n  }\n\n  return `${fallback}px`;\n};\n\nexport function CopilotPopupView({\n  header,\n  width,\n  height,\n  clickOutsideToClose,\n  className,\n  ...restProps\n}: CopilotPopupViewProps) {\n  const configuration = useCopilotChatConfiguration();\n  const isPopupOpen = configuration?.isModalOpen ?? false;\n  const setModalOpen = configuration?.setModalOpen;\n  const labels = configuration?.labels ?? CopilotChatDefaultLabels;\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isRendered, setIsRendered] = useState(isPopupOpen);\n  const [isAnimatingOut, setIsAnimatingOut] = useState(false);\n\n  useEffect(() => {\n    if (isPopupOpen) {\n      setIsRendered(true);\n      setIsAnimatingOut(false);\n      return;\n    }\n\n    if (!isRendered) {\n      return;\n    }\n\n    setIsAnimatingOut(true);\n    const timeout = setTimeout(() => {\n      setIsRendered(false);\n      setIsAnimatingOut(false);\n    }, 200);\n\n    return () => clearTimeout(timeout);\n  }, [isPopupOpen, isRendered]);\n\n  useEffect(() => {\n    if (!isPopupOpen) {\n      return;\n    }\n\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        event.preventDefault();\n        setModalOpen?.(false);\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isPopupOpen, setModalOpen]);\n\n  useEffect(() => {\n    if (!isPopupOpen) {\n      return;\n    }\n\n    const focusTimer = setTimeout(() => {\n      containerRef.current?.focus({ preventScroll: true });\n    }, 200);\n\n    return () => clearTimeout(focusTimer);\n  }, [isPopupOpen]);\n\n  useEffect(() => {\n    if (!isPopupOpen || !clickOutsideToClose) {\n      return;\n    }\n\n    if (typeof document === \"undefined\") {\n      return;\n    }\n\n    const handlePointerDown = (event: PointerEvent) => {\n      const target = event.target as Node | null;\n      if (!target) {\n        return;\n      }\n\n      const container = containerRef.current;\n      if (container?.contains(target)) {\n        return;\n      }\n\n      const toggleButton = document.querySelector(\"[data-slot='chat-toggle-button']\");\n      if (toggleButton && toggleButton.contains(target)) {\n        return;\n      }\n\n      setModalOpen?.(false);\n    };\n\n    document.addEventListener(\"pointerdown\", handlePointerDown);\n    return () => document.removeEventListener(\"pointerdown\", handlePointerDown);\n  }, [isPopupOpen, clickOutsideToClose, setModalOpen]);\n\n  const headerElement = useMemo(() => renderSlot(header, CopilotModalHeader, {}), [header]);\n\n  const resolvedWidth = dimensionToCss(width, DEFAULT_POPUP_WIDTH);\n  const resolvedHeight = dimensionToCss(height, DEFAULT_POPUP_HEIGHT);\n\n  const popupStyle = useMemo(\n    () =>\n      ({\n        \"--copilot-popup-width\": resolvedWidth,\n        \"--copilot-popup-height\": resolvedHeight,\n        \"--copilot-popup-max-width\": \"calc(100vw - 3rem)\",\n        \"--copilot-popup-max-height\": \"calc(100dvh - 7.5rem)\",\n        paddingTop: \"env(safe-area-inset-top)\",\n        paddingBottom: \"env(safe-area-inset-bottom)\",\n        paddingLeft: \"env(safe-area-inset-left)\",\n        paddingRight: \"env(safe-area-inset-right)\",\n      }) as React.CSSProperties,\n    [resolvedHeight, resolvedWidth],\n  );\n\n  const popupAnimationClass =\n    isPopupOpen && !isAnimatingOut\n      ? \"pointer-events-auto translate-y-0 opacity-100 md:scale-100\"\n      : \"pointer-events-none translate-y-4 opacity-0 md:translate-y-5 md:scale-[0.95]\";\n\n  const popupContent = isRendered ? (\n    <div\n      className={cn(\n        \"fixed inset-0 z-[1200] flex max-w-full flex-col items-stretch\",\n        \"md:inset-auto md:bottom-24 md:right-6 md:items-end md:gap-4\",\n      )}\n    >\n      <div\n        ref={containerRef}\n        tabIndex={-1}\n        role=\"dialog\"\n        aria-label={labels.modalHeaderTitle}\n        data-copilot-popup\n        className={cn(\n          \"relative flex h-full w-full flex-col overflow-hidden bg-background text-foreground\",\n          \"origin-bottom focus:outline-none transform-gpu transition-transform transition-opacity duration-200 ease-out\",\n          \"md:transition-transform md:transition-opacity\",\n          \"rounded-none border border-border/0 shadow-none ring-0\",\n          \"md:h-[var(--copilot-popup-height)] md:w-[var(--copilot-popup-width)]\",\n          \"md:max-h-[var(--copilot-popup-max-height)] md:max-w-[var(--copilot-popup-max-width)]\",\n          \"md:origin-bottom-right md:rounded-2xl md:border-border md:shadow-xl md:ring-1 md:ring-border/40\",\n          popupAnimationClass,\n        )}\n        style={popupStyle}\n      >\n        {headerElement}\n        <div className=\"flex-1 overflow-hidden\" data-popup-chat>\n          <CopilotChatView\n            {...restProps}\n            className={cn(\"h-full min-h-0\", className)}\n          />\n        </div>\n      </div>\n    </div>\n  ) : null;\n\n  return (\n    <>\n      <CopilotChatToggleButton />\n      {popupContent}\n    </>\n  );\n}\n\nCopilotPopupView.displayName = \"CopilotPopupView\";\n\nexport default CopilotPopupView;\n","import React, { useMemo } from \"react\";\n\nimport { CopilotChat, CopilotChatProps } from \"./CopilotChat\";\nimport CopilotChatView, { CopilotChatViewProps } from \"./CopilotChatView\";\nimport { CopilotSidebarView, CopilotSidebarViewProps } from \"./CopilotSidebarView\";\n\nexport type CopilotSidebarProps = Omit<CopilotChatProps, \"chatView\"> & {\n  header?: CopilotSidebarViewProps[\"header\"];\n  defaultOpen?: boolean;\n  width?: number | string;\n};\n\nexport function CopilotSidebar({ header, defaultOpen, width, ...chatProps }: CopilotSidebarProps) {\n  const SidebarViewOverride = useMemo(() => {\n    const Component: React.FC<CopilotChatViewProps> = (viewProps) => {\n      const { header: viewHeader, width: viewWidth, ...restProps } = viewProps as CopilotSidebarViewProps;\n\n      return (\n        <CopilotSidebarView\n          {...(restProps as CopilotSidebarViewProps)}\n          header={header ?? viewHeader}\n          width={width ?? viewWidth}\n        />\n      );\n    };\n\n    return Object.assign(Component, CopilotChatView);\n  }, [header, width]);\n\n  return (\n    <CopilotChat\n      {...chatProps}\n      chatView={SidebarViewOverride}\n      isModalDefaultOpen={defaultOpen}\n    />\n  );\n}\n\nCopilotSidebar.displayName = \"CopilotSidebar\";\n\nexport default CopilotSidebar;\n","import React, { useMemo } from \"react\";\n\nimport { CopilotChat, CopilotChatProps } from \"./CopilotChat\";\nimport CopilotChatView, { CopilotChatViewProps } from \"./CopilotChatView\";\nimport { CopilotPopupView, CopilotPopupViewProps } from \"./CopilotPopupView\";\n\nexport type CopilotPopupProps = Omit<CopilotChatProps, \"chatView\"> & {\n  header?: CopilotPopupViewProps[\"header\"];\n  defaultOpen?: boolean;\n  width?: CopilotPopupViewProps[\"width\"];\n  height?: CopilotPopupViewProps[\"height\"];\n  clickOutsideToClose?: CopilotPopupViewProps[\"clickOutsideToClose\"];\n};\n\nexport function CopilotPopup({\n  header,\n  defaultOpen,\n  width,\n  height,\n  clickOutsideToClose,\n  ...chatProps\n}: CopilotPopupProps) {\n  const PopupViewOverride = useMemo(() => {\n    const Component: React.FC<CopilotChatViewProps> = (viewProps) => {\n      const {\n        header: viewHeader,\n        width: viewWidth,\n        height: viewHeight,\n        clickOutsideToClose: viewClickOutsideToClose,\n        ...restProps\n      } = viewProps as CopilotPopupViewProps;\n\n      return (\n        <CopilotPopupView\n          {...(restProps as CopilotPopupViewProps)}\n          header={header ?? viewHeader}\n          width={width ?? viewWidth}\n          height={height ?? viewHeight}\n          clickOutsideToClose={clickOutsideToClose ?? viewClickOutsideToClose}\n        />\n      );\n    };\n\n    return Object.assign(Component, CopilotChatView);\n  }, [clickOutsideToClose, header, height, width]);\n\n  return (\n    <CopilotChat\n      {...chatProps}\n      chatView={PopupViewOverride}\n      isModalDefaultOpen={defaultOpen}\n    />\n  );\n}\n\nCopilotPopup.displayName = \"CopilotPopup\";\n\nexport default CopilotPopup;\n","import React from \"react\";\nimport { z } from \"zod\";\nimport { ReactToolCallRenderer } from \"./react-tool-call-renderer\";\nimport { ToolCallStatus } from \"@copilotkitnext/core\";\n\n/**\n * Helper to define a type-safe tool call renderer entry.\n * - Accepts a single object whose keys match ReactToolCallRenderer's fields: { name, args, render, agentId? }.\n * - Derives `args` type from the provided Zod schema.\n * - Ensures the render function param type exactly matches ReactToolCallRenderer<T>[\"render\"]'s param.\n * - For wildcard tools (name: \"*\"), args is optional and defaults to z.any()\n */\ntype RenderProps<T> =\n  | {\n      name: string;\n      args: Partial<T>;\n      status: ToolCallStatus.InProgress;\n      result: undefined;\n    }\n  | {\n      name: string;\n      args: T;\n      status: ToolCallStatus.Executing;\n      result: undefined;\n    }\n  | {\n      name: string;\n      args: T;\n      status: ToolCallStatus.Complete;\n      result: string;\n    };\n\n// Overload for wildcard tools without args\nexport function defineToolCallRenderer(def: {\n  name: \"*\";\n  render: (props: RenderProps<any>) => React.ReactElement;\n  agentId?: string;\n}): ReactToolCallRenderer<any>;\n\n// Overload for regular tools with args\nexport function defineToolCallRenderer<S extends z.ZodTypeAny>(def: {\n  name: string;\n  args: S;\n  render: (props: RenderProps<z.infer<S>>) => React.ReactElement;\n  agentId?: string;\n}): ReactToolCallRenderer<z.infer<S>>;\n\n// Implementation\nexport function defineToolCallRenderer<S extends z.ZodTypeAny>(def: {\n  name: string;\n  args?: S;\n  render: (props: any) => React.ReactElement;\n  agentId?: string;\n}): ReactToolCallRenderer<any> {\n  // For wildcard tools, default to z.any() if no args provided\n  const argsSchema = def.name === \"*\" && !def.args ? z.any() : def.args;\n\n  return {\n    name: def.name,\n    args: argsSchema as any,\n    render: def.render as React.ComponentType<any>,\n    ...(def.agentId ? { agentId: def.agentId } : {}),\n  };\n}\n","import { defineToolCallRenderer } from \"../types/defineToolCallRenderer\";\nimport { useState } from \"react\";\n\nexport const WildcardToolCallRender = defineToolCallRenderer({\n  name: \"*\",\n  render: ({ args, result, name, status }) => {\n    const [isExpanded, setIsExpanded] = useState(false);\n\n    const statusString = String(status) as\n      | \"inProgress\"\n      | \"executing\"\n      | \"complete\";\n    const isActive =\n      statusString === \"inProgress\" || statusString === \"executing\";\n    const isComplete = statusString === \"complete\";\n    const statusStyles = isActive\n      ? \"bg-amber-100 text-amber-800 dark:bg-amber-500/15 dark:text-amber-400\"\n      : isComplete\n        ? \"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/15 dark:text-emerald-400\"\n        : \"bg-zinc-100 text-zinc-800 dark:bg-zinc-700/40 dark:text-zinc-300\";\n\n    return (\n      <div className=\"mt-2 pb-2\">\n        <div className=\"rounded-xl border border-zinc-200/60 dark:border-zinc-800/60 bg-white/70 dark:bg-zinc-900/50 shadow-sm backdrop-blur p-4\">\n          <div\n            className=\"flex items-center justify-between gap-3 cursor-pointer\"\n            onClick={() => setIsExpanded(!isExpanded)}\n          >\n            <div className=\"flex items-center gap-2 min-w-0\">\n              <svg\n                className={`h-4 w-4 text-zinc-500 dark:text-zinc-400 transition-transform ${\n                  isExpanded ? \"rotate-90\" : \"\"\n                }`}\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={2}\n                stroke=\"currentColor\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M8.25 4.5l7.5 7.5-7.5 7.5\"\n                />\n              </svg>\n              <span className=\"inline-block h-2 w-2 rounded-full bg-blue-500\" />\n              <span className=\"truncate text-sm font-medium text-zinc-900 dark:text-zinc-100\">\n                {name}\n              </span>\n            </div>\n            <span\n              className={`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${statusStyles}`}\n            >\n              {String(status)}\n            </span>\n          </div>\n\n          {isExpanded && (\n            <div className=\"mt-3 grid gap-4\">\n              <div>\n                <div className=\"text-xs uppercase tracking-wide text-zinc-500 dark:text-zinc-400\">\n                  Arguments\n                </div>\n                <pre className=\"mt-2 max-h-64 overflow-auto rounded-md bg-zinc-50 dark:bg-zinc-800/60 p-3 text-xs leading-relaxed text-zinc-800 dark:text-zinc-200 whitespace-pre-wrap break-words\">\n                  {JSON.stringify(args ?? {}, null, 2)}\n                </pre>\n              </div>\n\n              {result !== undefined && (\n                <div>\n                  <div className=\"text-xs uppercase tracking-wide text-zinc-500 dark:text-zinc-400\">\n                    Result\n                  </div>\n                  <pre className=\"mt-2 max-h-64 overflow-auto rounded-md bg-zinc-50 dark:bg-zinc-800/60 p-3 text-xs leading-relaxed text-zinc-800 dark:text-zinc-200 whitespace-pre-wrap break-words\">\n                    {typeof result === \"string\"\n                      ? result\n                      : JSON.stringify(result, null, 2)}\n                  </pre>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["useState","useRef","useEffect","forwardRef","useImperativeHandle","useMemo","twMerge","jsx","jsx","jsx","jsxs","jsx","jsx","jsx","jsx","jsxs","twMerge","jsx","React","MemoizedSlotWrapper","jsx","jsxs","useState","useEffect","useRef","useMemo","value","twMerge","CopilotChatInput","forwardRef","TextArea","useImperativeHandle","useState","Check","twMerge","React","useCallback","useMemo","createContext","useContext","useMemo","useEffect","useRef","useState","z","React","jsx","useEffect","useRef","useState","useCallback","jsx","jsxs","MCPAppsActivityRenderer","jsx","jsxs","createContext","useMemo","useRef","useEffect","useState","z","copilotkit","useContext","DEFAULT_AGENT_ID","jsx","React","ToolCallRenderer","useMemo","useCallback","jsx","DEFAULT_AGENT_ID","useCallback","useMemo","jsx","DEFAULT_AGENT_ID","useEffect","useEffect","useCallback","useRef","useEffect","React","useRef","useCallback","React","useEffect","useMemo","useEffect","useReducer","DEFAULT_AGENT_ID","UseAgentUpdate","useEffect","useMemo","useCallback","useEffect","useMemo","useState","DEFAULT_AGENT_ID","useMemo","useState","useEffect","suggestions","useCallback","useCallback","useEffect","useMemo","useRef","DEFAULT_AGENT_ID","useMemo","useRef","useCallback","useEffect","React","Fragment","jsx","Fragment","jsx","jsxs","twMerge","CopilotChatAssistantMessage","useState","Check","useMemo","useState","Copy","Check","twMerge","Fragment","jsx","jsxs","useMemo","twMerge","CopilotChatUserMessage","useState","Check","Copy","React","jsx","jsxs","React","CopilotChatSuggestionPill","React","Fragment","jsx","jsxs","React","DefaultContainer","CopilotChatSuggestionView","React","useEffect","useReducer","twMerge","jsx","jsxs","React","MemoizedAssistantMessage","MemoizedUserMessage","MemoizedActivityMessage","MemoizedCustomMessage","useReducer","useEffect","twMerge","React","useRef","useState","useEffect","twMerge","useState","useEffect","Fragment","jsx","jsxs","useRef","useState","useEffect","twMerge","CopilotChatView","React","DEFAULT_AGENT_ID","randomUUID","useCallback","useEffect","useMemo","jsx","DEFAULT_AGENT_ID","useMemo","randomUUID","useEffect","agent","useCallback","CopilotChat","React","useState","X","jsx","jsxs","X","React","CopilotChatToggleButton","useState","useEffect","useRef","useState","useCallback","X","jsx","jsxs","useCallback","CopilotModalHeader","Fragment","jsx","jsxs","useRef","useState","useEffect","useEffect","useMemo","useRef","useState","Fragment","jsx","jsxs","useRef","useState","useEffect","useMemo","useMemo","jsx","useMemo","useMemo","jsx","useMemo","z","useState","jsx","jsxs"],"mappings":"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"}}]
}