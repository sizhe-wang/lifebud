'use strict';

var chunkJBE6KM7R_cjs = require('./chunk-JBE6KM7R.cjs');
var chunkJRUJ546M_cjs = require('./chunk-JRUJ546M.cjs');

// ../../node_modules/.pnpm/@standard-community+standard-openapi@0.2.9_@standard-community+standard-json@0.3.5_@sta_54b5e515d9ef28e1ec1313d6d3effba2/node_modules/@standard-community/standard-openapi/dist/valibot-D_HTw1Gn.js
function getToOpenAPISchemaFn() {
  return async (schema, context) => {
    const openapiSchema = await chunkJRUJ546M_cjs.toJsonSchema(schema, {
      errorMode: "ignore",
      // @ts-expect-error
      overrideAction: ({ valibotAction, jsonSchema }) => {
        const _jsonSchema = chunkJBE6KM7R_cjs.convertToOpenAPISchema(jsonSchema, context);
        if (valibotAction.kind === "metadata" && valibotAction.type === "metadata" && !("$ref" in _jsonSchema)) {
          const metadata = valibotAction.metadata;
          if (metadata.example !== void 0) {
            _jsonSchema.example = metadata.example;
          }
          if (metadata.examples && metadata.examples.length > 0) {
            _jsonSchema.examples = metadata.examples;
          }
          if (metadata.ref) {
            context.components.schemas = {
              ...context.components.schemas,
              [metadata.ref]: _jsonSchema
            };
            return {
              $ref: `#/components/schemas/${metadata.ref}`
            };
          }
        }
        return _jsonSchema;
      },
      ...context.options
    });
    if ("$schema" in openapiSchema) {
      delete openapiSchema.$schema;
    }
    return openapiSchema;
  };
}

module.exports = getToOpenAPISchemaFn;
//# sourceMappingURL=valibot-D_HTw1Gn-DSFFOUBW.cjs.map
//# sourceMappingURL=valibot-D_HTw1Gn-DSFFOUBW.cjs.map