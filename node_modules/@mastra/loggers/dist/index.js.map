{"version":3,"sources":["../src/pino.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import type { LoggerTransport } from '@mastra/core/logger';\nimport { LogLevel, MastraLogger } from '@mastra/core/logger';\nimport pino from 'pino';\nimport pretty from 'pino-pretty';\n\ntype TransportMap = Record<string, LoggerTransport>;\n\nexport type { LogLevel } from '@mastra/core/logger';\n\nexport interface PinoLoggerOptions {\n  name?: string;\n  level?: LogLevel;\n  transports?: TransportMap;\n  overrideDefaultTransports?: boolean;\n  formatters?: pino.LoggerOptions['formatters'];\n  redact?: pino.LoggerOptions['redact'];\n}\n\ninterface PinoLoggerInternalOptions extends PinoLoggerOptions {\n  /** @internal Used internally for child loggers */\n  _logger?: pino.Logger;\n}\n\nexport class PinoLogger extends MastraLogger {\n  protected logger: pino.Logger;\n\n  constructor(options: PinoLoggerOptions = {}) {\n    super(options);\n\n    const internalOptions = options as PinoLoggerInternalOptions;\n\n    // If an existing pino logger is provided (for child loggers), use it directly\n    if (internalOptions._logger) {\n      this.logger = internalOptions._logger;\n      return;\n    }\n\n    let prettyStream: ReturnType<typeof pretty> | undefined = undefined;\n    if (!options.overrideDefaultTransports) {\n      prettyStream = pretty({\n        colorize: true,\n        levelFirst: true,\n        ignore: 'pid,hostname',\n        colorizeObjects: true,\n        translateTime: 'SYS:standard',\n        singleLine: false,\n      });\n    }\n\n    const transportsAry = [...this.getTransports().entries()];\n    this.logger = pino(\n      {\n        name: options.name || 'app',\n        level: options.level || LogLevel.INFO,\n        formatters: options.formatters,\n        redact: options.redact,\n      },\n      options.overrideDefaultTransports\n        ? options?.transports?.default\n        : transportsAry.length === 0\n          ? prettyStream\n          : pino.multistream([\n              ...transportsAry.map(([, transport]) => ({\n                stream: transport,\n                level: options.level || LogLevel.INFO,\n              })),\n              {\n                stream: prettyStream!,\n                level: options.level || LogLevel.INFO,\n              },\n            ]),\n    );\n  }\n\n  /**\n   * Creates a child logger with additional bound context.\n   * All logs from the child logger will include the bound context.\n   *\n   * @param bindings - Key-value pairs to include in all logs from this child logger\n   * @returns A new PinoLogger instance with the bound context\n   *\n   * @example\n   * ```typescript\n   * const baseLogger = new PinoLogger({ name: 'MyApp' });\n   *\n   * // Create module-scoped logger\n   * const serviceLogger = baseLogger.child({ module: 'UserService' });\n   * serviceLogger.info('User created', { userId: '123' });\n   * // Output includes: { module: 'UserService', userId: '123', msg: 'User created' }\n   *\n   * // Create request-scoped logger\n   * const requestLogger = baseLogger.child({ requestId: req.id });\n   * requestLogger.error('Request failed', { err: error });\n   * // Output includes: { requestId: 'abc', msg: 'Request failed', err: {...} }\n   * ```\n   */\n  child(bindings: Record<string, unknown>): PinoLogger {\n    const childPino = this.logger.child(bindings);\n    const childOptions: PinoLoggerInternalOptions = {\n      name: this.name,\n      level: this.level,\n      transports: Object.fromEntries(this.transports),\n      _logger: childPino,\n    };\n    return new PinoLogger(childOptions);\n  }\n\n  debug(message: string, args: Record<string, any> = {}): void {\n    this.logger.debug(args, message);\n  }\n\n  info(message: string, args: Record<string, any> = {}): void {\n    this.logger.info(args, message);\n  }\n\n  warn(message: string, args: Record<string, any> = {}): void {\n    this.logger.warn(args, message);\n  }\n\n  error(message: string, args: Record<string, any> = {}): void {\n    this.logger.error(args, message);\n  }\n}\n"]}