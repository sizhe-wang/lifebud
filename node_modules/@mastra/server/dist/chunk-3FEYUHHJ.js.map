{"version":3,"sources":["../src/server/handlers/logs.ts","../src/server/schemas/logs.ts"],"names":[],"mappings":";;;;;;;;AAAA,IAAA,YAAA,GAAA;AAAA,QAAA,CAAA,YAAA,EAAA;AAAA,EAAA,yBAAA,EAAA,MAAA,yBAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,yBAAA,EAAA,MAAA;AAAA,CAAA,CAAA;ACIO,IAAM,mBAAA,GAAsB,0BAAA,EAA2B,CAAE,MAAA,CAAO;AAAA,EACrE,QAAA,EAAU,CAAA,CAAE,MAAA,CAAO,IAAA,GAAO,QAAA,EAAS;AAAA,EACnC,MAAA,EAAQ,CAAA,CAAE,MAAA,CAAO,IAAA,GAAO,QAAA,EAAS;AAAA,EACjC,QAAA,EAAU,CAAA,CAAE,IAAA,CAAK,CAAC,OAAA,EAAS,MAAA,EAAQ,MAAA,EAAQ,OAAA,EAAS,QAAQ,CAAC,CAAA,CAAE,QAAA,EAAS;AAAA,EACxE,OAAA,EAAS,CAAA,CAAE,KAAA,CAAM,CAAC,EAAE,MAAA,EAAO,EAAG,CAAA,CAAE,KAAA,CAAM,EAAE,MAAA,EAAQ,CAAC,CAAC,EAAE,QAAA,EAAS;AAAA,EAC7D,WAAA,EAAa,EAAE,MAAA;AACjB,CAAC,CAAA;AAGM,IAAM,sBAAA,GAAyB,EAAE,MAAA,CAAO;AAAA,EAC7C,IAAA,EAAM,CAAA,CAAE,KAAA,CAAM,oBAAoB,CAAA;AAAA,EAClC,KAAA,EAAO,EAAE,MAAA,EAAO;AAAA,EAChB,IAAA,EAAM,EAAE,MAAA,EAAO;AAAA,EACf,OAAA,EAAS,CAAA,CAAE,KAAA,CAAM,CAAC,CAAA,CAAE,MAAA,EAAO,EAAG,CAAA,CAAE,OAAA,CAAQ,KAAK,CAAC,CAAC,CAAA;AAAA,EAC/C,OAAA,EAAS,EAAE,OAAA;AACb,CAAC,CAAA;AAEM,IAAM,+BAAA,GAAkC,EAAE,MAAA,CAAO;AAAA,EACtD,UAAA,EAAY,CAAA,CAAE,KAAA,CAAM,CAAA,CAAE,QAAQ;AAChC,CAAC,CAAA;;;ADbM,IAAM,4BAA4B,WAAA,CAAY;AAAA,EACnD,MAAA,EAAQ,KAAA;AAAA,EACR,IAAA,EAAM,sBAAA;AAAA,EACN,YAAA,EAAc,MAAA;AAAA,EACd,cAAA,EAAgB,+BAAA;AAAA,EAChB,OAAA,EAAS,qBAAA;AAAA,EACT,WAAA,EAAa,gDAAA;AAAA,EACb,IAAA,EAAM,CAAC,MAAM,CAAA;AAAA,EACb,OAAA,EAAS,OAAO,EAAE,MAAA,EAAO,KAAM;AAC7B,IAAA,IAAI;AACF,MAAA,MAAM,MAAA,GAAS,OAAO,SAAA,EAAU;AAChC,MAAA,MAAM,UAAA,GAAa,OAAO,aAAA,EAAc;AAExC,MAAA,OAAO;AAAA,QACL,UAAA,EAAY,aAAa,CAAC,GAAG,WAAW,IAAA,EAAM,IAAI;AAAC,OACrD;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,WAAA,CAAY,OAAO,8BAA8B,CAAA;AAAA,IAC1D;AAAA,EACF;AACF,CAAC;AAEM,IAAM,kBAAkB,WAAA,CAAY;AAAA,EACzC,MAAA,EAAQ,KAAA;AAAA,EACR,IAAA,EAAM,WAAA;AAAA,EACN,YAAA,EAAc,MAAA;AAAA,EACd,gBAAA,EAAkB,mBAAA;AAAA,EAClB,cAAA,EAAgB,sBAAA;AAAA,EAChB,OAAA,EAAS,WAAA;AAAA,EACT,WAAA,EACE,6GAAA;AAAA,EACF,IAAA,EAAM,CAAC,MAAM,CAAA;AAAA,EACb,SAAS,OAAO,EAAE,MAAA,EAAQ,GAAG,QAAO,KAAM;AACxC,IAAA,IAAI;AACF,MAAA,MAAM,EAAE,aAAa,QAAA,EAAU,MAAA,EAAQ,UAAU,OAAA,EAAS,QAAA,EAAU,IAAA,EAAM,OAAA,EAAQ,GAAI,MAAA;AAEtF,MAAA,YAAA,CAAa,EAAE,aAAa,CAAA;AAG5B,MAAA,MAAM,OAAA,GAAU,aAAa,QAAQ,CAAA;AAErC,MAAA,MAAM,IAAA,GAAO,MAAM,MAAA,CAAO,QAAA,CAAS,WAAA,EAAc;AAAA,QAC/C,QAAA;AAAA,QACA,MAAA;AAAA,QACA,QAAA;AAAA,QACA,OAAA;AAAA,QACA,IAAA,EAAM,IAAA,GAAO,MAAA,CAAO,IAAI,CAAA,GAAI,MAAA;AAAA,QAC5B,OAAA,EAAS,OAAA,GAAU,MAAA,CAAO,OAAO,CAAA,GAAI;AAAA,OACtC,CAAA;AACD,MAAA,OAAO,IAAA;AAAA,IACT,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,WAAA,CAAY,OAAO,oBAAoB,CAAA;AAAA,IAChD;AAAA,EACF;AACF,CAAC;AAEM,IAAM,4BAA4B,WAAA,CAAY;AAAA,EACnD,MAAA,EAAQ,KAAA;AAAA,EACR,IAAA,EAAM,kBAAA;AAAA,EACN,YAAA,EAAc,MAAA;AAAA,EACd,eAAA,EAAiB,WAAA;AAAA,EACjB,gBAAA,EAAkB,mBAAA;AAAA,EAClB,cAAA,EAAgB,sBAAA;AAAA,EAChB,OAAA,EAAS,qBAAA;AAAA,EACT,WAAA,EAAa,gEAAA;AAAA,EACb,IAAA,EAAM,CAAC,MAAM,CAAA;AAAA,EACb,SAAS,OAAO,EAAE,QAAQ,KAAA,EAAO,GAAG,QAAO,KAAM;AAC/C,IAAA,IAAI;AACF,MAAA,MAAM,EAAE,aAAa,QAAA,EAAU,MAAA,EAAQ,UAAU,OAAA,EAAS,QAAA,EAAU,IAAA,EAAM,OAAA,EAAQ,GAAI,MAAA;AAEtF,MAAA,YAAA,CAAa,EAAE,KAAA,EAAO,WAAA,EAAa,CAAA;AAGnC,MAAA,MAAM,OAAA,GAAU,aAAa,QAAQ,CAAA;AAErC,MAAA,MAAM,IAAA,GAAO,MAAM,MAAA,CAAO,eAAA,CAAgB;AAAA,QACxC,KAAA;AAAA,QACA,WAAA;AAAA,QACA,QAAA;AAAA,QACA,MAAA;AAAA,QACA,QAAA;AAAA,QACA,OAAA;AAAA,QACA,IAAA,EAAM,IAAA,GAAO,MAAA,CAAO,IAAI,CAAA,GAAI,MAAA;AAAA,QAC5B,OAAA,EAAS,OAAA,GAAU,MAAA,CAAO,OAAO,CAAA,GAAI;AAAA,OACtC,CAAA;AACD,MAAA,OAAO,IAAA;AAAA,IACT,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,WAAA,CAAY,OAAO,8BAA8B,CAAA;AAAA,IAC1D;AAAA,EACF;AACF,CAAC","file":"chunk-3FEYUHHJ.js","sourcesContent":["import { runIdSchema } from '../schemas/common';\nimport { listLogsQuerySchema, listLogsResponseSchema, listLogTransportsResponseSchema } from '../schemas/logs';\nimport { createRoute } from '../server-adapter/routes/route-builder';\nimport { handleError } from './error';\nimport { parseFilters, validateBody } from './utils';\n\n// ============================================================================\n// Route Definitions (new pattern - handlers defined inline with createRoute)\n// ============================================================================\n\nexport const LIST_LOG_TRANSPORTS_ROUTE = createRoute({\n  method: 'GET',\n  path: '/api/logs/transports',\n  responseType: 'json',\n  responseSchema: listLogTransportsResponseSchema,\n  summary: 'List log transports',\n  description: 'Returns a list of all available log transports',\n  tags: ['Logs'],\n  handler: async ({ mastra }) => {\n    try {\n      const logger = mastra.getLogger();\n      const transports = logger.getTransports();\n\n      return {\n        transports: transports ? [...transports.keys()] : [],\n      };\n    } catch (error) {\n      return handleError(error, 'Error getting log Transports');\n    }\n  },\n});\n\nexport const LIST_LOGS_ROUTE = createRoute({\n  method: 'GET',\n  path: '/api/logs',\n  responseType: 'json',\n  queryParamSchema: listLogsQuerySchema,\n  responseSchema: listLogsResponseSchema,\n  summary: 'List logs',\n  description:\n    'Returns logs from a specific transport with optional filtering by date range, log level, and custom filters',\n  tags: ['Logs'],\n  handler: async ({ mastra, ...params }) => {\n    try {\n      const { transportId, fromDate, toDate, logLevel, filters: _filters, page, perPage } = params;\n\n      validateBody({ transportId });\n\n      // Parse filter query parameter if present\n      const filters = parseFilters(_filters);\n\n      const logs = await mastra.listLogs(transportId!, {\n        fromDate,\n        toDate,\n        logLevel,\n        filters,\n        page: page ? Number(page) : undefined,\n        perPage: perPage ? Number(perPage) : undefined,\n      });\n      return logs;\n    } catch (error) {\n      return handleError(error, 'Error getting logs');\n    }\n  },\n});\n\nexport const LIST_LOGS_BY_RUN_ID_ROUTE = createRoute({\n  method: 'GET',\n  path: '/api/logs/:runId',\n  responseType: 'json',\n  pathParamSchema: runIdSchema,\n  queryParamSchema: listLogsQuerySchema,\n  responseSchema: listLogsResponseSchema,\n  summary: 'List logs by run ID',\n  description: 'Returns all logs for a specific execution run from a transport',\n  tags: ['Logs'],\n  handler: async ({ mastra, runId, ...params }) => {\n    try {\n      const { transportId, fromDate, toDate, logLevel, filters: _filters, page, perPage } = params;\n\n      validateBody({ runId, transportId });\n\n      // Parse filter query parameter if present\n      const filters = parseFilters(_filters);\n\n      const logs = await mastra.listLogsByRunId({\n        runId: runId!,\n        transportId: transportId!,\n        fromDate,\n        toDate,\n        logLevel,\n        filters,\n        page: page ? Number(page) : undefined,\n        perPage: perPage ? Number(perPage) : undefined,\n      });\n      return logs;\n    } catch (error) {\n      return handleError(error, 'Error getting logs by run ID');\n    }\n  },\n});\n","import z from 'zod';\nimport { createPagePaginationSchema, baseLogMessageSchema } from './common';\n\n// Query parameter schemas\nexport const listLogsQuerySchema = createPagePaginationSchema().extend({\n  fromDate: z.coerce.date().optional(),\n  toDate: z.coerce.date().optional(),\n  logLevel: z.enum(['debug', 'info', 'warn', 'error', 'silent']).optional(),\n  filters: z.union([z.string(), z.array(z.string())]).optional(),\n  transportId: z.string(),\n});\n\n// Response schemas\nexport const listLogsResponseSchema = z.object({\n  logs: z.array(baseLogMessageSchema),\n  total: z.number(),\n  page: z.number(),\n  perPage: z.union([z.number(), z.literal(false)]),\n  hasMore: z.boolean(),\n});\n\nexport const listLogTransportsResponseSchema = z.object({\n  transports: z.array(z.string()),\n});\n"]}