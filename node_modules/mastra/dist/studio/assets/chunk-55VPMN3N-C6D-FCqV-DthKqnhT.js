import{_ as V,d as O,r as A}from"./main-BWrt59ut.js";var F={env:{}},w={},J=V({"../../../node_modules/.pnpm/@vercel+oidc@3.0.5/node_modules/@vercel/oidc/dist/token-io.js"(I,j){var g=Object.create,u=Object.defineProperty,P=Object.getOwnPropertyDescriptor,D=Object.getOwnPropertyNames,T=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,m=(o,n)=>{for(var d in n)u(o,d,{get:n[d],enumerable:!0})},v=(o,n,d,h)=>{if(n&&typeof n=="object"||typeof n=="function")for(let f of D(n))!b.call(o,f)&&f!==d&&u(o,f,{get:()=>n[f],enumerable:!(h=P(n,f))||h.enumerable});return o},_=(o,n,d)=>(d=o!=null?g(T(o)):{},v(!o||!o.__esModule?u(d,"default",{value:o,enumerable:!0}):d,o)),E=o=>v(u({},"__esModule",{value:!0}),o),k={};m(k,{findRootDir:()=>y,getUserDataDir:()=>S}),j.exports=E(k);var c=_(O("path")),s=_(O("fs")),a=_(O("os")),p=A();function y(){try{let o=F.cwd();for(;o!==c.default.dirname(o);){const n=c.default.join(o,".vercel");if(s.default.existsSync(n))return o;o=c.default.dirname(o)}}catch{throw new p.VercelOidcTokenError("Token refresh only supported in node server environments")}throw new p.VercelOidcTokenError("Unable to find root directory")}function S(){if(w.XDG_DATA_HOME)return w.XDG_DATA_HOME;switch(a.default.platform()){case"darwin":return c.default.join(a.default.homedir(),"Library/Application Support");case"linux":return c.default.join(a.default.homedir(),".local/share");case"win32":return w.LOCALAPPDATA?w.LOCALAPPDATA:null;default:return null}}}}),C=V({"../../../node_modules/.pnpm/@vercel+oidc@3.0.5/node_modules/@vercel/oidc/dist/token-util.js"(I,j){var g=Object.create,u=Object.defineProperty,P=Object.getOwnPropertyDescriptor,D=Object.getOwnPropertyNames,T=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,m=(e,r)=>{for(var t in r)u(e,t,{get:r[t],enumerable:!0})},v=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let l of D(r))!b.call(e,l)&&l!==t&&u(e,l,{get:()=>r[l],enumerable:!(i=P(r,l))||i.enumerable});return e},_=(e,r,t)=>(t=e!=null?g(T(e)):{},v(!e||!e.__esModule?u(t,"default",{value:e,enumerable:!0}):t,e)),E=e=>v(u({},"__esModule",{value:!0}),e),k={};m(k,{assertVercelOidcTokenResponse:()=>n,findProjectInfo:()=>d,getTokenPayload:()=>N,getVercelCliToken:()=>S,getVercelDataDir:()=>y,getVercelOidcToken:()=>o,isExpired:()=>M,loadToken:()=>f,saveToken:()=>h}),j.exports=E(k);var c=_(O("path")),s=_(O("fs")),a=A(),p=J();function y(){const e="com.vercel.cli",r=(0,p.getUserDataDir)();return r?c.join(r,e):null}function S(){const e=y();if(!e)return null;const r=c.join(e,"auth.json");if(!s.existsSync(r))return null;const t=s.readFileSync(r,"utf8");return t?JSON.parse(t).token:null}async function o(e,r,t){try{const i=`https://api.vercel.com/v1/projects/${r}/token?source=vercel-oidc-refresh${t?`&teamId=${t}`:""}`,l=await fetch(i,{method:"POST",headers:{Authorization:`Bearer ${e}`}});if(!l.ok)throw new a.VercelOidcTokenError(`Failed to refresh OIDC token: ${l.statusText}`);const x=await l.json();return n(x),x}catch(i){throw new a.VercelOidcTokenError("Failed to refresh OIDC token",i)}}function n(e){if(!e||typeof e!="object")throw new TypeError("Expected an object");if(!("token"in e)||typeof e.token!="string")throw new TypeError("Expected a string-valued token property")}function d(){const e=(0,p.findRootDir)();if(!e)throw new a.VercelOidcTokenError("Unable to find root directory");try{const r=c.join(e,".vercel","project.json");if(!s.existsSync(r))throw new a.VercelOidcTokenError("project.json not found");const t=JSON.parse(s.readFileSync(r,"utf8"));if(typeof t.projectId!="string"&&typeof t.orgId!="string")throw new TypeError("Expected a string-valued projectId property");return{projectId:t.projectId,teamId:t.orgId}}catch(r){throw new a.VercelOidcTokenError("Unable to find project ID",r)}}function h(e,r){try{const t=(0,p.getUserDataDir)();if(!t)throw new a.VercelOidcTokenError("Unable to find user data directory");const i=c.join(t,"com.vercel.token",`${r}.json`),l=JSON.stringify(e);s.mkdirSync(c.dirname(i),{mode:504,recursive:!0}),s.writeFileSync(i,l),s.chmodSync(i,432);return}catch(t){throw new a.VercelOidcTokenError("Failed to save token",t)}}function f(e){try{const r=(0,p.getUserDataDir)();if(!r)return null;const t=c.join(r,"com.vercel.token",`${e}.json`);if(!s.existsSync(t))return null;const i=JSON.parse(s.readFileSync(t,"utf8"));return n(i),i}catch(r){throw new a.VercelOidcTokenError("Failed to load token",r)}}function N(e){const r=e.split(".");if(r.length!==3)throw new a.VercelOidcTokenError("Invalid token");const t=r[1].replace(/-/g,"+").replace(/_/g,"/"),i=t.padEnd(t.length+(4-t.length%4)%4,"=");return JSON.parse(Buffer.from(i,"base64").toString("utf8"))}function M(e){return e.exp*1e3<Date.now()}}});export{C as r};
